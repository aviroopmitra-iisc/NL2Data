{
  "metadata": {
    "description": "NL2Data Query Suite - Curated Regression Tests",
    "core_queries": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      12,
      20
    ],
    "extended_queries": [
      11,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      21,
      22,
      23,
      24,
      25,
      26,
      27,
      28,
      29,
      30,
      31,
      32,
      33,
      34,
      35
    ],
    "total_queries": 35
  },
  "queries": [
    {
      "number": 1,
      "tier": "core",
      "text": "Generate a web clickstream dataset for a mid-sized e-commerce site with one session-level fact table and four dimension tables (user, device, referrer, page). The fact table should contain at least 30 million sessions over a 90-day period. Session lengths must follow a heavy-tailed distribution where most sessions are short but a small fraction have more than 100 events. Include a \"bot_detection_score\" feature where roughly 5–8% of sessions are high-confidence bots; these sessions should have abnormally high pageview counts and very short inter-event times. Model a sales funnel with the stages homepage → category → product → add_to_cart → checkout → purchase, and target an overall funnel conversion rate of about 2.5%. Traffic should show strong weekly seasonality (weekends at about 1.5× weekday volume) and diurnal patterns with peaks during local evening hours. The dataset should be suitable for testing window functions, sessionization logic, multi-step funnel queries, and skewed group-by workloads on user_id and product_id.",
      "schema": {
        "tables": {
          "web_sessions": {
            "name": "web_sessions",
            "kind": "fact",
            "row_count": 30000000,
            "columns": [
              {
                "name": "session_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "user_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_user.user_id"
              },
              {
                "name": "device_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_device.device_id"
              },
              {
                "name": "referrer_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_referrer.referrer_id"
              },
              {
                "name": "landing_page_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_page.page_id"
              },
              {
                "name": "session_start_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "session_end_ts",
                "sql_type": "DATETIME",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "session_duration_seconds",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "pageview_count",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "event_count",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "bot_detection_score",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "is_high_confidence_bot",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "funnel_exit_stage",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "converted_to_purchase",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "products_viewed_count",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "max_funnel_stage_reached",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "session_start_hour",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "session_start_day_of_week",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "user_id",
                "ref_table": "dim_user",
                "ref_column": "user_id"
              },
              {
                "column": "device_id",
                "ref_table": "dim_device",
                "ref_column": "device_id"
              },
              {
                "column": "referrer_id",
                "ref_table": "dim_referrer",
                "ref_column": "referrer_id"
              },
              {
                "column": "landing_page_id",
                "ref_table": "dim_page",
                "ref_column": "page_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["session_start_ts", "session_end_ts"],
                "dependents": ["session_duration_seconds"]
              },
              {
                "determinants": ["bot_detection_score"],
                "dependents": ["is_high_confidence_bot"]
              }
            ]
          },
          "session_product_view": {
            "name": "session_product_view",
            "kind": "fact",
            "row_count": 150000000,
            "columns": [
              {
                "name": "session_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "web_sessions.session_id"
              },
              {
                "name": "product_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_product.product_id"
              },
              {
                "name": "view_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "view_duration_seconds",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "primary_key": [
              "session_id",
              "product_id",
              "view_ts"
            ],
            "foreign_keys": [
              {
                "column": "session_id",
                "ref_table": "web_sessions",
                "ref_column": "session_id"
              },
              {
                "column": "product_id",
                "ref_table": "dim_product",
                "ref_column": "product_id"
              }
            ]
          },
          "dim_user": {
            "name": "dim_user",
            "kind": "dimension",
            "row_count": 5000000,
            "columns": [
              {
                "name": "user_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "user_email",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "signup_date",
                "sql_type": "DATE",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "country",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "primary_device_type",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["user_email"],
                "dependents": ["user_id", "signup_date", "country", "primary_device_type"]
              }
            ]
          },
          "dim_device": {
            "name": "dim_device",
            "kind": "dimension",
            "row_count": 100000,
            "columns": [
              {
                "name": "device_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "device_type",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "operating_system",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "browser",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_referrer": {
            "name": "dim_referrer",
            "kind": "dimension",
            "row_count": 5000,
            "columns": [
              {
                "name": "referrer_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "referrer_type",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "referrer_domain",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "campaign_code",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_page": {
            "name": "dim_page",
            "kind": "dimension",
            "row_count": 100000,
            "columns": [
              {
                "name": "page_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "page_url",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "page_type",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "is_funnel_stage",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "funnel_stage_order",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["page_url"],
                "dependents": ["page_id", "page_type", "is_funnel_stage", "funnel_stage_order"]
              }
            ]
          },
          "dim_product": {
            "name": "dim_product",
            "kind": "dimension",
            "row_count": 500000,
            "columns": [
              {
                "name": "product_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "product_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "category",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "price",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "foreign_keys": []
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "web_sessions",
            "column": "session_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 30000000.0
            },
            "provider": null
          },
          {
            "table": "web_sessions",
            "column": "user_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 5000000
            },
            "provider": null
          },
          {
            "table": "web_sessions",
            "column": "device_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 100000
            },
            "provider": null
          },
          {
            "table": "web_sessions",
            "column": "referrer_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 5000
            },
            "provider": null
          },
          {
            "table": "web_sessions",
            "column": "landing_page_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 100000
            },
            "provider": null
          },
          {
            "table": "web_sessions",
            "column": "session_start_ts",
            "distribution": {
              "kind": "seasonal",
              "granularity": "week",
              "weights": {
                "Monday": 0.8,
                "Tuesday": 0.8,
                "Wednesday": 0.8,
                "Thursday": 0.8,
                "Friday": 0.8,
                "Saturday": 1.2,
                "Sunday": 1.2
              }
            },
            "provider": null
          },
          {
            "table": "web_sessions",
            "column": "session_end_ts",
            "distribution": {
              "kind": "derived",
              "expression": "session_start_ts + seconds(session_duration_seconds)",
              "dtype": "datetime"
            },
            "provider": null
          },
          {
            "table": "web_sessions",
            "column": "session_duration_seconds",
            "distribution": {
              "kind": "derived",
              "expression": "seconds(session_end_ts - session_start_ts)",
              "dtype": "int"
            },
            "provider": null
          },
          {
            "table": "web_sessions",
            "column": "pageview_count",
            "distribution": {
              "kind": "mixture",
              "components": [
                {
                  "weight": 0.93,
                  "distribution": {
                    "kind": "poisson",
                    "lam": 5.0
                  }
                },
                {
                  "weight": 0.07,
                  "distribution": {
                    "kind": "poisson",
                    "lam": 100.0
                  }
                }
              ]
            },
            "provider": null
          },
          {
            "table": "web_sessions",
            "column": "event_count",
            "distribution": {
              "kind": "lognormal",
              "mean": 2.5,
              "sigma": 1.2
            },
            "provider": null
          },
          {
            "table": "web_sessions",
            "column": "bot_detection_score",
            "distribution": {
              "kind": "mixture",
              "components": [
                {
                  "weight": 0.93,
                  "distribution": {
                    "kind": "uniform",
                    "low": 0.0,
                    "high": 0.3
                  }
                },
                {
                  "weight": 0.07,
                  "distribution": {
                    "kind": "uniform",
                    "low": 0.8,
                    "high": 1.0
                  }
                }
              ]
            },
            "provider": null
          },
          {
            "table": "web_sessions",
            "column": "is_high_confidence_bot",
            "distribution": {
              "kind": "derived",
              "expression": "where(bot_detection_score > 0.8, \"true\", \"false\")",
              "dtype": "bool"
            },
            "provider": null
          },
          {
            "table": "web_sessions",
            "column": "funnel_exit_stage",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["homepage", "category", "product", "add_to_cart", "checkout", "purchase"],
                "probs": [0.15, 0.20, 0.30, 0.20, 0.10, 0.05]
              }
            },
            "provider": null
          },
          {
            "table": "web_sessions",
            "column": "converted_to_purchase",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["true", "false"],
                "probs": [0.025, 0.975]
              }
            },
            "provider": null
          },
          {
            "table": "web_sessions",
            "column": "products_viewed_count",
            "distribution": {
              "kind": "poisson",
              "lam": 3.0
            },
            "provider": null
          },
          {
            "table": "web_sessions",
            "column": "max_funnel_stage_reached",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["homepage", "category", "product", "add_to_cart", "checkout", "purchase"],
                "probs": [0.15, 0.20, 0.30, 0.20, 0.10, 0.05]
              }
            },
            "provider": null
          },
          {
            "table": "web_sessions",
            "column": "session_start_hour",
            "distribution": {
              "kind": "derived",
              "expression": "hour(session_start_ts)",
              "dtype": "int"
            },
            "provider": null
          },
          {
            "table": "web_sessions",
            "column": "session_start_day_of_week",
            "distribution": {
              "kind": "derived",
              "expression": "day_of_week(session_start_ts)",
              "dtype": "int"
            },
            "provider": null
          },
          {
            "table": "session_product_view",
            "column": "session_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 30000000
            },
            "provider": null
          },
          {
            "table": "session_product_view",
            "column": "product_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 500000
            },
            "provider": null
          },
          {
            "table": "session_product_view",
            "column": "view_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "session_product_view",
            "column": "view_duration_seconds",
            "distribution": {
              "kind": "lognormal",
              "mean": 2.0,
              "sigma": 1.0
            },
            "provider": null
          },
          {
            "table": "dim_user",
            "column": "user_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000000.0
            },
            "provider": null
          },
          {
            "table": "dim_user",
            "column": "user_email",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["fake_email"],
                "probs": null
              }
            },
            "provider": {
              "name": "faker.email",
              "config": {}
            }
          },
          {
            "table": "dim_user",
            "column": "signup_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "dim_user",
            "column": "country",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["US", "UK", "CA", "DE", "FR", "JP", "CN"],
                "probs": [0.4, 0.15, 0.1, 0.1, 0.1, 0.1, 0.05]
              }
            },
            "provider": null
          },
          {
            "table": "dim_user",
            "column": "primary_device_type",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["desktop", "mobile", "tablet"],
                "probs": [0.4, 0.5, 0.1]
              }
            },
            "provider": null
          },
          {
            "table": "dim_device",
            "column": "device_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 100000.0
            },
            "provider": null
          },
          {
            "table": "dim_device",
            "column": "device_type",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["desktop", "mobile", "tablet"],
                "probs": [0.4, 0.5, 0.1]
              }
            },
            "provider": null
          },
          {
            "table": "dim_device",
            "column": "operating_system",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Windows", "macOS", "Linux", "iOS", "Android"],
                "probs": [0.3, 0.2, 0.1, 0.2, 0.2]
              }
            },
            "provider": null
          },
          {
            "table": "dim_device",
            "column": "browser",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Chrome", "Firefox", "Safari", "Edge", "Opera"],
                "probs": [0.6, 0.15, 0.15, 0.08, 0.02]
              }
            },
            "provider": null
          },
          {
            "table": "dim_referrer",
            "column": "referrer_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000.0
            },
            "provider": null
          },
          {
            "table": "dim_referrer",
            "column": "referrer_type",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["direct", "search", "social", "email", "affiliate"],
                "probs": [0.3, 0.35, 0.15, 0.1, 0.1]
              }
            },
            "provider": null
          },
          {
            "table": "dim_referrer",
            "column": "referrer_domain",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["google.com", "facebook.com", "twitter.com", "bing.com", "yahoo.com"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_referrer",
            "column": "campaign_code",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["null", "SPRING2024", "SUMMER2024", "BLACKFRIDAY", "CHRISTMAS"],
                "probs": [0.7, 0.1, 0.1, 0.05, 0.05]
              }
            },
            "provider": null
          },
          {
            "table": "dim_page",
            "column": "page_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 100000.0
            },
            "provider": null
          },
          {
            "table": "dim_page",
            "column": "page_url",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["/home", "/category/electronics", "/product/123", "/cart", "/checkout", "/purchase"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_page",
            "column": "page_type",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["homepage", "category", "product", "cart", "checkout", "purchase"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_page",
            "column": "is_funnel_stage",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["true", "false"],
                "probs": [0.3, 0.7]
              }
            },
            "provider": null
          },
          {
            "table": "dim_page",
            "column": "funnel_stage_order",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["1", "2", "3", "4", "5", "6"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_product",
            "column": "product_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 500000.0
            },
            "provider": null
          },
          {
            "table": "dim_product",
            "column": "product_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Product"],
                "probs": null
              }
            },
            "provider": {
              "name": "faker.commerce.product_name",
              "config": {}
            }
          },
          {
            "table": "dim_product",
            "column": "category",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Electronics", "Clothing", "Books", "Home", "Sports", "Toys"],
                "probs": [0.25, 0.2, 0.15, 0.15, 0.15, 0.1]
              }
            },
            "provider": null
          },
          {
            "table": "dim_product",
            "column": "price",
            "distribution": {
              "kind": "lognormal",
              "mean": 3.5,
              "sigma": 1.0
            },
            "provider": null
          }
        ],
        "events": []
      }
    },
    {
      "number": 2,
      "tier": "core",
      "text": "Create an IoT telemetry dataset for 10,000 industrial sensors deployed across 100 plants. There should be one high-frequency fact table called sensor_reading with at least 200 million rows over a 30-day period, plus dimension tables for sensors, plants, and sensor types. Sensor readings (temperature, vibration, current) should mostly remain within normal operating bands that differ by sensor type, with rare anomalies (0.1–0.5% of readings) modeled as spikes, drifts, or sudden step changes. Inject 3–5 \"cascading failure\" incidents in which a single plant experiences coordinated anomalies across many sensors in a narrow time window, and each incident is preceded by subtle early-warning deviations. Timestamps should be approximately uniform over time but with random missing intervals per sensor to simulate connectivity issues. Include synthetic maintenance events that reset some sensors' behavior. The data should stress time-series joins, anomaly detection queries, and \"before/after incident\" window aggregations.",
      "schema": {
        "tables": {
          "sensor_reading": {
            "name": "sensor_reading",
            "kind": "fact",
            "row_count": 200000000,
            "columns": [
              {
                "name": "sensor_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_sensor.sensor_id"
              },
              {
                "name": "reading_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "temperature_c",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "vibration_mm_s",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "current_amp",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "is_anomaly",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "anomaly_type",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "incident_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "failure_incident.incident_id"
              },
              {
                "name": "minutes_since_last_reading",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "sensor_type_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_sensor_type.sensor_type_id"
              }
            ],
            "primary_key": [
              "sensor_id",
              "reading_ts"
            ],
            "foreign_keys": [
              {
                "column": "sensor_id",
                "ref_table": "dim_sensor",
                "ref_column": "sensor_id"
              },
              {
                "column": "incident_id",
                "ref_table": "failure_incident",
                "ref_column": "incident_id"
              },
              {
                "column": "sensor_type_id",
                "ref_table": "dim_sensor_type",
                "ref_column": "sensor_type_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["sensor_id", "reading_ts"],
                "dependents": ["minutes_since_last_reading"]
              },
              {
                "determinants": ["temperature_c", "vibration_mm_s", "current_amp", "sensor_type_id"],
                "dependents": ["is_anomaly", "anomaly_type"]
              }
            ]
          },
          "dim_sensor": {
            "name": "dim_sensor",
            "kind": "dimension",
            "row_count": 10000,
            "columns": [
              {
                "name": "sensor_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "sensor_name",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "plant_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_plant.plant_id"
              },
              {
                "name": "sensor_type_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_sensor_type.sensor_type_id"
              },
              {
                "name": "install_date",
                "sql_type": "DATE",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "status",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "plant_id",
                "ref_table": "dim_plant",
                "ref_column": "plant_id"
              },
              {
                "column": "sensor_type_id",
                "ref_table": "dim_sensor_type",
                "ref_column": "sensor_type_id"
              }
            ]
          },
          "dim_plant": {
            "name": "dim_plant",
            "kind": "dimension",
            "row_count": 100,
            "columns": [
              {
                "name": "plant_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "plant_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "region",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["plant_name"],
                "dependents": ["plant_id", "region"]
              }
            ]
          },
          "dim_sensor_type": {
            "name": "dim_sensor_type",
            "kind": "dimension",
            "row_count": 50,
            "columns": [
              {
                "name": "sensor_type_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "sensor_type_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "normal_temp_min_c",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "normal_temp_max_c",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "normal_vibration_max_mm_s",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["sensor_type_name"],
                "dependents": ["sensor_type_id", "normal_temp_min_c", "normal_temp_max_c", "normal_vibration_max_mm_s"]
              }
            ]
          },
          "failure_incident": {
            "name": "failure_incident",
            "kind": "fact",
            "row_count": 10,
            "columns": [
              {
                "name": "incident_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "plant_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_plant.plant_id"
              },
              {
                "name": "incident_start_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "incident_end_ts",
                "sql_type": "DATETIME",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "severity",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "plant_id",
                "ref_table": "dim_plant",
                "ref_column": "plant_id"
              }
            ]
          },
          "maintenance_event": {
            "name": "maintenance_event",
            "kind": "fact",
            "row_count": 50000,
            "columns": [
              {
                "name": "maintenance_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "sensor_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_sensor.sensor_id"
              },
              {
                "name": "maintenance_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "maintenance_type",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "calibration_reset",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "sensor_id",
                "ref_table": "dim_sensor",
                "ref_column": "sensor_id"
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "sensor_reading",
            "column": "sensor_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 10000
            },
            "provider": null
          },
          {
            "table": "sensor_reading",
            "column": "reading_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "sensor_reading",
            "column": "temperature_c",
            "distribution": {
              "kind": "normal",
              "mean": 25.0,
              "std": 5.0
            },
            "provider": null
          },
          {
            "table": "sensor_reading",
            "column": "vibration_mm_s",
            "distribution": {
              "kind": "normal",
              "mean": 10.0,
              "std": 3.0
            },
            "provider": null
          },
          {
            "table": "sensor_reading",
            "column": "current_amp",
            "distribution": {
              "kind": "normal",
              "mean": 5.0,
              "std": 1.5
            },
            "provider": null
          },
          {
            "table": "sensor_reading",
            "column": "is_anomaly",
            "distribution": {
              "kind": "derived",
              "expression": "where((temperature_c < normal_temp_min_c or temperature_c > normal_temp_max_c) or vibration_mm_s > normal_vibration_max_mm_s, \"true\", \"false\")",
              "dtype": "bool"
            },
            "provider": null
          },
          {
            "table": "sensor_reading",
            "column": "anomaly_type",
            "distribution": {
              "kind": "derived",
              "expression": "where(is_anomaly == \"true\", weighted_choice(\"spike\", 0.4, \"drift\", 0.3, \"step_change\", 0.3), null)",
              "dtype": "text"
            },
            "provider": null
          },
          {
            "table": "sensor_reading",
            "column": "incident_id",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["null", "1", "2", "3", "4", "5"],
                "probs": [0.998, 0.0004, 0.0004, 0.0004, 0.0004, 0.0004]
              }
            },
            "provider": null
          },
          {
            "table": "sensor_reading",
            "column": "minutes_since_last_reading",
            "distribution": {
              "kind": "window",
              "expression": "minutes(reading_ts - lag(reading_ts, 1))",
              "partition_by": ["sensor_id"],
              "order_by": "reading_ts",
              "frame": {
                "type": "ROWS",
                "preceding": "1"
              },
              "dtype": "int"
            },
            "provider": null
          },
          {
            "table": "sensor_reading",
            "column": "sensor_type_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 50
            },
            "provider": null
          },
          {
            "table": "dim_sensor",
            "column": "sensor_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000.0
            },
            "provider": null
          },
          {
            "table": "dim_sensor",
            "column": "sensor_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Sensor"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_sensor",
            "column": "plant_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 100
            },
            "provider": null
          },
          {
            "table": "dim_sensor",
            "column": "sensor_type_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 50
            },
            "provider": null
          },
          {
            "table": "dim_sensor",
            "column": "install_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "dim_sensor",
            "column": "status",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["active", "maintenance", "inactive"],
                "probs": [0.95, 0.03, 0.02]
              }
            },
            "provider": null
          },
          {
            "table": "dim_plant",
            "column": "plant_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 100.0
            },
            "provider": null
          },
          {
            "table": "dim_plant",
            "column": "plant_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Plant"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_plant",
            "column": "region",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["North", "South", "East", "West", "Central"],
                "probs": [0.2, 0.2, 0.2, 0.2, 0.2]
              }
            },
            "provider": null
          },
          {
            "table": "dim_sensor_type",
            "column": "sensor_type_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 50.0
            },
            "provider": null
          },
          {
            "table": "dim_sensor_type",
            "column": "sensor_type_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Temperature", "Vibration", "Current", "Pressure", "Flow"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_sensor_type",
            "column": "normal_temp_min_c",
            "distribution": {
              "kind": "normal",
              "mean": 20.0,
              "std": 5.0
            },
            "provider": null
          },
          {
            "table": "dim_sensor_type",
            "column": "normal_temp_max_c",
            "distribution": {
              "kind": "normal",
              "mean": 30.0,
              "std": 5.0
            },
            "provider": null
          },
          {
            "table": "dim_sensor_type",
            "column": "normal_vibration_max_mm_s",
            "distribution": {
              "kind": "normal",
              "mean": 15.0,
              "std": 3.0
            },
            "provider": null
          },
          {
            "table": "failure_incident",
            "column": "incident_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5.0
            },
            "provider": null
          },
          {
            "table": "failure_incident",
            "column": "plant_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 100
            },
            "provider": null
          },
          {
            "table": "failure_incident",
            "column": "incident_start_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "failure_incident",
            "column": "incident_end_ts",
            "distribution": {
              "kind": "derived",
              "expression": "incident_start_ts + hours(2)",
              "dtype": "datetime"
            },
            "provider": null
          },
          {
            "table": "failure_incident",
            "column": "severity",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["low", "medium", "high", "critical"],
                "probs": [0.2, 0.3, 0.3, 0.2]
              }
            },
            "provider": null
          }
        ],
        "events": [
          {
            "name": "cascading_failure_1",
            "start_time": "2024-01-15T10:00:00Z",
            "end_time": "2024-01-15T12:00:00Z",
            "effects": [
              {
                "table": "sensor_reading",
                "column": "temperature_c",
                "effect_type": "multiply_distribution",
                "value": 1.5
              },
              {
                "table": "sensor_reading",
                "column": "vibration_mm_s",
                "effect_type": "multiply_distribution",
                "value": 2.0
              }
            ]
          },
          {
            "name": "cascading_failure_2",
            "start_time": "2024-01-20T14:00:00Z",
            "end_time": "2024-01-20T16:00:00Z",
            "effects": [
              {
                "table": "sensor_reading",
                "column": "temperature_c",
                "effect_type": "multiply_distribution",
                "value": 1.5
              },
              {
                "table": "sensor_reading",
                "column": "vibration_mm_s",
                "effect_type": "multiply_distribution",
                "value": 2.0
              }
            ]
          },
          {
            "name": "maintenance_reset",
            "start_time": "2024-01-10T00:00:00Z",
            "end_time": "2024-01-10T23:59:59Z",
            "effects": [
              {
                "table": "dim_sensor",
                "column": "status",
                "effect_type": "set_value",
                "value": "maintenance"
              }
            ]
          }
        ]
      }
    },
    {
      "number": 3,
      "tier": "core",
      "text": "Generate a financial transactions dataset with a large transaction fact table (at least 50 million rows) and dimension tables for customers, merchants, cards, and geography. Legitimate transactions should form the majority, with card-level spending showing strong weekly seasonality and pay-day spikes around the 1st and 15th of each month. Inject multiple fraud patterns: low-value test transactions followed by one or more high-value purchases; coordinated fraud rings where many cards transact with the same merchant in a short time window; and location anomalies where the same card has transactions in geographically distant locations within an impossible travel time. Label a small fraction of transactions as \"confirmed_fraud\", while leaving many suspicious patterns unlabeled. Transaction amounts should follow a log-normal distribution with a heavy tail, and merchant categories like electronics and travel should be over-represented among high-value transactions. The dataset should be useful for graph-based fraud detection queries, geo-temporal anomaly detection, and group-by workloads heavily skewed on merchant_id.",
      "schema": {
        "tables": {
          "card_transaction": {
            "name": "card_transaction",
            "kind": "fact",
            "row_count": 50000000,
            "columns": [
              {
                "name": "transaction_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "transaction_datetime",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "customer_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_customer.customer_id"
              },
              {
                "name": "card_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_card.card_id"
              },
              {
                "name": "merchant_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_merchant.merchant_id"
              },
              {
                "name": "merchant_geo_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_geography.geo_id"
              },
              {
                "name": "card_home_geo_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_geography.geo_id"
              },
              {
                "name": "amount_usd",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "currency_code",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "exchange_rate",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "amount_local_currency",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "mcc_code",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "is_card_present",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "confirmed_fraud",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "fraud_pattern_label",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "customer_id",
                "ref_table": "dim_customer",
                "ref_column": "customer_id"
              },
              {
                "column": "card_id",
                "ref_table": "dim_card",
                "ref_column": "card_id"
              },
              {
                "column": "merchant_id",
                "ref_table": "dim_merchant",
                "ref_column": "merchant_id"
              },
              {
                "column": "merchant_geo_id",
                "ref_table": "dim_geography",
                "ref_column": "geo_id"
              },
              {
                "column": "card_home_geo_id",
                "ref_table": "dim_geography",
                "ref_column": "geo_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["amount_usd", "exchange_rate"],
                "dependents": ["amount_local_currency"]
              }
            ]
          },
          "dim_customer": {
            "name": "dim_customer",
            "kind": "dimension",
            "row_count": 5000000,
            "columns": [
              {
                "name": "customer_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "customer_name",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "segment",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "home_geo_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_geography.geo_id"
              }
            ],
            "foreign_keys": [
              {
                "column": "home_geo_id",
                "ref_table": "dim_geography",
                "ref_column": "geo_id"
              }
            ]
          },
          "dim_card": {
            "name": "dim_card",
            "kind": "dimension",
            "row_count": 7000000,
            "columns": [
              {
                "name": "card_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "customer_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_customer.customer_id"
              },
              {
                "name": "card_network",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "product_type",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "customer_id",
                "ref_table": "dim_customer",
                "ref_column": "customer_id"
              }
            ]
          },
          "dim_merchant": {
            "name": "dim_merchant",
            "kind": "dimension",
            "row_count": 500000,
            "columns": [
              {
                "name": "merchant_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "merchant_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "category",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "geo_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_geography.geo_id"
              }
            ],
            "foreign_keys": [
              {
                "column": "geo_id",
                "ref_table": "dim_geography",
                "ref_column": "geo_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["merchant_name"],
                "dependents": ["merchant_id", "category", "geo_id"]
              }
            ]
          },
          "dim_geography": {
            "name": "dim_geography",
            "kind": "dimension",
            "row_count": 10000,
            "columns": [
              {
                "name": "geo_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "country_code",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "region",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "city",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": []
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "card_transaction",
            "column": "transaction_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 50000000.0
            },
            "provider": null
          },
          {
            "table": "card_transaction",
            "column": "transaction_datetime",
            "distribution": {
              "kind": "seasonal",
              "granularity": "week",
              "weights": {
                "Monday": 0.8,
                "Tuesday": 0.8,
                "Wednesday": 0.8,
                "Thursday": 0.8,
                "Friday": 0.8,
                "Saturday": 1.2,
                "Sunday": 1.2
              }
            },
            "provider": null
          },
          {
            "table": "card_transaction",
            "column": "customer_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 5000000
            },
            "provider": null
          },
          {
            "table": "card_transaction",
            "column": "card_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 7000000
            },
            "provider": null
          },
          {
            "table": "card_transaction",
            "column": "merchant_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 500000
            },
            "provider": null
          },
          {
            "table": "card_transaction",
            "column": "merchant_geo_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 10000
            },
            "provider": null
          },
          {
            "table": "card_transaction",
            "column": "card_home_geo_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 10000
            },
            "provider": null
          },
          {
            "table": "card_transaction",
            "column": "amount_usd",
            "distribution": {
              "kind": "mixture",
              "components": [
                {
                  "weight": 0.3,
                  "distribution": {
                    "kind": "lognormal",
                    "mean": 4.0,
                    "sigma": 1.5
                  },
                  "condition": {
                    "column": "category",
                    "op": "in",
                    "value": ["electronics", "travel"]
                  }
                },
                {
                  "weight": 0.7,
                  "distribution": {
                    "kind": "lognormal",
                    "mean": 2.5,
                    "sigma": 1.0
                  },
                  "condition": null
                }
              ]
            },
            "provider": null
          },
          {
            "table": "card_transaction",
            "column": "currency_code",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["USD", "EUR", "GBP", "JPY", "CNY"],
                "probs": [0.5, 0.2, 0.1, 0.1, 0.1]
              }
            },
            "provider": null
          },
          {
            "table": "card_transaction",
            "column": "exchange_rate",
            "distribution": {
              "kind": "normal",
              "mean": 1.0,
              "std": 0.1
            },
            "provider": null
          },
          {
            "table": "card_transaction",
            "column": "amount_local_currency",
            "distribution": {
              "kind": "derived",
              "expression": "amount_usd * exchange_rate",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "card_transaction",
            "column": "mcc_code",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["5411", "5812", "5814", "7011", "5999"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "card_transaction",
            "column": "is_card_present",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["true", "false"],
                "probs": [0.7, 0.3]
              }
            },
            "provider": null
          },
          {
            "table": "card_transaction",
            "column": "confirmed_fraud",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["true", "false"],
                "probs": [0.01, 0.99]
              }
            },
            "provider": null
          },
          {
            "table": "card_transaction",
            "column": "fraud_pattern_label",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["null", "test_then_high", "fraud_ring", "impossible_travel"],
                "probs": [0.95, 0.02, 0.02, 0.01]
              }
            },
            "provider": null
          },
          {
            "table": "dim_customer",
            "column": "customer_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000000.0
            },
            "provider": null
          },
          {
            "table": "dim_customer",
            "column": "customer_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Customer"],
                "probs": null
              }
            },
            "provider": {
              "name": "faker.name",
              "config": {}
            }
          },
          {
            "table": "dim_customer",
            "column": "segment",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["premium", "standard", "basic"],
                "probs": [0.2, 0.5, 0.3]
              }
            },
            "provider": null
          },
          {
            "table": "dim_customer",
            "column": "home_geo_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 10000
            },
            "provider": null
          },
          {
            "table": "dim_card",
            "column": "card_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 7000000.0
            },
            "provider": null
          },
          {
            "table": "dim_card",
            "column": "customer_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 5000000
            },
            "provider": null
          },
          {
            "table": "dim_card",
            "column": "card_network",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Visa", "Mastercard", "Amex", "Discover"],
                "probs": [0.5, 0.3, 0.15, 0.05]
              }
            },
            "provider": null
          },
          {
            "table": "dim_card",
            "column": "product_type",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["credit", "debit", "prepaid"],
                "probs": [0.6, 0.35, 0.05]
              }
            },
            "provider": null
          },
          {
            "table": "dim_merchant",
            "column": "merchant_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 500000.0
            },
            "provider": null
          },
          {
            "table": "dim_merchant",
            "column": "merchant_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Merchant"],
                "probs": null
              }
            },
            "provider": {
              "name": "faker.company",
              "config": {}
            }
          },
          {
            "table": "dim_merchant",
            "column": "category",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["groceries", "electronics", "travel", "restaurants", "gas", "retail"],
                "probs": [0.25, 0.15, 0.15, 0.2, 0.1, 0.15]
              }
            },
            "provider": null
          },
          {
            "table": "dim_merchant",
            "column": "geo_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 10000
            },
            "provider": null
          },
          {
            "table": "dim_geography",
            "column": "geo_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000.0
            },
            "provider": null
          },
          {
            "table": "dim_geography",
            "column": "country_code",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["US", "GB", "CA", "DE", "FR", "JP", "CN"],
                "probs": [0.4, 0.15, 0.1, 0.1, 0.1, 0.1, 0.05]
              }
            },
            "provider": null
          },
          {
            "table": "dim_geography",
            "column": "region",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["North", "South", "East", "West", "Central"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_geography",
            "column": "city",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["City"],
                "probs": null
              }
            },
            "provider": {
              "name": "faker.city",
              "config": {}
            }
          }
        ],
        "events": [
          {
            "name": "pay_day_spike_1st",
            "start_time": "2024-01-01T00:00:00Z",
            "end_time": "2024-01-01T23:59:59Z",
            "effects": [
              {
                "table": "card_transaction",
                "column": "amount_usd",
                "effect_type": "multiply_distribution",
                "value": 1.5
              }
            ]
          },
          {
            "name": "pay_day_spike_15th",
            "start_time": "2024-01-15T00:00:00Z",
            "end_time": "2024-01-15T23:59:59Z",
            "effects": [
              {
                "table": "card_transaction",
                "column": "amount_usd",
                "effect_type": "multiply_distribution",
                "value": 1.5
              }
            ]
          },
          {
            "name": "fraud_ring_merchant_123",
            "start_time": "2024-01-15T10:00:00Z",
            "end_time": "2024-01-15T11:00:00Z",
            "effects": [
              {
                "table": "card_transaction",
                "column": "amount_usd",
                "effect_type": "multiply_distribution",
                "value": 5.0
              },
              {
                "table": "card_transaction",
                "column": "merchant_id",
                "effect_type": "set_value",
                "value": 123
              },
              {
                "table": "card_transaction",
                "column": "fraud_pattern_label",
                "effect_type": "set_value",
                "value": "fraud_ring"
              }
            ]
          },
          {
            "name": "test_then_high_value",
            "start_time": "2024-01-20T14:00:00Z",
            "end_time": "2024-01-20T15:00:00Z",
            "effects": [
              {
                "table": "card_transaction",
                "column": "amount_usd",
                "effect_type": "multiply_distribution",
                "value": 0.1
              },
              {
                "table": "card_transaction",
                "column": "fraud_pattern_label",
                "effect_type": "set_value",
                "value": "test_then_high"
              }
            ]
          }
        ]
      }
    },
    {
      "number": 4,
      "tier": "core",
      "text": "Create a synthetic healthcare dataset modeling longitudinal patient records. Include an encounter fact table (visits and admissions) with roughly 10 million rows, plus dimensions for patient, provider, facility, diagnosis, procedure, and medication. Patients should follow different care pathways for chronic conditions such as diabetes and hypertension, with diagnosis codes appearing before related medications and procedures in plausible temporal sequences. Age distribution should be skewed toward older patients, and comorbid conditions should cluster realistically (for example, diabetes and hypertension often co-occur). Introduce a policy change at a specific date that shifts treatment protocols, causing different medication and procedure patterns after that date. Include re-admission patterns where some patients are re-admitted within 30 days with related diagnoses. The dataset should be designed to stress complex cohort definitions, survival and time-to-event analyses, and joins across many dimensions with highly skewed diagnosis and procedure codes.",
      "schema": {
        "tables": {
          "encounter": {
            "name": "encounter",
            "kind": "fact",
            "row_count": 10000000,
            "columns": [
              {
                "name": "encounter_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "patient_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_patient.patient_id"
              },
              {
                "name": "provider_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_provider.provider_id"
              },
              {
                "name": "facility_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_facility.facility_id"
              },
              {
                "name": "encounter_start_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "encounter_end_ts",
                "sql_type": "DATETIME",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "encounter_type",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "primary_diagnosis_code",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": "dim_diagnosis.diagnosis_code"
              },
              {
                "name": "readmission_30d_flag",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "policy_period",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "patient_id",
                "ref_table": "dim_patient",
                "ref_column": "patient_id"
              },
              {
                "column": "provider_id",
                "ref_table": "dim_provider",
                "ref_column": "provider_id"
              },
              {
                "column": "facility_id",
                "ref_table": "dim_facility",
                "ref_column": "facility_id"
              }
            ]
          },
          "encounter_diagnosis": {
            "name": "encounter_diagnosis",
            "kind": "fact",
            "row_count": 30000000,
            "columns": [
              {
                "name": "encounter_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "encounter.encounter_id"
              },
              {
                "name": "diagnosis_code",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_diagnosis.diagnosis_code"
              },
              {
                "name": "sequence_number",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "primary_key": [
              "encounter_id",
              "diagnosis_code"
            ],
            "foreign_keys": [
              {
                "column": "encounter_id",
                "ref_table": "encounter",
                "ref_column": "encounter_id"
              },
              {
                "column": "diagnosis_code",
                "ref_table": "dim_diagnosis",
                "ref_column": "diagnosis_code"
              }
            ]
          },
          "encounter_procedure": {
            "name": "encounter_procedure",
            "kind": "fact",
            "row_count": 20000000,
            "columns": [
              {
                "name": "encounter_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "encounter.encounter_id"
              },
              {
                "name": "procedure_code",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_procedure.procedure_code"
              },
              {
                "name": "procedure_ts",
                "sql_type": "DATETIME",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "primary_key": [
              "encounter_id",
              "procedure_code"
            ],
            "foreign_keys": [
              {
                "column": "encounter_id",
                "ref_table": "encounter",
                "ref_column": "encounter_id"
              },
              {
                "column": "procedure_code",
                "ref_table": "dim_procedure",
                "ref_column": "procedure_code"
              }
            ]
          },
          "encounter_medication": {
            "name": "encounter_medication",
            "kind": "fact",
            "row_count": 20000000,
            "columns": [
              {
                "name": "encounter_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "encounter.encounter_id"
              },
              {
                "name": "medication_code",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_medication.medication_code"
              },
              {
                "name": "administration_ts",
                "sql_type": "DATETIME",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "primary_key": [
              "encounter_id",
              "medication_code"
            ],
            "foreign_keys": [
              {
                "column": "encounter_id",
                "ref_table": "encounter",
                "ref_column": "encounter_id"
              },
              {
                "column": "medication_code",
                "ref_table": "dim_medication",
                "ref_column": "medication_code"
              }
            ]
          },
          "dim_patient": {
            "name": "dim_patient",
            "kind": "dimension",
            "row_count": 1000000,
            "columns": [
              {
                "name": "patient_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "birth_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "sex",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["patient_id"],
                "dependents": ["birth_date", "sex"]
              }
            ]
          },
          "dim_provider": {
            "name": "dim_provider",
            "kind": "dimension",
            "row_count": 50000,
            "columns": [
              {
                "name": "provider_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "provider_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "specialty",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["provider_name"],
                "dependents": ["provider_id", "specialty"]
              }
            ]
          },
          "dim_facility": {
            "name": "dim_facility",
            "kind": "dimension",
            "row_count": 1000,
            "columns": [
              {
                "name": "facility_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "facility_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "facility_type",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["facility_name"],
                "dependents": ["facility_id", "facility_type"]
              }
            ]
          },
          "dim_diagnosis": {
            "name": "dim_diagnosis",
            "kind": "dimension",
            "row_count": 5000,
            "columns": [
              {
                "name": "diagnosis_code",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "diagnosis_description",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_procedure": {
            "name": "dim_procedure",
            "kind": "dimension",
            "row_count": 5000,
            "columns": [
              {
                "name": "procedure_code",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "procedure_description",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_medication": {
            "name": "dim_medication",
            "kind": "dimension",
            "row_count": 5000,
            "columns": [
              {
                "name": "medication_code",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "medication_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": []
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "encounter",
            "column": "encounter_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000000.0
            },
            "provider": null
          },
          {
            "table": "encounter",
            "column": "patient_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 1000000
            },
            "provider": null
          },
          {
            "table": "encounter",
            "column": "provider_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 50000
            },
            "provider": null
          },
          {
            "table": "encounter",
            "column": "facility_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 1000
            },
            "provider": null
          },
          {
            "table": "encounter",
            "column": "encounter_start_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "encounter",
            "column": "encounter_end_ts",
            "distribution": {
              "kind": "derived",
              "expression": "encounter_start_ts + hours(uniform(1, 48))",
              "dtype": "datetime"
            },
            "provider": null
          },
          {
            "table": "encounter",
            "column": "encounter_type",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["visit", "admission", "emergency", "outpatient"],
                "probs": [0.5, 0.2, 0.15, 0.15]
              }
            },
            "provider": null
          },
          {
            "table": "encounter",
            "column": "primary_diagnosis_code",
            "distribution": {
              "kind": "zipf",
              "s": 1.5,
              "n": 5000
            },
            "provider": null
          },
          {
            "table": "encounter",
            "column": "readmission_30d_flag",
            "distribution": {
              "kind": "window",
              "expression": "where(count(*) over (partition by patient_id order by encounter_start_ts range between '30d' preceding and current row) > 1, \"true\", \"false\")",
              "partition_by": ["patient_id"],
              "order_by": "encounter_start_ts",
              "frame": {
                "type": "RANGE",
                "preceding": "30d"
              },
              "dtype": "bool"
            },
            "provider": null
          },
          {
            "table": "encounter",
            "column": "policy_period",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["before", "after"],
                "probs": [0.5, 0.5]
              }
            },
            "provider": null
          },
          {
            "table": "encounter_diagnosis",
            "column": "encounter_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 10000000
            },
            "provider": null
          },
          {
            "table": "encounter_diagnosis",
            "column": "diagnosis_code",
            "distribution": {
              "kind": "zipf",
              "s": 1.5,
              "n": 5000
            },
            "provider": null
          },
          {
            "table": "encounter_diagnosis",
            "column": "sequence_number",
            "distribution": {
              "kind": "poisson",
              "lam": 2.0
            },
            "provider": null
          },
          {
            "table": "encounter_procedure",
            "column": "encounter_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 10000000
            },
            "provider": null
          },
          {
            "table": "encounter_procedure",
            "column": "procedure_code",
            "distribution": {
              "kind": "zipf",
              "s": 1.5,
              "n": 5000
            },
            "provider": null
          },
          {
            "table": "encounter_procedure",
            "column": "procedure_ts",
            "distribution": {
              "kind": "derived",
              "expression": "encounter_start_ts + hours(uniform(0, 24))",
              "dtype": "datetime"
            },
            "provider": null
          },
          {
            "table": "encounter_medication",
            "column": "encounter_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 10000000
            },
            "provider": null
          },
          {
            "table": "encounter_medication",
            "column": "medication_code",
            "distribution": {
              "kind": "zipf",
              "s": 1.5,
              "n": 5000
            },
            "provider": null
          },
          {
            "table": "encounter_medication",
            "column": "administration_ts",
            "distribution": {
              "kind": "derived",
              "expression": "encounter_start_ts + hours(uniform(0, 24))",
              "dtype": "datetime"
            },
            "provider": null
          },
          {
            "table": "dim_patient",
            "column": "patient_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000000.0
            },
            "provider": null
          },
          {
            "table": "dim_patient",
            "column": "birth_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "dim_patient",
            "column": "sex",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["M", "F", "Other"],
                "probs": [0.49, 0.49, 0.02]
              }
            },
            "provider": null
          },
          {
            "table": "dim_provider",
            "column": "provider_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 50000.0
            },
            "provider": null
          },
          {
            "table": "dim_provider",
            "column": "provider_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Provider"],
                "probs": null
              }
            },
            "provider": {
              "name": "faker.name",
              "config": {}
            }
          },
          {
            "table": "dim_provider",
            "column": "specialty",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Cardiology", "Oncology", "Orthopedics", "General", "Pediatrics"],
                "probs": [0.2, 0.15, 0.15, 0.3, 0.2]
              }
            },
            "provider": null
          },
          {
            "table": "dim_facility",
            "column": "facility_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000.0
            },
            "provider": null
          },
          {
            "table": "dim_facility",
            "column": "facility_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Hospital"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_facility",
            "column": "facility_type",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Hospital", "Clinic", "Emergency", "Outpatient"],
                "probs": [0.4, 0.3, 0.15, 0.15]
              }
            },
            "provider": null
          },
          {
            "table": "dim_diagnosis",
            "column": "diagnosis_code",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000.0
            },
            "provider": null
          },
          {
            "table": "dim_diagnosis",
            "column": "diagnosis_description",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Diagnosis"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_procedure",
            "column": "procedure_code",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000.0
            },
            "provider": null
          },
          {
            "table": "dim_procedure",
            "column": "procedure_description",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Procedure"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_medication",
            "column": "medication_code",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000.0
            },
            "provider": null
          },
          {
            "table": "dim_medication",
            "column": "medication_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Medication"],
                "probs": null
              }
            },
            "provider": null
          }
        ],
        "events": [
          {
            "name": "policy_change",
            "start_time": "2024-06-01T00:00:00Z",
            "end_time": null,
            "effects": [
              {
                "table": "encounter",
                "column": "policy_period",
                "effect_type": "set_value",
                "value": "after"
              }
            ]
          }
        ]
      }
    },
    {
      "number": 5,
      "tier": "core",
      "text": "Generate a ride-sharing dataset with a trips fact table containing at least 40 million trips and dimension tables for rider, driver, geographic zone, and vehicle type. Trip durations and distances should follow realistic urban distributions, with different patterns for rush hours, nights, and off-peak times. Implement spatial–temporal surge pricing: certain zones at specific times should have a surge multiplier applied, especially around simulated events such as concerts, sports games, and public holidays. Model driver churn: new drivers join over time, some drivers become inactive after sequences of low earnings or long idle periods. Cancellation rates should be higher during adverse conditions such as heavy rain, very high surge, or long estimated arrival times. The dataset should stress spatiotemporal joins, group-by aggregations by zone and time-of-day, and highly skewed load in popular zones during surge events.",
      "schema": {
        "tables": {
          "trip": {
            "name": "trip",
            "kind": "fact",
            "row_count": 40000000,
            "columns": [
              {
                "name": "trip_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "rider_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_rider.rider_id"
              },
              {
                "name": "driver_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_driver.driver_id"
              },
              {
                "name": "pickup_zone_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_zone.zone_id"
              },
              {
                "name": "dropoff_zone_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_zone.zone_id"
              },
              {
                "name": "vehicle_type_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_vehicle_type.vehicle_type_id"
              },
              {
                "name": "request_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "pickup_ts",
                "sql_type": "DATETIME",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "dropoff_ts",
                "sql_type": "DATETIME",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "trip_duration_minutes",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "trip_distance_km",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "surge_multiplier",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "base_fare",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "total_fare",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "status",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "cancellation_reason",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "weather_condition",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "estimated_arrival_minutes",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "driver_earnings",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "rider_id",
                "ref_table": "dim_rider",
                "ref_column": "rider_id"
              },
              {
                "column": "driver_id",
                "ref_table": "dim_driver",
                "ref_column": "driver_id"
              },
              {
                "column": "pickup_zone_id",
                "ref_table": "dim_zone",
                "ref_column": "zone_id"
              },
              {
                "column": "dropoff_zone_id",
                "ref_table": "dim_zone",
                "ref_column": "zone_id"
              },
              {
                "column": "vehicle_type_id",
                "ref_table": "dim_vehicle_type",
                "ref_column": "vehicle_type_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["pickup_ts", "dropoff_ts"],
                "dependents": ["trip_duration_minutes"]
              },
              {
                "determinants": ["base_fare", "surge_multiplier"],
                "dependents": ["total_fare"]
              }
            ]
          },
          "dim_rider": {
            "name": "dim_rider",
            "kind": "dimension",
            "row_count": 10000000,
            "columns": [
              {
                "name": "rider_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "signup_date",
                "sql_type": "DATE",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_driver": {
            "name": "dim_driver",
            "kind": "dimension",
            "row_count": 500000,
            "columns": [
              {
                "name": "driver_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "onboard_date",
                "sql_type": "DATE",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "status",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "offboard_date",
                "sql_type": "DATE",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_zone": {
            "name": "dim_zone",
            "kind": "dimension",
            "row_count": 1000,
            "columns": [
              {
                "name": "zone_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "zone_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "city",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["zone_name"],
                "dependents": ["zone_id", "city"]
              }
            ]
          },
          "dim_vehicle_type": {
            "name": "dim_vehicle_type",
            "kind": "dimension",
            "row_count": 20,
            "columns": [
              {
                "name": "vehicle_type_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "vehicle_type_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["vehicle_type_name"],
                "dependents": ["vehicle_type_id"]
              }
            ]
          },
          "event": {
            "name": "event",
            "kind": "fact",
            "row_count": 5000,
            "columns": [
              {
                "name": "event_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "event_type",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "event_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "zone_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_zone.zone_id"
              },
              {
                "name": "event_start_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "event_end_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "surge_impact_multiplier",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "zone_id",
                "ref_table": "dim_zone",
                "ref_column": "zone_id"
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "trip",
            "column": "trip_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 40000000.0
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "rider_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 10000000
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "driver_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 500000
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "pickup_zone_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 1000
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "dropoff_zone_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 1000
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "vehicle_type_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 20
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "request_ts",
            "distribution": {
              "kind": "seasonal",
              "granularity": "hour",
              "weights": {
                "00:00-05:00": 0.3,
                "05:00-07:00": 0.5,
                "07:00-09:00": 1.5,
                "09:00-12:00": 1.0,
                "12:00-14:00": 1.2,
                "14:00-17:00": 1.0,
                "17:00-19:00": 1.5,
                "19:00-21:00": 1.2,
                "21:00-24:00": 0.8
              }
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "pickup_ts",
            "distribution": {
              "kind": "derived",
              "expression": "request_ts + minutes(uniform(2, 15))",
              "dtype": "datetime"
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "dropoff_ts",
            "distribution": {
              "kind": "derived",
              "expression": "pickup_ts + minutes(trip_duration_minutes)",
              "dtype": "datetime"
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "trip_duration_minutes",
            "distribution": {
              "kind": "derived",
              "expression": "minutes(dropoff_ts - pickup_ts)",
              "dtype": "int"
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "trip_distance_km",
            "distribution": {
              "kind": "lognormal",
              "mean": 2.0,
              "sigma": 1.0
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "surge_multiplier",
            "distribution": {
              "kind": "mixture",
              "components": [
                {
                  "weight": 0.85,
                  "distribution": {
                    "kind": "uniform",
                    "low": 1.0,
                    "high": 1.5
                  }
                },
                {
                  "weight": 0.15,
                  "distribution": {
                    "kind": "uniform",
                    "low": 1.5,
                    "high": 3.0
                  }
                }
              ]
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "base_fare",
            "distribution": {
              "kind": "lognormal",
              "mean": 2.5,
              "sigma": 0.8
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "total_fare",
            "distribution": {
              "kind": "derived",
              "expression": "base_fare * surge_multiplier",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "status",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["requested", "assigned", "in_progress", "completed", "cancelled"],
                "probs": [0.05, 0.05, 0.05, 0.8, 0.05]
              }
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "cancellation_reason",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["null", "heavy_rain", "high_surge", "long_eta", "rider_cancelled", "driver_cancelled"],
                "probs": [0.85, 0.03, 0.03, 0.03, 0.03, 0.03]
              }
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "weather_condition",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["clear", "rain", "heavy_rain", "snow"],
                "probs": [0.7, 0.2, 0.05, 0.05]
              }
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "estimated_arrival_minutes",
            "distribution": {
              "kind": "poisson",
              "lam": 8.0
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "driver_earnings",
            "distribution": {
              "kind": "derived",
              "expression": "total_fare * 0.75",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "dim_rider",
            "column": "rider_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000000.0
            },
            "provider": null
          },
          {
            "table": "dim_rider",
            "column": "signup_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "dim_driver",
            "column": "driver_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 500000.0
            },
            "provider": null
          },
          {
            "table": "dim_driver",
            "column": "onboard_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "dim_driver",
            "column": "status",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["active", "inactive", "suspended"],
                "probs": [0.85, 0.12, 0.03]
              }
            },
            "provider": null
          },
          {
            "table": "dim_driver",
            "column": "offboard_date",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["null", "date"],
                "probs": [0.85, 0.15]
              }
            },
            "provider": null
          },
          {
            "table": "dim_zone",
            "column": "zone_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000.0
            },
            "provider": null
          },
          {
            "table": "dim_zone",
            "column": "zone_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Zone"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_zone",
            "column": "city",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["New York", "Los Angeles", "Chicago", "Houston", "Phoenix"],
                "probs": [0.3, 0.25, 0.2, 0.15, 0.1]
              }
            },
            "provider": null
          },
          {
            "table": "dim_vehicle_type",
            "column": "vehicle_type_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 20.0
            },
            "provider": null
          },
          {
            "table": "dim_vehicle_type",
            "column": "vehicle_type_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["economy", "comfort", "premium", "luxury", "xl"],
                "probs": [0.5, 0.25, 0.15, 0.05, 0.05]
              }
            },
            "provider": null
          },
          {
            "table": "event",
            "column": "event_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000.0
            },
            "provider": null
          },
          {
            "table": "event",
            "column": "event_type",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["concert", "sports_game", "public_holiday", "festival"],
                "probs": [0.3, 0.3, 0.2, 0.2]
              }
            },
            "provider": null
          },
          {
            "table": "event",
            "column": "event_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Event"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "event",
            "column": "zone_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 1000
            },
            "provider": null
          },
          {
            "table": "event",
            "column": "event_start_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "event",
            "column": "event_end_ts",
            "distribution": {
              "kind": "derived",
              "expression": "event_start_ts + hours(4)",
              "dtype": "datetime"
            },
            "provider": null
          },
          {
            "table": "event",
            "column": "surge_impact_multiplier",
            "distribution": {
              "kind": "uniform",
              "low": 1.5,
              "high": 3.0
            },
            "provider": null
          }
        ],
        "events": [
          {
            "name": "concert_surge_zone_123",
            "start_time": "2024-01-15T19:00:00Z",
            "end_time": "2024-01-15T23:00:00Z",
            "effects": [
              {
                "table": "trip",
                "column": "surge_multiplier",
                "effect_type": "multiply_distribution",
                "value": 2.5
              }
            ]
          },
          {
            "name": "sports_game_surge",
            "start_time": "2024-01-20T14:00:00Z",
            "end_time": "2024-01-20T18:00:00Z",
            "effects": [
              {
                "table": "trip",
                "column": "surge_multiplier",
                "effect_type": "multiply_distribution",
                "value": 2.0
              }
            ]
          },
          {
            "name": "public_holiday_surge",
            "start_time": "2024-01-01T00:00:00Z",
            "end_time": "2024-01-01T23:59:59Z",
            "effects": [
              {
                "table": "trip",
                "column": "surge_multiplier",
                "effect_type": "multiply_distribution",
                "value": 1.8
              }
            ]
          }
        ]
      }
    },
    {
      "number": 6,
      "tier": "core",
      "text": "Create a dataset for a recommender-style retail system that combines transactional sales and interaction logs. Include a sales fact table, a product catalog dimension, a customer dimension, and an events log for product impressions and clicks. Product popularity should follow a strong Zipf distribution, where a small fraction of SKUs generate most of the revenue and traffic. Inject several marketing campaigns introducing new products: these cold-start items should receive heavy impression volume initially, with uncertain and noisy conversion rates. Customers should belong to segments with different preference profiles and click-through behaviors, such as bargain hunters, brand loyal customers, and novelty seekers. Include a recommended_product_id in the events log, where recommendations are sometimes noisy or mis-targeted, especially for certain segments. Event timestamps should allow reconstruction of top-N product rankings by day and by category. The dataset should stress joins between logs and dimensions, plus group-by aggregations on customer_id and product_id under heavy skew.",
      "schema": {
        "tables": {
          "sales_order_line": {
            "name": "sales_order_line",
            "kind": "fact",
            "row_count": 30000000,
            "columns": [
              {
                "name": "order_line_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "order_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "order_datetime",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "customer_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_customer.customer_id"
              },
              {
                "name": "product_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_product.product_id"
              },
              {
                "name": "unit_price",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "quantity",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "line_revenue",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "customer_id",
                "ref_table": "dim_customer",
                "ref_column": "customer_id"
              },
              {
                "column": "product_id",
                "ref_table": "dim_product",
                "ref_column": "product_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["unit_price", "quantity"],
                "dependents": ["line_revenue"]
              }
            ]
          },
          "event_log": {
            "name": "event_log",
            "kind": "fact",
            "row_count": 200000000,
            "columns": [
              {
                "name": "event_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "event_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "customer_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_customer.customer_id"
              },
              {
                "name": "product_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_product.product_id"
              },
              {
                "name": "recommended_product_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_product.product_id"
              },
              {
                "name": "event_type",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "campaign_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_campaign.campaign_id"
              }
            ],
            "foreign_keys": [
              {
                "column": "customer_id",
                "ref_table": "dim_customer",
                "ref_column": "customer_id"
              },
              {
                "column": "product_id",
                "ref_table": "dim_product",
                "ref_column": "product_id"
              },
              {
                "column": "recommended_product_id",
                "ref_table": "dim_product",
                "ref_column": "product_id"
              },
              {
                "column": "campaign_id",
                "ref_table": "dim_campaign",
                "ref_column": "campaign_id"
              }
            ]
          },
          "dim_product": {
            "name": "dim_product",
            "kind": "dimension",
            "row_count": 100000,
            "columns": [
              {
                "name": "product_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "sku",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "product_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "category",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "launch_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "is_cold_start",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["sku"],
                "dependents": ["product_id", "product_name", "category"]
              }
            ]
          },
          "dim_customer": {
            "name": "dim_customer",
            "kind": "dimension",
            "row_count": 5000000,
            "columns": [
              {
                "name": "customer_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "segment",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "signup_date",
                "sql_type": "DATE",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_campaign": {
            "name": "dim_campaign",
            "kind": "dimension",
            "row_count": 1000,
            "columns": [
              {
                "name": "campaign_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "campaign_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "start_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "end_date",
                "sql_type": "DATE",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["campaign_name"],
                "dependents": ["campaign_id", "start_date", "end_date"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "sales_order_line",
            "column": "order_line_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 30000000.0
            },
            "provider": null
          },
          {
            "table": "sales_order_line",
            "column": "order_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 10000000
            },
            "provider": null
          },
          {
            "table": "sales_order_line",
            "column": "order_datetime",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "sales_order_line",
            "column": "customer_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 5000000
            },
            "provider": null
          },
          {
            "table": "sales_order_line",
            "column": "product_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.5,
              "n": 100000
            },
            "provider": null
          },
          {
            "table": "sales_order_line",
            "column": "unit_price",
            "distribution": {
              "kind": "lognormal",
              "mean": 3.0,
              "sigma": 1.0
            },
            "provider": null
          },
          {
            "table": "sales_order_line",
            "column": "quantity",
            "distribution": {
              "kind": "poisson",
              "lam": 2.0
            },
            "provider": null
          },
          {
            "table": "sales_order_line",
            "column": "line_revenue",
            "distribution": {
              "kind": "derived",
              "expression": "unit_price * quantity",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "event_log",
            "column": "event_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 200000000.0
            },
            "provider": null
          },
          {
            "table": "event_log",
            "column": "event_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "event_log",
            "column": "customer_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 5000000
            },
            "provider": null
          },
          {
            "table": "event_log",
            "column": "product_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.5,
              "n": 100000
            },
            "provider": null
          },
          {
            "table": "event_log",
            "column": "recommended_product_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.4,
              "n": 100000
            },
            "provider": null
          },
          {
            "table": "event_log",
            "column": "event_type",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["impression", "click", "add_to_cart", "purchase"],
                "probs": [0.7, 0.2, 0.08, 0.02]
              }
            },
            "provider": null
          },
          {
            "table": "event_log",
            "column": "campaign_id",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["null", "1", "2", "3", "4", "5"],
                "probs": [0.8, 0.04, 0.04, 0.04, 0.04, 0.04]
              }
            },
            "provider": null
          },
          {
            "table": "dim_product",
            "column": "product_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 100000.0
            },
            "provider": null
          },
          {
            "table": "dim_product",
            "column": "sku",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["SKU"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_product",
            "column": "product_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Product"],
                "probs": null
              }
            },
            "provider": {
              "name": "faker.commerce.product_name",
              "config": {}
            }
          },
          {
            "table": "dim_product",
            "column": "category",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Electronics", "Clothing", "Books", "Home", "Sports", "Toys"],
                "probs": [0.25, 0.2, 0.15, 0.15, 0.15, 0.1]
              }
            },
            "provider": null
          },
          {
            "table": "dim_product",
            "column": "launch_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "dim_product",
            "column": "is_cold_start",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["true", "false"],
                "probs": [0.1, 0.9]
              }
            },
            "provider": null
          },
          {
            "table": "dim_customer",
            "column": "customer_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000000.0
            },
            "provider": null
          },
          {
            "table": "dim_customer",
            "column": "segment",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["bargain_hunter", "brand_loyal", "novelty_seeker", "regular"],
                "probs": [0.2, 0.25, 0.15, 0.4]
              }
            },
            "provider": null
          },
          {
            "table": "dim_customer",
            "column": "signup_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "dim_campaign",
            "column": "campaign_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000.0
            },
            "provider": null
          },
          {
            "table": "dim_campaign",
            "column": "campaign_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Campaign"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_campaign",
            "column": "start_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "dim_campaign",
            "column": "end_date",
            "distribution": {
              "kind": "derived",
              "expression": "start_date + days(30)",
              "dtype": "date"
            },
            "provider": null
          }
        ],
        "events": [
          {
            "name": "cold_start_campaign_1",
            "start_time": "2024-01-15T00:00:00Z",
            "end_time": "2024-01-22T00:00:00Z",
            "effects": [
              {
                "table": "event_log",
                "column": "product_id",
                "effect_type": "set_value",
                "value": 1001
              },
              {
                "table": "event_log",
                "column": "event_type",
                "effect_type": "set_value",
                "value": "impression"
              }
            ]
          },
          {
            "name": "cold_start_campaign_2",
            "start_time": "2024-02-01T00:00:00Z",
            "end_time": "2024-02-08T00:00:00Z",
            "effects": [
              {
                "table": "event_log",
                "column": "product_id",
                "effect_type": "set_value",
                "value": 1002
              },
              {
                "table": "event_log",
                "column": "event_type",
                "effect_type": "set_value",
                "value": "impression"
              }
            ]
          }
        ]
      }
    },
    {
      "number": 7,
      "tier": "core",
      "text": "Generate a supply chain dataset with multiple interconnected processes. Create fact tables for purchase orders, shipments, inventory snapshots, and customer orders, and dimension tables for products, suppliers, warehouses, and regions. Model multi-stage lead times from supplier to port to central distribution center to regional warehouse to final customer, with variability driven by route, supplier reliability, and season. Inject disruption scenarios: for example, simulate a port closure for a week that causes backlogs and delayed arrivals, and simulate supplier quality issues that result in quarantined inventory and rework orders. Demand should be seasonal for some products and promotion-driven for others, leading to spikes in specific periods. Backorders and stockouts should occur in realistically bursty patterns for popular SKUs. The dataset should stress complex joins between multiple fact tables and cumulative inventory calculations over time.",
      "schema": {
        "tables": {
          "purchase_order": {
            "name": "purchase_order",
            "kind": "fact",
            "row_count": 5000000,
            "columns": [
              {
                "name": "po_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "supplier_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_supplier.supplier_id"
              },
              {
                "name": "product_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_product.product_id"
              },
              {
                "name": "warehouse_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_warehouse.warehouse_id"
              },
              {
                "name": "order_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "expected_arrival_date",
                "sql_type": "DATE",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "ordered_quantity",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "supplier_id",
                "ref_table": "dim_supplier",
                "ref_column": "supplier_id"
              },
              {
                "column": "product_id",
                "ref_table": "dim_product",
                "ref_column": "product_id"
              },
              {
                "column": "warehouse_id",
                "ref_table": "dim_warehouse",
                "ref_column": "warehouse_id"
              }
            ]
          },
          "customer_order": {
            "name": "customer_order",
            "kind": "fact",
            "row_count": 10000000,
            "columns": [
              {
                "name": "order_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "customer_region_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_region.region_id"
              },
              {
                "name": "order_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "customer_region_id",
                "ref_table": "dim_region",
                "ref_column": "region_id"
              }
            ]
          },
          "customer_order_line": {
            "name": "customer_order_line",
            "kind": "fact",
            "row_count": 20000000,
            "columns": [
              {
                "name": "order_line_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "order_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "customer_order.order_id"
              },
              {
                "name": "product_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_product.product_id"
              },
              {
                "name": "ordered_quantity",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "backordered_quantity",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "promotion_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_promotion.promotion_id"
              }
            ],
            "foreign_keys": [
              {
                "column": "order_id",
                "ref_table": "customer_order",
                "ref_column": "order_id"
              },
              {
                "column": "product_id",
                "ref_table": "dim_product",
                "ref_column": "product_id"
              },
              {
                "column": "promotion_id",
                "ref_table": "dim_promotion",
                "ref_column": "promotion_id"
              }
            ]
          },
          "shipment": {
            "name": "shipment",
            "kind": "fact",
            "row_count": 8000000,
            "columns": [
              {
                "name": "shipment_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "po_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "purchase_order.po_id"
              },
              {
                "name": "warehouse_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_warehouse.warehouse_id"
              },
              {
                "name": "shipped_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "arrival_date",
                "sql_type": "DATE",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "po_id",
                "ref_table": "purchase_order",
                "ref_column": "po_id"
              },
              {
                "column": "warehouse_id",
                "ref_table": "dim_warehouse",
                "ref_column": "warehouse_id"
              }
            ]
          },
          "inventory_snapshot": {
            "name": "inventory_snapshot",
            "kind": "fact",
            "row_count": 50000000,
            "columns": [
              {
                "name": "snapshot_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "warehouse_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_warehouse.warehouse_id"
              },
              {
                "name": "product_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_product.product_id"
              },
              {
                "name": "on_hand_quantity",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "backorder_quantity",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "primary_key": [
              "snapshot_date",
              "warehouse_id",
              "product_id"
            ],
            "foreign_keys": [
              {
                "column": "warehouse_id",
                "ref_table": "dim_warehouse",
                "ref_column": "warehouse_id"
              },
              {
                "column": "product_id",
                "ref_table": "dim_product",
                "ref_column": "product_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["snapshot_date", "warehouse_id", "product_id"],
                "dependents": ["on_hand_quantity", "backorder_quantity"]
              }
            ]
          },
          "dim_product": {
            "name": "dim_product",
            "kind": "dimension",
            "row_count": 50000,
            "columns": [
              {
                "name": "product_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "sku",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "product_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "category",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["sku"],
                "dependents": ["product_id", "product_name", "category"]
              }
            ]
          },
          "dim_supplier": {
            "name": "dim_supplier",
            "kind": "dimension",
            "row_count": 5000,
            "columns": [
              {
                "name": "supplier_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "supplier_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "region_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_region.region_id"
              },
              {
                "name": "reliability_score",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "region_id",
                "ref_table": "dim_region",
                "ref_column": "region_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["supplier_name"],
                "dependents": ["supplier_id", "region_id", "reliability_score"]
              }
            ]
          },
          "dim_warehouse": {
            "name": "dim_warehouse",
            "kind": "dimension",
            "row_count": 500,
            "columns": [
              {
                "name": "warehouse_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "warehouse_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "region_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_region.region_id"
              },
              {
                "name": "location_type",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "region_id",
                "ref_table": "dim_region",
                "ref_column": "region_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["warehouse_name"],
                "dependents": ["warehouse_id", "region_id"]
              }
            ]
          },
          "dim_region": {
            "name": "dim_region",
            "kind": "dimension",
            "row_count": 50,
            "columns": [
              {
                "name": "region_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "region_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["region_name"],
                "dependents": ["region_id"]
              }
            ]
          },
          "shipment_stage": {
            "name": "shipment_stage",
            "kind": "fact",
            "row_count": 24000000,
            "columns": [
              {
                "name": "shipment_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "shipment.shipment_id"
              },
              {
                "name": "stage_type",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "stage_location_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_warehouse.warehouse_id"
              },
              {
                "name": "arrival_ts",
                "sql_type": "DATETIME",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "departure_ts",
                "sql_type": "DATETIME",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "primary_key": [
              "shipment_id",
              "stage_type"
            ],
            "foreign_keys": [
              {
                "column": "shipment_id",
                "ref_table": "shipment",
                "ref_column": "shipment_id"
              },
              {
                "column": "stage_location_id",
                "ref_table": "dim_warehouse",
                "ref_column": "warehouse_id"
              }
            ]
          },
          "disruption_event": {
            "name": "disruption_event",
            "kind": "fact",
            "row_count": 100,
            "columns": [
              {
                "name": "disruption_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "disruption_type",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "location_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_warehouse.warehouse_id"
              },
              {
                "name": "start_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "end_date",
                "sql_type": "DATE",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "location_id",
                "ref_table": "dim_warehouse",
                "ref_column": "warehouse_id"
              }
            ]
          },
          "inventory_quality": {
            "name": "inventory_quality",
            "kind": "fact",
            "row_count": 1000000,
            "columns": [
              {
                "name": "quality_issue_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "shipment_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "shipment.shipment_id"
              },
              {
                "name": "product_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_product.product_id"
              },
              {
                "name": "warehouse_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_warehouse.warehouse_id"
              },
              {
                "name": "issue_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "quarantined_quantity",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "rework_required",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "shipment_id",
                "ref_table": "shipment",
                "ref_column": "shipment_id"
              },
              {
                "column": "product_id",
                "ref_table": "dim_product",
                "ref_column": "product_id"
              },
              {
                "column": "warehouse_id",
                "ref_table": "dim_warehouse",
                "ref_column": "warehouse_id"
              }
            ]
          },
          "dim_promotion": {
            "name": "dim_promotion",
            "kind": "dimension",
            "row_count": 500,
            "columns": [
              {
                "name": "promotion_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "promotion_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "start_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "end_date",
                "sql_type": "DATE",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": []
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "purchase_order",
            "column": "po_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000000.0
            },
            "provider": null
          },
          {
            "table": "purchase_order",
            "column": "supplier_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 5000
            },
            "provider": null
          },
          {
            "table": "purchase_order",
            "column": "product_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 50000
            },
            "provider": null
          },
          {
            "table": "purchase_order",
            "column": "warehouse_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 500
            },
            "provider": null
          },
          {
            "table": "purchase_order",
            "column": "order_date",
            "distribution": {
              "kind": "seasonal",
              "granularity": "month",
              "weights": {
                "January": 0.08,
                "February": 0.08,
                "March": 0.08,
                "April": 0.08,
                "May": 0.08,
                "June": 0.08,
                "July": 0.08,
                "August": 0.08,
                "September": 0.08,
                "October": 0.08,
                "November": 0.08,
                "December": 0.08
              }
            },
            "provider": null
          },
          {
            "table": "purchase_order",
            "column": "expected_arrival_date",
            "distribution": {
              "kind": "derived",
              "expression": "order_date + days(uniform(7, 30))",
              "dtype": "date"
            },
            "provider": null
          },
          {
            "table": "purchase_order",
            "column": "ordered_quantity",
            "distribution": {
              "kind": "poisson",
              "lam": 100.0
            },
            "provider": null
          },
          {
            "table": "customer_order",
            "column": "order_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000000.0
            },
            "provider": null
          },
          {
            "table": "customer_order",
            "column": "customer_region_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 50
            },
            "provider": null
          },
          {
            "table": "customer_order",
            "column": "order_date",
            "distribution": {
              "kind": "seasonal",
              "granularity": "month",
              "weights": {
                "January": 0.08,
                "February": 0.08,
                "March": 0.08,
                "April": 0.08,
                "May": 0.08,
                "June": 0.08,
                "July": 0.08,
                "August": 0.08,
                "September": 0.08,
                "October": 0.08,
                "November": 0.12,
                "December": 0.12
              }
            },
            "provider": null
          },
          {
            "table": "customer_order_line",
            "column": "order_line_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 20000000.0
            },
            "provider": null
          },
          {
            "table": "customer_order_line",
            "column": "order_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 10000000
            },
            "provider": null
          },
          {
            "table": "customer_order_line",
            "column": "product_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.4,
              "n": 50000
            },
            "provider": null
          },
          {
            "table": "customer_order_line",
            "column": "ordered_quantity",
            "distribution": {
              "kind": "poisson",
              "lam": 3.0
            },
            "provider": null
          },
          {
            "table": "customer_order_line",
            "column": "backordered_quantity",
            "distribution": {
              "kind": "mixture",
              "components": [
                {
                  "weight": 0.9,
                  "distribution": {
                    "kind": "uniform",
                    "low": 0.0,
                    "high": 0.0
                  }
                },
                {
                  "weight": 0.1,
                  "distribution": {
                    "kind": "poisson",
                    "lam": 5.0
                  }
                }
              ]
            },
            "provider": null
          },
          {
            "table": "customer_order_line",
            "column": "promotion_id",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["null", "1", "2", "3", "4", "5"],
                "probs": [0.7, 0.06, 0.06, 0.06, 0.06, 0.06]
              }
            },
            "provider": null
          },
          {
            "table": "shipment",
            "column": "shipment_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 8000000.0
            },
            "provider": null
          },
          {
            "table": "shipment",
            "column": "po_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 5000000
            },
            "provider": null
          },
          {
            "table": "shipment",
            "column": "warehouse_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 500
            },
            "provider": null
          },
          {
            "table": "shipment",
            "column": "shipped_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "shipment",
            "column": "arrival_date",
            "distribution": {
              "kind": "derived",
              "expression": "shipped_date + days(uniform(5, 20))",
              "dtype": "date"
            },
            "provider": null
          },
          {
            "table": "shipment_stage",
            "column": "shipment_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 8000000
            },
            "provider": null
          },
          {
            "table": "shipment_stage",
            "column": "stage_type",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["supplier", "port", "central_dc", "regional_wh", "customer"],
                "probs": [0.2, 0.2, 0.2, 0.2, 0.2]
              }
            },
            "provider": null
          },
          {
            "table": "shipment_stage",
            "column": "stage_location_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 500
            },
            "provider": null
          },
          {
            "table": "shipment_stage",
            "column": "arrival_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "shipment_stage",
            "column": "departure_ts",
            "distribution": {
              "kind": "derived",
              "expression": "arrival_ts + hours(uniform(2, 48))",
              "dtype": "datetime"
            },
            "provider": null
          },
          {
            "table": "inventory_snapshot",
            "column": "snapshot_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "inventory_snapshot",
            "column": "warehouse_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 500
            },
            "provider": null
          },
          {
            "table": "inventory_snapshot",
            "column": "product_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 50000
            },
            "provider": null
          },
          {
            "table": "inventory_snapshot",
            "column": "on_hand_quantity",
            "distribution": {
              "kind": "poisson",
              "lam": 50.0
            },
            "provider": null
          },
          {
            "table": "inventory_snapshot",
            "column": "backorder_quantity",
            "distribution": {
              "kind": "mixture",
              "components": [
                {
                  "weight": 0.9,
                  "distribution": {
                    "kind": "uniform",
                    "low": 0.0,
                    "high": 0.0
                  }
                },
                {
                  "weight": 0.1,
                  "distribution": {
                    "kind": "poisson",
                    "lam": 10.0
                  }
                }
              ]
            },
            "provider": null
          },
          {
            "table": "disruption_event",
            "column": "disruption_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 100.0
            },
            "provider": null
          },
          {
            "table": "disruption_event",
            "column": "disruption_type",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["port_closure", "supplier_quality", "weather", "customs_delay"],
                "probs": [0.3, 0.3, 0.2, 0.2]
              }
            },
            "provider": null
          },
          {
            "table": "disruption_event",
            "column": "location_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 500
            },
            "provider": null
          },
          {
            "table": "disruption_event",
            "column": "start_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "disruption_event",
            "column": "end_date",
            "distribution": {
              "kind": "derived",
              "expression": "start_date + days(7)",
              "dtype": "date"
            },
            "provider": null
          },
          {
            "table": "inventory_quality",
            "column": "quality_issue_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000000.0
            },
            "provider": null
          },
          {
            "table": "inventory_quality",
            "column": "shipment_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 8000000
            },
            "provider": null
          },
          {
            "table": "inventory_quality",
            "column": "product_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 50000
            },
            "provider": null
          },
          {
            "table": "inventory_quality",
            "column": "warehouse_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 500
            },
            "provider": null
          },
          {
            "table": "inventory_quality",
            "column": "issue_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "inventory_quality",
            "column": "quarantined_quantity",
            "distribution": {
              "kind": "poisson",
              "lam": 20.0
            },
            "provider": null
          },
          {
            "table": "inventory_quality",
            "column": "rework_required",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["true", "false"],
                "probs": [0.3, 0.7]
              }
            },
            "provider": null
          },
          {
            "table": "dim_product",
            "column": "product_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 50000.0
            },
            "provider": null
          },
          {
            "table": "dim_product",
            "column": "sku",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["SKU"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_product",
            "column": "product_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Product"],
                "probs": null
              }
            },
            "provider": {
              "name": "faker.commerce.product_name",
              "config": {}
            }
          },
          {
            "table": "dim_product",
            "column": "category",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Electronics", "Clothing", "Books", "Home", "Sports"],
                "probs": [0.25, 0.2, 0.15, 0.2, 0.2]
              }
            },
            "provider": null
          },
          {
            "table": "dim_supplier",
            "column": "supplier_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000.0
            },
            "provider": null
          },
          {
            "table": "dim_supplier",
            "column": "supplier_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Supplier"],
                "probs": null
              }
            },
            "provider": {
              "name": "faker.company",
              "config": {}
            }
          },
          {
            "table": "dim_supplier",
            "column": "region_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 50
            },
            "provider": null
          },
          {
            "table": "dim_supplier",
            "column": "reliability_score",
            "distribution": {
              "kind": "normal",
              "mean": 0.8,
              "std": 0.15
            },
            "provider": null
          },
          {
            "table": "dim_warehouse",
            "column": "warehouse_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 500.0
            },
            "provider": null
          },
          {
            "table": "dim_warehouse",
            "column": "warehouse_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Warehouse"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_warehouse",
            "column": "region_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 50
            },
            "provider": null
          },
          {
            "table": "dim_warehouse",
            "column": "location_type",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["PORT", "DC", "REGIONAL_WH", "STORE"],
                "probs": [0.1, 0.2, 0.5, 0.2]
              }
            },
            "provider": null
          },
          {
            "table": "dim_region",
            "column": "region_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 50.0
            },
            "provider": null
          },
          {
            "table": "dim_region",
            "column": "region_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Region"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_promotion",
            "column": "promotion_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 500.0
            },
            "provider": null
          },
          {
            "table": "dim_promotion",
            "column": "promotion_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Promotion"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_promotion",
            "column": "start_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "dim_promotion",
            "column": "end_date",
            "distribution": {
              "kind": "derived",
              "expression": "start_date + days(14)",
              "dtype": "date"
            },
            "provider": null
          }
        ],
        "events": [
          {
            "name": "port_closure_week",
            "start_time": "2024-01-15T00:00:00Z",
            "end_time": "2024-01-22T00:00:00Z",
            "effects": [
              {
                "table": "shipment",
                "column": "arrival_date",
                "effect_type": "multiply_distribution",
                "value": 1.5
              },
              {
                "table": "shipment_stage",
                "column": "departure_ts",
                "effect_type": "multiply_distribution",
                "value": 1.5
              }
            ]
          },
          {
            "name": "promotion_spike_black_friday",
            "start_time": "2024-11-25T00:00:00Z",
            "end_time": "2024-11-30T00:00:00Z",
            "effects": [
              {
                "table": "customer_order_line",
                "column": "ordered_quantity",
                "effect_type": "multiply_distribution",
                "value": 2.0
              }
            ]
          },
          {
            "name": "supplier_quality_issue",
            "start_time": "2024-02-10T00:00:00Z",
            "end_time": "2024-02-17T00:00:00Z",
            "effects": [
              {
                "table": "inventory_quality",
                "column": "quarantined_quantity",
                "effect_type": "multiply_distribution",
                "value": 3.0
              }
            ]
          }
        ]
      }
    },
    {
      "number": 8,
      "tier": "core",
      "text": "Create an education platform dataset representing student learning trajectories. There should be an events fact table capturing student–content interactions (view, attempt, correct, incorrect, hint_requested), and dimensions for student, course, content item, and instructor. Students should exhibit different learning profiles: some improve quickly over time, others plateau, and a few regress. Each content item has a difficulty level, and the probability of a correct attempt depends on a latent student skill level, item difficulty, and some noise. Introduce intervention events: when a student has repeated failures on similar items, they receive hints or remedial content, which should measurably improve their future success probability. Time gaps between sessions should correlate with performance, with long idle periods associated with lower accuracy on subsequent attempts. The dataset should support cohort analysis, mastery estimation, and sequence-based queries over time-ordered student activity.",
      "schema": {
        "tables": {
          "learning_event": {
            "name": "learning_event",
            "kind": "fact",
            "row_count": 200000000,
            "columns": [
              {
                "name": "event_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "event_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "student_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_student.student_id"
              },
              {
                "name": "course_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_course.course_id"
              },
              {
                "name": "content_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_content.content_id"
              },
              {
                "name": "event_type",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "is_correct",
                "sql_type": "BOOL",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "is_intervention",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "seconds_since_prev_event",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "student_id",
                "ref_table": "dim_student",
                "ref_column": "student_id"
              },
              {
                "column": "course_id",
                "ref_table": "dim_course",
                "ref_column": "course_id"
              },
              {
                "column": "content_id",
                "ref_table": "dim_content",
                "ref_column": "content_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["student_id", "event_ts"],
                "dependents": ["seconds_since_prev_event"]
              }
            ]
          },
          "dim_student": {
            "name": "dim_student",
            "kind": "dimension",
            "row_count": 1000000,
            "columns": [
              {
                "name": "student_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "cohort_year",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "latent_skill_level",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["student_id"],
                "dependents": ["cohort_year", "latent_skill_level"]
              }
            ]
          },
          "dim_course": {
            "name": "dim_course",
            "kind": "dimension",
            "row_count": 10000,
            "columns": [
              {
                "name": "course_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "course_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "instructor_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_instructor.instructor_id"
              }
            ],
            "foreign_keys": [
              {
                "column": "instructor_id",
                "ref_table": "dim_instructor",
                "ref_column": "instructor_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["course_name"],
                "dependents": ["course_id"]
              }
            ]
          },
          "dim_content": {
            "name": "dim_content",
            "kind": "dimension",
            "row_count": 500000,
            "columns": [
              {
                "name": "content_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "course_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_course.course_id"
              },
              {
                "name": "difficulty_level",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "course_id",
                "ref_table": "dim_course",
                "ref_column": "course_id"
              }
            ]
          },
          "dim_instructor": {
            "name": "dim_instructor",
            "kind": "dimension",
            "row_count": 5000,
            "columns": [
              {
                "name": "instructor_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "instructor_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": []
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "learning_event",
            "column": "event_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 200000000.0
            },
            "provider": null
          },
          {
            "table": "learning_event",
            "column": "event_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "learning_event",
            "column": "student_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 1000000
            },
            "provider": null
          },
          {
            "table": "learning_event",
            "column": "course_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 10000
            },
            "provider": null
          },
          {
            "table": "learning_event",
            "column": "content_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 500000
            },
            "provider": null
          },
          {
            "table": "learning_event",
            "column": "event_type",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["view", "attempt", "correct", "incorrect", "hint_requested"],
                "probs": [0.3, 0.25, 0.2, 0.15, 0.1]
              }
            },
            "provider": null
          },
          {
            "table": "learning_event",
            "column": "is_correct",
            "distribution": {
              "kind": "derived",
              "expression": "where(event_type == \"correct\", \"true\", where(event_type == \"incorrect\", \"false\", null))",
              "dtype": "bool"
            },
            "provider": null
          },
          {
            "table": "learning_event",
            "column": "is_intervention",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["true", "false"],
                "probs": [0.1, 0.9]
              }
            },
            "provider": null
          },
          {
            "table": "learning_event",
            "column": "seconds_since_prev_event",
            "distribution": {
              "kind": "window",
              "expression": "seconds(event_ts - lag(event_ts, 1))",
              "partition_by": ["student_id"],
              "order_by": "event_ts",
              "frame": {
                "type": "ROWS",
                "preceding": "1"
              },
              "dtype": "int"
            },
            "provider": null
          },
          {
            "table": "dim_student",
            "column": "student_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000000.0
            },
            "provider": null
          },
          {
            "table": "dim_student",
            "column": "cohort_year",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["2020", "2021", "2022", "2023", "2024"],
                "probs": [0.1, 0.15, 0.2, 0.25, 0.3]
              }
            },
            "provider": null
          },
          {
            "table": "dim_student",
            "column": "latent_skill_level",
            "distribution": {
              "kind": "normal",
              "mean": 0.5,
              "std": 0.2
            },
            "provider": null
          },
          {
            "table": "dim_course",
            "column": "course_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000.0
            },
            "provider": null
          },
          {
            "table": "dim_course",
            "column": "course_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Course"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_course",
            "column": "instructor_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 5000
            },
            "provider": null
          },
          {
            "table": "dim_content",
            "column": "content_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 500000.0
            },
            "provider": null
          },
          {
            "table": "dim_content",
            "column": "course_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 10000
            },
            "provider": null
          },
          {
            "table": "dim_content",
            "column": "difficulty_level",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["1", "2", "3", "4", "5"],
                "probs": [0.2, 0.25, 0.25, 0.2, 0.1]
              }
            },
            "provider": null
          },
          {
            "table": "dim_instructor",
            "column": "instructor_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000.0
            },
            "provider": null
          },
          {
            "table": "dim_instructor",
            "column": "instructor_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Instructor"],
                "probs": null
              }
            },
            "provider": {
              "name": "faker.name",
              "config": {}
            }
          }
        ],
        "events": [
          {
            "name": "intervention_hint_campaign",
            "start_time": "2024-01-15T00:00:00Z",
            "end_time": "2024-01-22T00:00:00Z",
            "effects": [
              {
                "table": "learning_event",
                "column": "is_intervention",
                "effect_type": "set_value",
                "value": "true"
              },
              {
                "table": "learning_event",
                "column": "event_type",
                "effect_type": "set_value",
                "value": "hint_requested"
              }
            ]
          }
        ]
      }
    },
    {
      "number": 9,
      "tier": "core",
      "text": "Generate a multi-tenant SaaS metrics dataset. Include a metric fact table with fields (tenant_id, metric_name, timestamp, value) and at least 100 million rows, plus dimension tables for tenant, region, and plan. Most tenants should have low traffic and low metric volume, while a few large tenants (\"whales\") generate very high traffic following a Zipf-like distribution across tenant_id. Shared infrastructure issues, such as a database cluster degradation in a particular region, should cause correlated latency spikes and error-rate increases across multiple tenants in that region but not globally. Add tenant-specific incidents, such as misconfigurations or bad deployments, that affect only one tenant's metrics. Metric types should include request_rate, error_rate, latency_p50, latency_p95, cpu_usage, and memory_usage. The dataset should stress multi-tenant group-by aggregations, time-window analytics, and detection of shared versus isolated incidents.",
      "schema": {
        "tables": {
          "metric_timeseries": {
            "name": "metric_timeseries",
            "kind": "fact",
            "row_count": 100000000,
            "columns": [
              {
                "name": "tenant_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_tenant.tenant_id"
              },
              {
                "name": "metric_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "timestamp",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "value",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "primary_key": [
              "tenant_id",
              "metric_name",
              "timestamp"
            ],
            "foreign_keys": [
              {
                "column": "tenant_id",
                "ref_table": "dim_tenant",
                "ref_column": "tenant_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["tenant_id", "metric_name", "timestamp"],
                "dependents": ["value"]
              }
            ]
          },
          "incident": {
            "name": "incident",
            "kind": "fact",
            "row_count": 1000,
            "columns": [
              {
                "name": "incident_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "tenant_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_tenant.tenant_id"
              },
              {
                "name": "region_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_region.region_id"
              },
              {
                "name": "start_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "end_ts",
                "sql_type": "DATETIME",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "incident_type",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "tenant_id",
                "ref_table": "dim_tenant",
                "ref_column": "tenant_id"
              },
              {
                "column": "region_id",
                "ref_table": "dim_region",
                "ref_column": "region_id"
              }
            ]
          },
          "dim_tenant": {
            "name": "dim_tenant",
            "kind": "dimension",
            "row_count": 10000,
            "columns": [
              {
                "name": "tenant_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "tenant_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "plan_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_plan.plan_id"
              },
              {
                "name": "region_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_region.region_id"
              }
            ],
            "foreign_keys": [
              {
                "column": "plan_id",
                "ref_table": "dim_plan",
                "ref_column": "plan_id"
              },
              {
                "column": "region_id",
                "ref_table": "dim_region",
                "ref_column": "region_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["tenant_name"],
                "dependents": ["tenant_id", "plan_id", "region_id"]
              }
            ]
          },
          "dim_region": {
            "name": "dim_region",
            "kind": "dimension",
            "row_count": 20,
            "columns": [
              {
                "name": "region_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "region_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["region_name"],
                "dependents": ["region_id"]
              }
            ]
          },
          "dim_plan": {
            "name": "dim_plan",
            "kind": "dimension",
            "row_count": 20,
            "columns": [
              {
                "name": "plan_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "plan_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["plan_name"],
                "dependents": ["plan_id"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "metric_timeseries",
            "column": "tenant_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.5,
              "n": 10000
            },
            "provider": null
          },
          {
            "table": "metric_timeseries",
            "column": "metric_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["request_rate", "error_rate", "latency_p50", "latency_p95", "cpu_usage", "memory_usage"],
                "probs": [0.2, 0.15, 0.15, 0.15, 0.175, 0.175]
              }
            },
            "provider": null
          },
          {
            "table": "metric_timeseries",
            "column": "timestamp",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "metric_timeseries",
            "column": "value",
            "distribution": {
              "kind": "mixture",
              "components": [
                {
                  "weight": 0.5,
                  "distribution": {
                    "kind": "normal",
                    "mean": 50.0,
                    "std": 10.0
                  },
                  "condition": {
                    "column": "metric_name",
                    "op": "in",
                    "value": ["request_rate", "cpu_usage", "memory_usage"]
                  }
                },
                {
                  "weight": 0.5,
                  "distribution": {
                    "kind": "normal",
                    "mean": 100.0,
                    "std": 20.0
                  },
                  "condition": {
                    "column": "metric_name",
                    "op": "in",
                    "value": ["latency_p50", "latency_p95"]
                  }
                }
              ]
            },
            "provider": null
          },
          {
            "table": "incident",
            "column": "incident_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000.0
            },
            "provider": null
          },
          {
            "table": "incident",
            "column": "tenant_id",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["null", "1", "2", "3"],
                "probs": [0.7, 0.1, 0.1, 0.1]
              }
            },
            "provider": null
          },
          {
            "table": "incident",
            "column": "region_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 20
            },
            "provider": null
          },
          {
            "table": "incident",
            "column": "start_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "incident",
            "column": "end_ts",
            "distribution": {
              "kind": "derived",
              "expression": "start_ts + hours(uniform(1, 6))",
              "dtype": "datetime"
            },
            "provider": null
          },
          {
            "table": "incident",
            "column": "incident_type",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["shared_infrastructure", "tenant_specific", "deployment", "misconfiguration"],
                "probs": [0.3, 0.3, 0.2, 0.2]
              }
            },
            "provider": null
          },
          {
            "table": "dim_tenant",
            "column": "tenant_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000.0
            },
            "provider": null
          },
          {
            "table": "dim_tenant",
            "column": "tenant_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Tenant"],
                "probs": null
              }
            },
            "provider": {
              "name": "faker.company",
              "config": {}
            }
          },
          {
            "table": "dim_tenant",
            "column": "plan_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 20
            },
            "provider": null
          },
          {
            "table": "dim_tenant",
            "column": "region_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 20
            },
            "provider": null
          },
          {
            "table": "dim_region",
            "column": "region_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 20.0
            },
            "provider": null
          },
          {
            "table": "dim_region",
            "column": "region_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["us-east", "us-west", "eu-west", "ap-south", "ap-northeast"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_plan",
            "column": "plan_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 20.0
            },
            "provider": null
          },
          {
            "table": "dim_plan",
            "column": "plan_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["free", "basic", "pro", "enterprise"],
                "probs": null
              }
            },
            "provider": null
          }
        ],
        "events": [
          {
            "name": "database_cluster_degradation_region_1",
            "start_time": "2024-01-15T10:00:00Z",
            "end_time": "2024-01-15T12:00:00Z",
            "effects": [
              {
                "table": "metric_timeseries",
                "column": "value",
                "effect_type": "multiply_distribution",
                "value": 2.0
              },
              {
                "table": "metric_timeseries",
                "column": "metric_name",
                "effect_type": "set_value",
                "value": "latency_p95"
              }
            ]
          },
          {
            "name": "tenant_specific_incident_123",
            "start_time": "2024-01-20T14:00:00Z",
            "end_time": "2024-01-20T16:00:00Z",
            "effects": [
              {
                "table": "metric_timeseries",
                "column": "value",
                "effect_type": "multiply_distribution",
                "value": 3.0
              },
              {
                "table": "metric_timeseries",
                "column": "tenant_id",
                "effect_type": "set_value",
                "value": 123
              }
            ]
          }
        ]
      }
    },
    {
      "number": 10,
      "tier": "core",
      "text": "Create a CRM and marketing attribution dataset that models multi-touch customer journeys. Include a leads or contacts fact table, an interactions fact table capturing marketing touches (email open, email click, ad impression, ad click, website visit, sales call), and dimensions for channel, campaign, creative, and sales representative. Customer journeys should be multi-step sequences that may eventually lead to an opportunity being created and a deal being closed, with widely varying time lags between first touch and closing. Some deals should close after very few touches, while others require long nurture sequences across multiple channels. Different channels should have distinct conversion funnels and latency characteristics. Introduce realistic data quality issues such as multiple leads from the same company, duplicate contacts, and inconsistent campaign codes. The dataset should stress first-touch, last-touch, and multi-touch attribution queries, deduplication logic, and complex joins across events, leads, and opportunities.",
      "schema": {
        "tables": {
          "lead": {
            "name": "lead",
            "kind": "fact",
            "row_count": 5000000,
            "columns": [
              {
                "name": "lead_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "company_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_company.company_id"
              },
              {
                "name": "created_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "status",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "company_id",
                "ref_table": "dim_company",
                "ref_column": "company_id"
              }
            ]
          },
          "interaction": {
            "name": "interaction",
            "kind": "fact",
            "row_count": 50000000,
            "columns": [
              {
                "name": "interaction_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "lead_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "lead.lead_id"
              },
              {
                "name": "interaction_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "channel_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_channel.channel_id"
              },
              {
                "name": "campaign_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_campaign.campaign_id"
              },
              {
                "name": "creative_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_creative.creative_id"
              },
              {
                "name": "sales_rep_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_sales_rep.sales_rep_id"
              },
              {
                "name": "interaction_type",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "lead_id",
                "ref_table": "lead",
                "ref_column": "lead_id"
              },
              {
                "column": "channel_id",
                "ref_table": "dim_channel",
                "ref_column": "channel_id"
              },
              {
                "column": "campaign_id",
                "ref_table": "dim_campaign",
                "ref_column": "campaign_id"
              },
              {
                "column": "creative_id",
                "ref_table": "dim_creative",
                "ref_column": "creative_id"
              },
              {
                "column": "sales_rep_id",
                "ref_table": "dim_sales_rep",
                "ref_column": "sales_rep_id"
              }
            ]
          },
          "opportunity": {
            "name": "opportunity",
            "kind": "fact",
            "row_count": 500000,
            "columns": [
              {
                "name": "opportunity_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "lead_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "lead.lead_id"
              },
              {
                "name": "created_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "closed_ts",
                "sql_type": "DATETIME",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "amount",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "is_closed_won",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "lead_id",
                "ref_table": "lead",
                "ref_column": "lead_id"
              }
            ]
          },
          "dim_channel": {
            "name": "dim_channel",
            "kind": "dimension",
            "row_count": 20,
            "columns": [
              {
                "name": "channel_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "channel_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["channel_name"],
                "dependents": ["channel_id"]
              }
            ]
          },
          "dim_campaign": {
            "name": "dim_campaign",
            "kind": "dimension",
            "row_count": 1000,
            "columns": [
              {
                "name": "campaign_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "campaign_code",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_creative": {
            "name": "dim_creative",
            "kind": "dimension",
            "row_count": 10000,
            "columns": [
              {
                "name": "creative_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "creative_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["creative_name"],
                "dependents": ["creative_id"]
              }
            ]
          },
          "contact": {
            "name": "contact",
            "kind": "fact",
            "row_count": 8000000,
            "columns": [
              {
                "name": "contact_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "lead_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "lead.lead_id"
              },
              {
                "name": "company_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_company.company_id"
              },
              {
                "name": "email",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "is_duplicate",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "lead_id",
                "ref_table": "lead",
                "ref_column": "lead_id"
              },
              {
                "column": "company_id",
                "ref_table": "dim_company",
                "ref_column": "company_id"
              }
            ]
          },
          "dim_company": {
            "name": "dim_company",
            "kind": "dimension",
            "row_count": 500000,
            "columns": [
              {
                "name": "company_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "company_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_sales_rep": {
            "name": "dim_sales_rep",
            "kind": "dimension",
            "row_count": 1000,
            "columns": [
              {
                "name": "sales_rep_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "sales_rep_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["sales_rep_name"],
                "dependents": ["sales_rep_id"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "lead",
            "column": "lead_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000000.0
            },
            "provider": null
          },
          {
            "table": "lead",
            "column": "company_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 500000
            },
            "provider": null
          },
          {
            "table": "lead",
            "column": "created_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "lead",
            "column": "status",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["new", "contacted", "qualified", "nurturing", "converted", "lost"],
                "probs": [0.2, 0.2, 0.15, 0.25, 0.15, 0.05]
              }
            },
            "provider": null
          },
          {
            "table": "interaction",
            "column": "interaction_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 50000000.0
            },
            "provider": null
          },
          {
            "table": "interaction",
            "column": "lead_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 5000000
            },
            "provider": null
          },
          {
            "table": "interaction",
            "column": "interaction_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "interaction",
            "column": "channel_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 20
            },
            "provider": null
          },
          {
            "table": "interaction",
            "column": "campaign_id",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["null", "1", "2", "3", "4", "5"],
                "probs": [0.6, 0.08, 0.08, 0.08, 0.08, 0.08]
              }
            },
            "provider": null
          },
          {
            "table": "interaction",
            "column": "creative_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 10000
            },
            "provider": null
          },
          {
            "table": "interaction",
            "column": "sales_rep_id",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["null", "1", "2", "3", "4", "5"],
                "probs": [0.7, 0.06, 0.06, 0.06, 0.06, 0.06]
              }
            },
            "provider": null
          },
          {
            "table": "interaction",
            "column": "interaction_type",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["email_open", "email_click", "ad_impression", "ad_click", "website_visit", "sales_call"],
                "probs": [0.25, 0.15, 0.2, 0.1, 0.25, 0.05]
              }
            },
            "provider": null
          },
          {
            "table": "opportunity",
            "column": "opportunity_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 500000.0
            },
            "provider": null
          },
          {
            "table": "opportunity",
            "column": "lead_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 5000000
            },
            "provider": null
          },
          {
            "table": "opportunity",
            "column": "created_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "opportunity",
            "column": "closed_ts",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["null", "date"],
                "probs": [0.3, 0.7]
              }
            },
            "provider": null
          },
          {
            "table": "opportunity",
            "column": "amount",
            "distribution": {
              "kind": "lognormal",
              "mean": 4.0,
              "sigma": 1.2
            },
            "provider": null
          },
          {
            "table": "opportunity",
            "column": "is_closed_won",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["true", "false"],
                "probs": [0.4, 0.6]
              }
            },
            "provider": null
          },
          {
            "table": "dim_channel",
            "column": "channel_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 20.0
            },
            "provider": null
          },
          {
            "table": "dim_channel",
            "column": "channel_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["email", "paid_search", "social", "display", "direct", "referral"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_campaign",
            "column": "campaign_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000.0
            },
            "provider": null
          },
          {
            "table": "dim_campaign",
            "column": "campaign_code",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["CAMPAIGN"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_creative",
            "column": "creative_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000.0
            },
            "provider": null
          },
          {
            "table": "dim_creative",
            "column": "creative_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Creative"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "contact",
            "column": "contact_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 8000000.0
            },
            "provider": null
          },
          {
            "table": "contact",
            "column": "lead_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 5000000
            },
            "provider": null
          },
          {
            "table": "contact",
            "column": "company_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 500000
            },
            "provider": null
          },
          {
            "table": "contact",
            "column": "email",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["email"],
                "probs": null
              }
            },
            "provider": {
              "name": "faker.email",
              "config": {}
            }
          },
          {
            "table": "contact",
            "column": "is_duplicate",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["true", "false"],
                "probs": [0.1, 0.9]
              }
            },
            "provider": null
          },
          {
            "table": "dim_company",
            "column": "company_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 500000.0
            },
            "provider": null
          },
          {
            "table": "dim_company",
            "column": "company_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Company"],
                "probs": null
              }
            },
            "provider": {
              "name": "faker.company",
              "config": {}
            }
          },
          {
            "table": "dim_sales_rep",
            "column": "sales_rep_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000.0
            },
            "provider": null
          },
          {
            "table": "dim_sales_rep",
            "column": "sales_rep_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["SalesRep"],
                "probs": null
              }
            },
            "provider": {
              "name": "faker.name",
              "config": {}
            }
          }
        ],
        "events": []
      }
    },
    {
      "number": 11,
      "tier": "extended",
      "text": "Generate a ride-sharing trip dataset for a large metropolitan area that explicitly models multiple derived columns. Include:\n* A trips fact table with at least 50 million rows and dimensions for rider, driver, zone, vehicle, and tariff_plan.\n* For each trip, generate base columns: `start_time`, `pickup_zone_id`, `dropoff_zone_id`, `duration_minutes`, `distance_km`, `base_fare_per_km`, `surge_multiplier`, `booking_fee`, and `driver_payout_ratio`.\n* Define the following derived columns (they must be computed, not sampled):\n* `end_time = start_time + duration_minutes (in minutes)`\n* `distance_miles = distance_km * 0.621371`\n* `gross_fare = distance_km * base_fare_per_km * surge_multiplier + booking_fee`\n* `tax_amount = gross_fare * tax_rate`, where `tax_rate` depends on pickup_zone_id (e.g., downtown 12%, suburbs 8%)\n* `discount_amount = gross_fare * promotional_discount_rate`, where promotional_discount_rate depends on tariff_plan and time of day\n* `net_fare = gross_fare - discount_amount + tax_amount`\n* `driver_earnings = net_fare * driver_payout_ratio`\n* `platform_fee = net_fare - driver_earnings`\n* Use realistic business rules in the distributions so that:\n* Longer trips tend to have higher surge_multiplier in peak hours.\n* Some tariff plans enforce a minimum `gross_fare`, which should be applied via a derived max/clip expression, not by sampling.\n* The dataset should be good for testing that all derived expressions (time arithmetic, chained numeric expressions, conditional clip/min/max logic) are applied correctly on large chunks.",
      "schema": {
        "tables": {
          "trip": {
            "name": "trip",
            "kind": "fact",
            "row_count": 50000000,
            "columns": [
              {
                "name": "trip_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "rider_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_rider.rider_id"
              },
              {
                "name": "driver_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_driver.driver_id"
              },
              {
                "name": "pickup_zone_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_zone.zone_id"
              },
              {
                "name": "dropoff_zone_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_zone.zone_id"
              },
              {
                "name": "vehicle_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_vehicle.vehicle_id"
              },
              {
                "name": "tariff_plan_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_tariff_plan.tariff_plan_id"
              },
              {
                "name": "start_time",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "end_time",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "duration_minutes",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "distance_km",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "distance_miles",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "base_fare_per_km",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "surge_multiplier",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "booking_fee",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "gross_fare",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "tax_rate",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "tax_amount",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "discount_amount",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "net_fare",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "driver_payout_ratio",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "driver_earnings",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "platform_fee",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "rider_id",
                "ref_table": "dim_rider",
                "ref_column": "rider_id"
              },
              {
                "column": "driver_id",
                "ref_table": "dim_driver",
                "ref_column": "driver_id"
              },
              {
                "column": "pickup_zone_id",
                "ref_table": "dim_zone",
                "ref_column": "zone_id"
              },
              {
                "column": "dropoff_zone_id",
                "ref_table": "dim_zone",
                "ref_column": "zone_id"
              },
              {
                "column": "vehicle_id",
                "ref_table": "dim_vehicle",
                "ref_column": "vehicle_id"
              },
              {
                "column": "tariff_plan_id",
                "ref_table": "dim_tariff_plan",
                "ref_column": "tariff_plan_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["start_time", "end_time"],
                "dependents": ["duration_minutes"]
              },
              {
                "determinants": ["distance_km"],
                "dependents": ["distance_miles"]
              },
              {
                "determinants": ["distance_km", "base_fare_per_km", "surge_multiplier"],
                "dependents": ["gross_fare"]
              },
              {
                "determinants": ["gross_fare", "tax_rate"],
                "dependents": ["tax_amount"]
              },
              {
                "determinants": ["gross_fare", "booking_fee", "tax_amount", "discount_amount"],
                "dependents": ["net_fare"]
              },
              {
                "determinants": ["net_fare", "driver_payout_ratio"],
                "dependents": ["driver_earnings"]
              },
              {
                "determinants": ["net_fare", "driver_earnings"],
                "dependents": ["platform_fee"]
              }
            ]
          },
          "dim_rider": {
            "name": "dim_rider",
            "kind": "dimension",
            "row_count": 10000000,
            "columns": [
              {
                "name": "rider_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_driver": {
            "name": "dim_driver",
            "kind": "dimension",
            "row_count": 500000,
            "columns": [
              {
                "name": "driver_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_zone": {
            "name": "dim_zone",
            "kind": "dimension",
            "row_count": 1000,
            "columns": [
              {
                "name": "zone_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "zone_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "base_tax_rate",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["zone_name"],
                "dependents": ["zone_id", "base_tax_rate"]
              }
            ]
          },
          "dim_vehicle": {
            "name": "dim_vehicle",
            "kind": "dimension",
            "row_count": 500000,
            "columns": [
              {
                "name": "vehicle_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "vehicle_type",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["vehicle_type"],
                "dependents": ["vehicle_id"]
              }
            ]
          },
          "dim_tariff_plan": {
            "name": "dim_tariff_plan",
            "kind": "dimension",
            "row_count": 20,
            "columns": [
              {
                "name": "tariff_plan_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "plan_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "promotional_discount_rate",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "minimum_gross_fare",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["plan_name"],
                "dependents": ["tariff_plan_id", "promotional_discount_rate", "minimum_gross_fare"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "trip",
            "column": "trip_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 50000000.0
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "rider_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 10000000
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "driver_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 500000
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "pickup_zone_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 1000
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "dropoff_zone_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 1000
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "vehicle_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 500000
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "tariff_plan_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 20
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "start_time",
            "distribution": {
              "kind": "seasonal",
              "granularity": "hour",
              "weights": {
                "00:00-05:00": 0.3,
                "05:00-07:00": 0.5,
                "07:00-09:00": 1.5,
                "09:00-12:00": 1.0,
                "12:00-14:00": 1.2,
                "14:00-17:00": 1.0,
                "17:00-19:00": 1.5,
                "19:00-21:00": 1.2,
                "21:00-24:00": 0.8
              }
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "end_time",
            "distribution": {
              "kind": "derived",
              "expression": "start_time + minutes(duration_minutes)",
              "dtype": "datetime"
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "duration_minutes",
            "distribution": {
              "kind": "lognormal",
              "mean": 2.5,
              "sigma": 1.0
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "distance_km",
            "distribution": {
              "kind": "lognormal",
              "mean": 2.0,
              "sigma": 1.0
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "distance_miles",
            "distribution": {
              "kind": "derived",
              "expression": "distance_km * 0.621371",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "base_fare_per_km",
            "distribution": {
              "kind": "normal",
              "mean": 1.5,
              "std": 0.3
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "surge_multiplier",
            "distribution": {
              "kind": "mixture",
              "components": [
                {
                  "weight": 0.85,
                  "distribution": {
                    "kind": "uniform",
                    "low": 1.0,
                    "high": 1.5
                  }
                },
                {
                  "weight": 0.15,
                  "distribution": {
                    "kind": "uniform",
                    "low": 1.5,
                    "high": 3.0
                  }
                }
              ]
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "booking_fee",
            "distribution": {
              "kind": "normal",
              "mean": 2.0,
              "std": 0.5
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "gross_fare",
            "distribution": {
              "kind": "derived",
              "expression": "max(distance_km * base_fare_per_km * surge_multiplier + booking_fee, minimum_gross_fare)",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "tax_rate",
            "distribution": {
              "kind": "derived",
              "expression": "base_tax_rate",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "tax_amount",
            "distribution": {
              "kind": "derived",
              "expression": "gross_fare * tax_rate",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "discount_amount",
            "distribution": {
              "kind": "derived",
              "expression": "gross_fare * promotional_discount_rate",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "net_fare",
            "distribution": {
              "kind": "derived",
              "expression": "gross_fare - discount_amount + tax_amount",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "driver_payout_ratio",
            "distribution": {
              "kind": "normal",
              "mean": 0.75,
              "std": 0.05
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "driver_earnings",
            "distribution": {
              "kind": "derived",
              "expression": "net_fare * driver_payout_ratio",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "platform_fee",
            "distribution": {
              "kind": "derived",
              "expression": "net_fare - driver_earnings",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "dim_rider",
            "column": "rider_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000000.0
            },
            "provider": null
          },
          {
            "table": "dim_driver",
            "column": "driver_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 500000.0
            },
            "provider": null
          },
          {
            "table": "dim_zone",
            "column": "zone_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000.0
            },
            "provider": null
          },
          {
            "table": "dim_zone",
            "column": "zone_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Zone"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_zone",
            "column": "base_tax_rate",
            "distribution": {
              "kind": "mixture",
              "components": [
                {
                  "weight": 0.5,
                  "distribution": {
                    "kind": "uniform",
                    "low": 0.08,
                    "high": 0.08
                  },
                  "condition": {
                    "column": "zone_name",
                    "op": "contains",
                    "value": "suburb"
                  }
                },
                {
                  "weight": 0.5,
                  "distribution": {
                    "kind": "uniform",
                    "low": 0.12,
                    "high": 0.12
                  },
                  "condition": {
                    "column": "zone_name",
                    "op": "contains",
                    "value": "downtown"
                  }
                }
              ]
            },
            "provider": null
          },
          {
            "table": "dim_vehicle",
            "column": "vehicle_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 500000.0
            },
            "provider": null
          },
          {
            "table": "dim_vehicle",
            "column": "vehicle_type",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["economy", "comfort", "premium", "luxury"],
                "probs": [0.5, 0.3, 0.15, 0.05]
              }
            },
            "provider": null
          },
          {
            "table": "dim_tariff_plan",
            "column": "tariff_plan_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 20.0
            },
            "provider": null
          },
          {
            "table": "dim_tariff_plan",
            "column": "plan_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["basic", "premium", "enterprise"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_tariff_plan",
            "column": "promotional_discount_rate",
            "distribution": {
              "kind": "normal",
              "mean": 0.1,
              "std": 0.05
            },
            "provider": null
          },
          {
            "table": "dim_tariff_plan",
            "column": "minimum_gross_fare",
            "distribution": {
              "kind": "normal",
              "mean": 5.0,
              "std": 1.0
            },
            "provider": null
          }
        ],
        "events": []
      }
    },
    {
      "number": 12,
      "tier": "core",
      "text": "Create a large-scale e-commerce order dataset that heavily relies on derived monetary and time fields. Include:\n* One orders fact table (≥ 30 million rows) and dimensions for customer, product, store, promotion, and tax_region.\n* Base columns per order line: `order_datetime`, `store_id`, `product_id`, `unit_price`, `quantity`, `discount_percent`, `tax_region_id`, `shipping_method`, `shipping_distance_km`, and `handling_fee`.\n* Define derived columns:\n* `line_subtotal = unit_price * quantity`\n* `discount_amount = line_subtotal * discount_percent`\n* `tax_rate = tax_region_base_rate + additional_rate_for_product_category` (the additional rate depends on the product category, not sampled directly; it should be encoded in the IR and applied as a derived expression that looks up a per-category rate column from the product dimension or a pre-joined view)\n* `tax_amount = (line_subtotal - discount_amount) * tax_rate`\n* `shipping_cost = base_shipping_fee + per_km_rate * shipping_distance_km`, with per_km_rate depending on shipping_method\n* `line_total = line_subtotal - discount_amount + tax_amount + shipping_cost + handling_fee`\n* `estimated_delivery_datetime = order_datetime + shipping_lead_time_days (converted into a timedelta)`\n* `delivery_sla_breached = 1 if actual_delivery_datetime > promised_delivery_datetime else 0` (use a derived boolean expression)\n* Include at least one scenario where tax rules change mid-year (policy change), so tax_rate must be derived from both tax_region_id and order_datetime.\n* This dataset should stress-test chained arithmetic, nested conditionals, date arithmetic, and boolean expressions in derived columns.",
      "schema": {
        "tables": {
          "order_line": {
            "name": "order_line",
            "kind": "fact",
            "row_count": 30000000,
            "columns": [
              {
                "name": "order_line_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "order_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "order_datetime",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "customer_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_customer.customer_id"
              },
              {
                "name": "store_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_store.store_id"
              },
              {
                "name": "product_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_product.product_id"
              },
              {
                "name": "promotion_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_promotion.promotion_id"
              },
              {
                "name": "tax_region_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_tax_region.tax_region_id"
              },
              {
                "name": "unit_price",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "quantity",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "discount_percent",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "shipping_method",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "shipping_distance_km",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "handling_fee",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "line_subtotal",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "discount_amount",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "tax_rate",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "tax_amount",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "shipping_cost",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "line_total",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "estimated_delivery_datetime",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "actual_delivery_datetime",
                "sql_type": "DATETIME",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "promised_delivery_datetime",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "delivery_sla_breached",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "customer_id",
                "ref_table": "dim_customer",
                "ref_column": "customer_id"
              },
              {
                "column": "store_id",
                "ref_table": "dim_store",
                "ref_column": "store_id"
              },
              {
                "column": "product_id",
                "ref_table": "dim_product",
                "ref_column": "product_id"
              },
              {
                "column": "promotion_id",
                "ref_table": "dim_promotion",
                "ref_column": "promotion_id"
              },
              {
                "column": "tax_region_id",
                "ref_table": "dim_tax_region",
                "ref_column": "tax_region_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["unit_price", "quantity"],
                "dependents": ["line_subtotal"]
              },
              {
                "determinants": ["line_subtotal", "discount_percent"],
                "dependents": ["discount_amount"]
              },
              {
                "determinants": ["line_subtotal", "discount_amount", "tax_rate", "shipping_cost", "handling_fee"],
                "dependents": ["line_total"]
              },
              {
                "determinants": ["order_datetime", "shipping_method", "shipping_distance_km"],
                "dependents": ["estimated_delivery_datetime"]
              },
              {
                "determinants": ["actual_delivery_datetime", "promised_delivery_datetime"],
                "dependents": ["delivery_sla_breached"]
              },
              {
                "determinants": ["tax_region_id", "product_id"],
                "dependents": ["tax_rate"]
              }
            ]
          },
          "dim_customer": {
            "name": "dim_customer",
            "kind": "dimension",
            "row_count": 5000000,
            "columns": [
              {
                "name": "customer_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_store": {
            "name": "dim_store",
            "kind": "dimension",
            "row_count": 1000,
            "columns": [
              {
                "name": "store_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_product": {
            "name": "dim_product",
            "kind": "dimension",
            "row_count": 200000,
            "columns": [
              {
                "name": "product_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "category",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "additional_tax_rate",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_promotion": {
            "name": "dim_promotion",
            "kind": "dimension",
            "row_count": 1000,
            "columns": [
              {
                "name": "promotion_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_tax_region": {
            "name": "dim_tax_region",
            "kind": "dimension",
            "row_count": 200,
            "columns": [
              {
                "name": "tax_region_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "tax_region_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "base_tax_rate",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["tax_region_name"],
                "dependents": ["tax_region_id", "base_tax_rate"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "order_line",
            "column": "order_line_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 30000000.0
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "order_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 10000000
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "order_datetime",
            "distribution": {
              "kind": "seasonal",
              "granularity": "month",
              "weights": {
                "January": 0.08,
                "February": 0.08,
                "March": 0.08,
                "April": 0.08,
                "May": 0.08,
                "June": 0.08,
                "July": 0.08,
                "August": 0.08,
                "September": 0.08,
                "October": 0.08,
                "November": 0.12,
                "December": 0.12
              }
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "customer_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 5000000
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "store_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 1000
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "product_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.4,
              "n": 200000
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "promotion_id",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["null", "1", "2", "3", "4", "5"],
                "probs": [0.7, 0.06, 0.06, 0.06, 0.06, 0.06]
              }
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "tax_region_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 200
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "unit_price",
            "distribution": {
              "kind": "lognormal",
              "mean": 3.5,
              "sigma": 1.2
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "quantity",
            "distribution": {
              "kind": "poisson",
              "lam": 2.5
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "discount_percent",
            "distribution": {
              "kind": "mixture",
              "components": [
                {
                  "weight": 0.7,
                  "distribution": {
                    "kind": "uniform",
                    "low": 0.0,
                    "high": 0.0
                  }
                },
                {
                  "weight": 0.3,
                  "distribution": {
                    "kind": "uniform",
                    "low": 0.05,
                    "high": 0.3
                  }
                }
              ]
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "shipping_method",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["standard", "express", "overnight", "ground"],
                "probs": [0.5, 0.25, 0.15, 0.1]
              }
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "shipping_distance_km",
            "distribution": {
              "kind": "lognormal",
              "mean": 3.0,
              "sigma": 1.5
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "handling_fee",
            "distribution": {
              "kind": "normal",
              "mean": 2.0,
              "std": 0.5
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "line_subtotal",
            "distribution": {
              "kind": "derived",
              "expression": "unit_price * quantity",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "discount_amount",
            "distribution": {
              "kind": "derived",
              "expression": "line_subtotal * discount_percent",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "tax_rate",
            "distribution": {
              "kind": "derived",
              "expression": "where(order_datetime >= '2024-07-01', base_tax_rate + additional_tax_rate, base_tax_rate + additional_tax_rate * 0.9)",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "tax_amount",
            "distribution": {
              "kind": "derived",
              "expression": "(line_subtotal - discount_amount) * tax_rate",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "shipping_cost",
            "distribution": {
              "kind": "derived",
              "expression": "where(shipping_method == 'standard', 5.0 + 0.5 * shipping_distance_km, where(shipping_method == 'express', 10.0 + 1.0 * shipping_distance_km, where(shipping_method == 'overnight', 20.0 + 2.0 * shipping_distance_km, 3.0 + 0.3 * shipping_distance_km)))",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "line_total",
            "distribution": {
              "kind": "derived",
              "expression": "line_subtotal - discount_amount + tax_amount + shipping_cost + handling_fee",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "estimated_delivery_datetime",
            "distribution": {
              "kind": "derived",
              "expression": "order_datetime + days(where(shipping_method == 'standard', 5, where(shipping_method == 'express', 2, where(shipping_method == 'overnight', 1, 7))))",
              "dtype": "datetime"
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "actual_delivery_datetime",
            "distribution": {
              "kind": "derived",
              "expression": "estimated_delivery_datetime + days(uniform(-1, 3))",
              "dtype": "datetime"
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "promised_delivery_datetime",
            "distribution": {
              "kind": "derived",
              "expression": "estimated_delivery_datetime",
              "dtype": "datetime"
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "delivery_sla_breached",
            "distribution": {
              "kind": "derived",
              "expression": "where(actual_delivery_datetime > promised_delivery_datetime, \"true\", \"false\")",
              "dtype": "bool"
            },
            "provider": null
          },
          {
            "table": "dim_customer",
            "column": "customer_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000000.0
            },
            "provider": null
          },
          {
            "table": "dim_store",
            "column": "store_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000.0
            },
            "provider": null
          },
          {
            "table": "dim_product",
            "column": "product_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 200000.0
            },
            "provider": null
          },
          {
            "table": "dim_product",
            "column": "category",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Electronics", "Clothing", "Books", "Home", "Sports"],
                "probs": [0.25, 0.2, 0.15, 0.2, 0.2]
              }
            },
            "provider": null
          },
          {
            "table": "dim_product",
            "column": "additional_tax_rate",
            "distribution": {
              "kind": "normal",
              "mean": 0.02,
              "std": 0.01
            },
            "provider": null
          },
          {
            "table": "dim_promotion",
            "column": "promotion_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000.0
            },
            "provider": null
          },
          {
            "table": "dim_tax_region",
            "column": "tax_region_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 200.0
            },
            "provider": null
          },
          {
            "table": "dim_tax_region",
            "column": "tax_region_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Region"],
                "probs": null
              }
            },
            "provider": null
          },
          {
            "table": "dim_tax_region",
            "column": "base_tax_rate",
            "distribution": {
              "kind": "normal",
              "mean": 0.08,
              "std": 0.02
            },
            "provider": null
          }
        ],
        "events": [
          {
            "name": "tax_policy_change",
            "start_time": "2024-07-01T00:00:00Z",
            "end_time": null,
            "effects": [
              {
                "table": "order_line",
                "column": "tax_rate",
                "effect_type": "multiply_distribution",
                "value": 1.1
              }
            ]
          }
        ]
      }
    },
    {
      "number": 13,
      "tier": "extended",
      "text": "Generate an energy consumption dataset for residential customers with multiple temporal derived features. Include:\n* A consumption fact table with hourly records for at least 100,000 households over one full year (≈ 876M rows), and dimensions for household, tariff_plan, and region.\n* Base columns per record: `timestamp`, `household_id`, `region_id`, `tariff_plan_id`, `consumption_kwh`, `outdoor_temp_c`, and `dynamic_price_per_kwh`.\n* Derived columns should include:\n* `billing_day = date part of timestamp`\n* `is_peak_hour = 1 if hour_of_day in peak set else 0`\n* `is_weekend = 1 if day_of_week is Saturday or Sunday else 0`\n* `baseline_price_per_kwh = function of tariff_plan_id` (taken from a dimension table, then propagated via a join and used in a derived expression)\n* `price_multiplier = dynamic_price_per_kwh / baseline_price_per_kwh`\n* `cost_before_rebate = consumption_kwh * dynamic_price_per_kwh`\n* `rebate_amount = where(consumption_kwh > threshold, cost_before_rebate * rebate_rate, 0)` where threshold and rebate_rate depend on tariff_plan_id\n* `final_cost = cost_before_rebate - rebate_amount`\n* `heating_degree_hours = where(outdoor_temp_c < 18, 18 - outdoor_temp_c, 0)`\n* `cooling_degree_hours = where(outdoor_temp_c > 24, outdoor_temp_c - 24, 0)`\n* Make sure the IR specifies these derived columns in terms of core columns, with conditional logic expressed via a where/if-else pattern, so you can verify that your derived engine handles numeric and boolean combinations at large scale.",
      "schema": {
        "tables": {
          "consumption": {
            "name": "consumption",
            "kind": "fact",
            "row_count": 876000000,
            "columns": [
              {
                "name": "timestamp",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "household_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_household.household_id"
              },
              {
                "name": "region_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_region.region_id"
              },
              {
                "name": "tariff_plan_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_tariff_plan.tariff_plan_id"
              },
              {
                "name": "consumption_kwh",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "outdoor_temp_c",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "dynamic_price_per_kwh",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "billing_day",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "is_peak_hour",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "is_weekend",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "baseline_price_per_kwh",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "price_multiplier",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "cost_before_rebate",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "rebate_amount",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "final_cost",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "heating_degree_hours",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "cooling_degree_hours",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "primary_key": [
              "timestamp",
              "household_id"
            ],
            "foreign_keys": [
              {
                "column": "household_id",
                "ref_table": "dim_household",
                "ref_column": "household_id"
              },
              {
                "column": "region_id",
                "ref_table": "dim_region",
                "ref_column": "region_id"
              },
              {
                "column": "tariff_plan_id",
                "ref_table": "dim_tariff_plan",
                "ref_column": "tariff_plan_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["timestamp"],
                "dependents": ["billing_day", "is_peak_hour", "is_weekend"]
              },
              {
                "determinants": ["baseline_price_per_kwh", "price_multiplier"],
                "dependents": ["dynamic_price_per_kwh"]
              },
              {
                "determinants": ["consumption_kwh", "dynamic_price_per_kwh"],
                "dependents": ["cost_before_rebate"]
              },
              {
                "determinants": ["cost_before_rebate", "rebate_amount"],
                "dependents": ["final_cost"]
              },
              {
                "determinants": ["outdoor_temp_c", "region_id"],
                "dependents": ["heating_degree_hours", "cooling_degree_hours"]
              }
            ]
          },
          "dim_household": {
            "name": "dim_household",
            "kind": "dimension",
            "row_count": 100000,
            "columns": [
              {
                "name": "household_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "region_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_region.region_id"
              }
            ],
            "foreign_keys": [
              {
                "column": "region_id",
                "ref_table": "dim_region",
                "ref_column": "region_id"
              }
            ]
          },
          "dim_tariff_plan": {
            "name": "dim_tariff_plan",
            "kind": "dimension",
            "row_count": 50,
            "columns": [
              {
                "name": "tariff_plan_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "baseline_price_per_kwh",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "rebate_threshold_kwh",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "rebate_rate",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_region": {
            "name": "dim_region",
            "kind": "dimension",
            "row_count": 20,
            "columns": [
              {
                "name": "region_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "consumption",
            "column": "timestamp",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "consumption",
            "column": "household_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 100000
            },
            "provider": null
          },
          {
            "table": "consumption",
            "column": "region_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 20
            },
            "provider": null
          },
          {
            "table": "consumption",
            "column": "tariff_plan_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 50
            },
            "provider": null
          },
          {
            "table": "consumption",
            "column": "consumption_kwh",
            "distribution": {
              "kind": "normal",
              "mean": 2.0,
              "std": 0.8
            },
            "provider": null
          },
          {
            "table": "consumption",
            "column": "outdoor_temp_c",
            "distribution": {
              "kind": "seasonal",
              "granularity": "month",
              "weights": {
                "January": 0.5,
                "February": 0.5,
                "March": 0.8,
                "April": 1.0,
                "May": 1.2,
                "June": 1.5,
                "July": 1.8,
                "August": 1.8,
                "September": 1.5,
                "October": 1.2,
                "November": 0.8,
                "December": 0.5
              }
            },
            "provider": null
          },
          {
            "table": "consumption",
            "column": "dynamic_price_per_kwh",
            "distribution": {
              "kind": "derived",
              "expression": "baseline_price_per_kwh * price_multiplier",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "consumption",
            "column": "billing_day",
            "distribution": {
              "kind": "derived",
              "expression": "date(timestamp)",
              "dtype": "date"
            },
            "provider": null
          },
          {
            "table": "consumption",
            "column": "is_peak_hour",
            "distribution": {
              "kind": "derived",
              "expression": "where(hour(timestamp) >= 8 and hour(timestamp) <= 20, \"true\", \"false\")",
              "dtype": "bool"
            },
            "provider": null
          },
          {
            "table": "consumption",
            "column": "is_weekend",
            "distribution": {
              "kind": "derived",
              "expression": "where(day_of_week(timestamp) in (6, 7), \"true\", \"false\")",
              "dtype": "bool"
            },
            "provider": null
          },
          {
            "table": "consumption",
            "column": "baseline_price_per_kwh",
            "distribution": {
              "kind": "derived",
              "expression": "baseline_price_per_kwh",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "consumption",
            "column": "price_multiplier",
            "distribution": {
              "kind": "normal",
              "mean": 1.0,
              "std": 0.2
            },
            "provider": null
          },
          {
            "table": "consumption",
            "column": "cost_before_rebate",
            "distribution": {
              "kind": "derived",
              "expression": "consumption_kwh * dynamic_price_per_kwh",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "consumption",
            "column": "rebate_amount",
            "distribution": {
              "kind": "derived",
              "expression": "where(consumption_kwh > rebate_threshold_kwh, cost_before_rebate * rebate_rate, 0.0)",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "consumption",
            "column": "final_cost",
            "distribution": {
              "kind": "derived",
              "expression": "cost_before_rebate - rebate_amount",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "consumption",
            "column": "heating_degree_hours",
            "distribution": {
              "kind": "derived",
              "expression": "where(outdoor_temp_c < 18, 18 - outdoor_temp_c, 0.0)",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "consumption",
            "column": "cooling_degree_hours",
            "distribution": {
              "kind": "derived",
              "expression": "where(outdoor_temp_c > 24, outdoor_temp_c - 24, 0.0)",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "dim_household",
            "column": "household_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 100000.0
            },
            "provider": null
          },
          {
            "table": "dim_household",
            "column": "region_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 20
            },
            "provider": null
          },
          {
            "table": "dim_tariff_plan",
            "column": "tariff_plan_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 50.0
            },
            "provider": null
          },
          {
            "table": "dim_tariff_plan",
            "column": "baseline_price_per_kwh",
            "distribution": {
              "kind": "normal",
              "mean": 0.12,
              "std": 0.03
            },
            "provider": null
          },
          {
            "table": "dim_tariff_plan",
            "column": "rebate_threshold_kwh",
            "distribution": {
              "kind": "normal",
              "mean": 500.0,
              "std": 100.0
            },
            "provider": null
          },
          {
            "table": "dim_tariff_plan",
            "column": "rebate_rate",
            "distribution": {
              "kind": "normal",
              "mean": 0.1,
              "std": 0.03
            },
            "provider": null
          },
          {
            "table": "dim_region",
            "column": "region_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 20.0
            },
            "provider": null
          }
        ],
        "events": []
      }
    },
    {
      "number": 14,
      "tier": "extended",
      "text": "Create a financial transactions dataset for credit cards with emphasis on fraud-related derived features. Include:\n* A transaction fact table with at least 80 million rows and dimensions for card, merchant, MCC (merchant category code), country, and risk_profile.\n* Base columns per transaction: `transaction_id`, `card_id`, `merchant_id`, `mcc_id`, `transaction_datetime`, `amount_usd`, `exchange_rate`, `country_id`, `card_home_country_id`, `risk_profile_id`, and `is_chip_transaction`.\n* Define the following derived columns:\n* `amount_local_currency = amount_usd * exchange_rate`\n* `is_cross_border = 1 if country_id != card_home_country_id else 0`\n* `days_since_previous_txn = difference in days between transaction_datetime and previous transaction_datetime for the same card_id` (this can be approximated by precomputing per-card lag timestamps and exposing them as a column, then using a derived subtraction expression; the IR should treat the difference as derived, not sampled)\n* `avg_amount_last_7d = rolling average of amount_usd for the last 7 days for the same card_id` (similarly approximated via a pre-stage or via a simplified expression; the NL description should state that it is logically derived, even if your implementation uses a precomputed helper column)\n* `velocity_score = (number_of_transactions_last_24h / 10.0) + (total_amount_last_24h / 1000.0)`\n* `high_risk_mcc_flag = 1 if mcc_id is in a high-risk set else 0`\n* `fraud_risk_score = base_risk_score + 0.5 * is_cross_border + 0.7 * high_risk_mcc_flag + 0.3 * (amount_usd > high_amount_threshold)`\n* This dataset should focus on complex boolean and numeric derived expressions where multiple underlying signals are combined, which is ideal to stress-test your expression engine's handling of multiple operators and nested conditions.",
      "schema": {
        "tables": {
          "credit_card_transaction": {
            "name": "credit_card_transaction",
            "kind": "fact",
            "row_count": 80000000,
            "columns": [
              {
                "name": "transaction_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "card_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_card.card_id"
              },
              {
                "name": "merchant_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_merchant.merchant_id"
              },
              {
                "name": "mcc_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_mcc.mcc_id"
              },
              {
                "name": "transaction_datetime",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "amount_usd",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "exchange_rate",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "country_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_country.country_id"
              },
              {
                "name": "card_home_country_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_country.country_id"
              },
              {
                "name": "risk_profile_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_risk_profile.risk_profile_id"
              },
              {
                "name": "is_chip_transaction",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "amount_local_currency",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "is_cross_border",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "days_since_previous_txn",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "avg_amount_last_7d",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "velocity_score",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "high_risk_mcc_flag",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "fraud_risk_score",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "card_id",
                "ref_table": "dim_card",
                "ref_column": "card_id"
              },
              {
                "column": "merchant_id",
                "ref_table": "dim_merchant",
                "ref_column": "merchant_id"
              },
              {
                "column": "mcc_id",
                "ref_table": "dim_mcc",
                "ref_column": "mcc_id"
              },
              {
                "column": "country_id",
                "ref_table": "dim_country",
                "ref_column": "country_id"
              },
              {
                "column": "card_home_country_id",
                "ref_table": "dim_country",
                "ref_column": "country_id"
              },
              {
                "column": "risk_profile_id",
                "ref_table": "dim_risk_profile",
                "ref_column": "risk_profile_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["amount_usd", "exchange_rate"],
                "dependents": ["amount_local_currency"]
              },
              {
                "determinants": ["country_id", "card_home_country_id"],
                "dependents": ["is_cross_border"]
              },
              {
                "determinants": ["days_since_previous_txn", "avg_amount_last_7d"],
                "dependents": ["velocity_score"]
              },
              {
                "determinants": ["risk_profile_id", "is_cross_border", "high_risk_mcc_flag", "amount_usd"],
                "dependents": ["fraud_risk_score"]
              }
            ]
          },
          "dim_card": {
            "name": "dim_card",
            "kind": "dimension",
            "row_count": 10000000,
            "columns": [
              {
                "name": "card_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_merchant": {
            "name": "dim_merchant",
            "kind": "dimension",
            "row_count": 500000,
            "columns": [
              {
                "name": "merchant_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_mcc": {
            "name": "dim_mcc",
            "kind": "dimension",
            "row_count": 500,
            "columns": [
              {
                "name": "mcc_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_country": {
            "name": "dim_country",
            "kind": "dimension",
            "row_count": 200,
            "columns": [
              {
                "name": "country_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_risk_profile": {
            "name": "dim_risk_profile",
            "kind": "dimension",
            "row_count": 10,
            "columns": [
              {
                "name": "risk_profile_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "base_risk_score",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "high_amount_threshold",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": []
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "credit_card_transaction",
            "column": "transaction_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 80000000.0
            },
            "provider": null
          },
          {
            "table": "credit_card_transaction",
            "column": "card_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 10000000
            },
            "provider": null
          },
          {
            "table": "credit_card_transaction",
            "column": "merchant_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 500000
            },
            "provider": null
          },
          {
            "table": "credit_card_transaction",
            "column": "mcc_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 500
            },
            "provider": null
          },
          {
            "table": "credit_card_transaction",
            "column": "transaction_datetime",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "credit_card_transaction",
            "column": "amount_usd",
            "distribution": {
              "kind": "lognormal",
              "mean": 2.5,
              "sigma": 1.0
            },
            "provider": null
          },
          {
            "table": "credit_card_transaction",
            "column": "exchange_rate",
            "distribution": {
              "kind": "normal",
              "mean": 1.0,
              "std": 0.1
            },
            "provider": null
          },
          {
            "table": "credit_card_transaction",
            "column": "country_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 200
            },
            "provider": null
          },
          {
            "table": "credit_card_transaction",
            "column": "card_home_country_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 200
            },
            "provider": null
          },
          {
            "table": "credit_card_transaction",
            "column": "risk_profile_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 10
            },
            "provider": null
          },
          {
            "table": "credit_card_transaction",
            "column": "is_chip_transaction",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["true", "false"],
                "probs": [0.7, 0.3]
              }
            },
            "provider": null
          },
          {
            "table": "credit_card_transaction",
            "column": "amount_local_currency",
            "distribution": {
              "kind": "derived",
              "expression": "amount_usd * exchange_rate",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "credit_card_transaction",
            "column": "is_cross_border",
            "distribution": {
              "kind": "derived",
              "expression": "where(country_id != card_home_country_id, \"true\", \"false\")",
              "dtype": "bool"
            },
            "provider": null
          },
          {
            "table": "credit_card_transaction",
            "column": "days_since_previous_txn",
            "distribution": {
              "kind": "window",
              "expression": "days(transaction_datetime - lag(transaction_datetime, 1))",
              "partition_by": ["card_id"],
              "order_by": "transaction_datetime",
              "frame": {
                "type": "ROWS",
                "preceding": "1"
              },
              "dtype": "int"
            },
            "provider": null
          },
          {
            "table": "credit_card_transaction",
            "column": "avg_amount_last_7d",
            "distribution": {
              "kind": "window",
              "expression": "avg(amount_usd)",
              "partition_by": ["card_id"],
              "order_by": "transaction_datetime",
              "frame": {
                "type": "RANGE",
                "preceding": "7d"
              },
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "credit_card_transaction",
            "column": "velocity_score",
            "distribution": {
              "kind": "derived",
              "expression": "(count(*) over (partition by card_id order by transaction_datetime range between '24h' preceding and current row) / 10.0) + (sum(amount_usd) over (partition by card_id order by transaction_datetime range between '24h' preceding and current row) / 1000.0)",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "credit_card_transaction",
            "column": "high_risk_mcc_flag",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["true", "false"],
                "probs": [0.1, 0.9]
              }
            },
            "provider": null
          },
          {
            "table": "credit_card_transaction",
            "column": "fraud_risk_score",
            "distribution": {
              "kind": "derived",
              "expression": "base_risk_score + 0.5 * where(is_cross_border == \"true\", 1, 0) + 0.7 * where(high_risk_mcc_flag == \"true\", 1, 0) + 0.3 * where(amount_usd > high_amount_threshold, 1, 0)",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "dim_card",
            "column": "card_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000000.0
            },
            "provider": null
          },
          {
            "table": "dim_merchant",
            "column": "merchant_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 500000.0
            },
            "provider": null
          },
          {
            "table": "dim_mcc",
            "column": "mcc_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 500.0
            },
            "provider": null
          },
          {
            "table": "dim_country",
            "column": "country_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 200.0
            },
            "provider": null
          },
          {
            "table": "dim_risk_profile",
            "column": "risk_profile_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10.0
            },
            "provider": null
          },
          {
            "table": "dim_risk_profile",
            "column": "base_risk_score",
            "distribution": {
              "kind": "normal",
              "mean": 0.3,
              "std": 0.1
            },
            "provider": null
          },
          {
            "table": "dim_risk_profile",
            "column": "high_amount_threshold",
            "distribution": {
              "kind": "lognormal",
              "mean": 4.0,
              "sigma": 1.0
            },
            "provider": null
          }
        ],
        "events": []
      }
    },
    {
      "number": 15,
      "tier": "extended",
      "text": "Generate a SaaS metrics dataset for a multi-tenant web application with heavy use of derived SLAs and aggregates. Include:\n* A metrics fact table with fields `(timestamp, tenant_id, cluster_id, metric_name, value)` and at least 150 million rows, plus dimensions for tenant, cluster, region, and plan_tier.\n* Restrict metric_name to a small set: `request_rate`, `error_rate`, `latency_p50`, `latency_p95`, `cpu_usage`, `memory_usage`.\n* For each (tenant_id, timestamp) combination, create derived \"virtual metrics\" as separate columns:\n* `error_rate_percent = error_rate * 100.0`\n* `latency_spread = latency_p95 - latency_p50`\n* `slo_latency_threshold_ms = function of plan_tier` (brought in via a dimension-based derived expression)\n* `slo_latency_breached = 1 if latency_p95 > slo_latency_threshold_ms else 0`\n* `cpu_headroom = 100.0 - cpu_usage`\n* `is_overloaded = 1 if (cpu_usage > 85 and memory_usage > 80) else 0`\n* Also define a per-tenant derived indicator:\n* `chronic_slo_violator = 1 if fraction_of_intervals_with_slo_latency_breached_over_last_7d > 0.05 else 0`\nwhere `fraction_of_intervals_with_slo_latency_breached_over_last_7d` is conceptually derived from the time series of the same tenant.\n* The IR should contain these derived expressions in terms of base metrics and dimension-driven thresholds, exercising arithmetic, comparison, boolean combination, and function-based derivation.",
      "schema": {
        "tables": {
          "metrics": {
            "name": "metrics",
            "kind": "fact",
            "row_count": 150000000,
            "columns": [
              {
                "name": "timestamp",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "tenant_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_tenant.tenant_id"
              },
              {
                "name": "cluster_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_cluster.cluster_id"
              },
              {
                "name": "metric_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "value",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "error_rate_percent",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "latency_spread",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "slo_latency_threshold_ms",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "slo_latency_breached",
                "sql_type": "BOOL",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "cpu_headroom",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "is_overloaded",
                "sql_type": "BOOL",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "primary_key": [
              "timestamp",
              "tenant_id",
              "cluster_id",
              "metric_name"
            ],
            "foreign_keys": [
              {
                "column": "tenant_id",
                "ref_table": "dim_tenant",
                "ref_column": "tenant_id"
              },
              {
                "column": "cluster_id",
                "ref_table": "dim_cluster",
                "ref_column": "cluster_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["metric_name", "value", "slo_latency_threshold_ms"],
                "dependents": ["slo_latency_breached"]
              },
              {
                "determinants": ["cpu_headroom"],
                "dependents": ["is_overloaded"]
              }
            ]
          },
          "dim_tenant": {
            "name": "dim_tenant",
            "kind": "dimension",
            "row_count": 10000,
            "columns": [
              {
                "name": "tenant_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "plan_tier_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_plan_tier.plan_tier_id"
              },
              {
                "name": "region_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_region.region_id"
              }
            ],
            "foreign_keys": [
              {
                "column": "plan_tier_id",
                "ref_table": "dim_plan_tier",
                "ref_column": "plan_tier_id"
              },
              {
                "column": "region_id",
                "ref_table": "dim_region",
                "ref_column": "region_id"
              }
            ]
          },
          "dim_cluster": {
            "name": "dim_cluster",
            "kind": "dimension",
            "row_count": 1000,
            "columns": [
              {
                "name": "cluster_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_plan_tier": {
            "name": "dim_plan_tier",
            "kind": "dimension",
            "row_count": 10,
            "columns": [
              {
                "name": "plan_tier_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "slo_latency_threshold_ms",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["plan_tier_id"],
                "dependents": ["slo_latency_threshold_ms"]
              }
            ]
          },
          "dim_region": {
            "name": "dim_region",
            "kind": "dimension",
            "row_count": 20,
            "columns": [
              {
                "name": "region_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "metrics",
            "column": "timestamp",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "metrics",
            "column": "tenant_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.5,
              "n": 10000
            },
            "provider": null
          },
          {
            "table": "metrics",
            "column": "cluster_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 1000
            },
            "provider": null
          },
          {
            "table": "metrics",
            "column": "metric_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["request_rate", "error_rate", "latency_p50", "latency_p95", "cpu_usage", "memory_usage"],
                "probs": [0.2, 0.15, 0.15, 0.15, 0.175, 0.175]
              }
            },
            "provider": null
          },
          {
            "table": "metrics",
            "column": "value",
            "distribution": {
              "kind": "mixture",
              "components": [
                {
                  "weight": 0.5,
                  "distribution": {
                    "kind": "normal",
                    "mean": 50.0,
                    "std": 10.0
                  },
                  "condition": {
                    "column": "metric_name",
                    "op": "in",
                    "value": ["request_rate", "cpu_usage", "memory_usage"]
                  }
                },
                {
                  "weight": 0.5,
                  "distribution": {
                    "kind": "normal",
                    "mean": 100.0,
                    "std": 20.0
                  },
                  "condition": {
                    "column": "metric_name",
                    "op": "in",
                    "value": ["latency_p50", "latency_p95"]
                  }
                }
              ]
            },
            "provider": null
          },
          {
            "table": "metrics",
            "column": "error_rate_percent",
            "distribution": {
              "kind": "derived",
              "expression": "where(metric_name == \"error_rate\", value * 100.0, null)",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "metrics",
            "column": "latency_spread",
            "distribution": {
              "kind": "derived",
              "expression": "where(metric_name == \"latency_p95\", value - (select value from metrics m2 where m2.tenant_id = metrics.tenant_id and m2.timestamp = metrics.timestamp and m2.metric_name = \"latency_p50\"), null)",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "metrics",
            "column": "slo_latency_threshold_ms",
            "distribution": {
              "kind": "derived",
              "expression": "slo_latency_threshold_ms",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "metrics",
            "column": "slo_latency_breached",
            "distribution": {
              "kind": "derived",
              "expression": "where(metric_name == \"latency_p95\" and value > slo_latency_threshold_ms, \"true\", \"false\")",
              "dtype": "bool"
            },
            "provider": null
          },
          {
            "table": "metrics",
            "column": "cpu_headroom",
            "distribution": {
              "kind": "derived",
              "expression": "where(metric_name == \"cpu_usage\", 100.0 - value, null)",
              "dtype": "float"
            },
            "provider": null
          },
          {
            "table": "metrics",
            "column": "is_overloaded",
            "distribution": {
              "kind": "derived",
              "expression": "where((select value from metrics m2 where m2.tenant_id = metrics.tenant_id and m2.timestamp = metrics.timestamp and m2.metric_name = \"cpu_usage\") > 85 and (select value from metrics m2 where m2.tenant_id = metrics.tenant_id and m2.timestamp = metrics.timestamp and m2.metric_name = \"memory_usage\") > 80, \"true\", \"false\")",
              "dtype": "bool"
            },
            "provider": null
          },
          {
            "table": "dim_tenant",
            "column": "tenant_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000.0
            },
            "provider": null
          },
          {
            "table": "dim_tenant",
            "column": "plan_tier_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 10
            },
            "provider": null
          },
          {
            "table": "dim_tenant",
            "column": "region_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 20
            },
            "provider": null
          },
          {
            "table": "dim_cluster",
            "column": "cluster_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000.0
            },
            "provider": null
          },
          {
            "table": "dim_plan_tier",
            "column": "plan_tier_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10.0
            },
            "provider": null
          },
          {
            "table": "dim_plan_tier",
            "column": "slo_latency_threshold_ms",
            "distribution": {
              "kind": "normal",
              "mean": 200.0,
              "std": 50.0
            },
            "provider": null
          },
          {
            "table": "dim_region",
            "column": "region_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 20.0
            },
            "provider": null
          }
        ],
        "events": []
      }
    },
    {
      "number": 16,
      "tier": "extended",
      "text": "Generate a ride-sharing trip dataset for a large city where the focus is on **supply–demand imbalance** and **dynamic pricing**. Capture short trips in the city center, long airport trips, and late-night surge windows. Include driver shifts, cancellations (by rider vs driver), and reassignments of trips to different drivers when the original driver cancels. Make sure the schema can support queries like: \"for each 15-minute interval and neighborhood, compute demand, available drivers, and average surge multiplier,\" and \"identify drivers who frequently cancel high-surge trips.\"",
      "schema": {
        "tables": {
          "trip": {
            "name": "trip",
            "kind": "fact",
            "row_count": 50000000,
            "columns": [
              {
                "name": "trip_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "rider_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_rider.rider_id"
              },
              {
                "name": "driver_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_driver.driver_id"
              },
              {
                "name": "requested_driver_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_driver.driver_id"
              },
              {
                "name": "pickup_zone_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_zone.zone_id"
              },
              {
                "name": "dropoff_zone_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_zone.zone_id"
              },
              {
                "name": "request_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "pickup_ts",
                "sql_type": "DATETIME",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "dropoff_ts",
                "sql_type": "DATETIME",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "status",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "surge_multiplier",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "estimated_driver_arrival_minutes",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "interval_15min_start",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "rider_id",
                "ref_table": "dim_rider",
                "ref_column": "rider_id"
              },
              {
                "column": "driver_id",
                "ref_table": "dim_driver",
                "ref_column": "driver_id"
              },
              {
                "column": "requested_driver_id",
                "ref_table": "dim_driver",
                "ref_column": "driver_id"
              },
              {
                "column": "pickup_zone_id",
                "ref_table": "dim_zone",
                "ref_column": "zone_id"
              },
              {
                "column": "dropoff_zone_id",
                "ref_table": "dim_zone",
                "ref_column": "zone_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["request_ts"],
                "dependents": ["interval_15min_start"]
              },
              {
                "determinants": ["request_ts", "pickup_ts"],
                "dependents": ["estimated_driver_arrival_minutes"]
              }
            ]
          },
          "driver_shift": {
            "name": "driver_shift",
            "kind": "fact",
            "row_count": 10000000,
            "columns": [
              {
                "name": "driver_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_driver.driver_id"
              },
              {
                "name": "shift_start_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "shift_end_ts",
                "sql_type": "DATETIME",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "home_zone_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_zone.zone_id"
              }
            ],
            "primary_key": [
              "driver_id",
              "shift_start_ts"
            ],
            "foreign_keys": [
              {
                "column": "driver_id",
                "ref_table": "dim_driver",
                "ref_column": "driver_id"
              },
              {
                "column": "home_zone_id",
                "ref_table": "dim_zone",
                "ref_column": "zone_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["driver_id", "shift_start_ts"],
                "dependents": ["shift_end_ts"]
              }
            ]
          },
          "dim_rider": {
            "name": "dim_rider",
            "kind": "dimension",
            "row_count": 10000000,
            "columns": [
              {
                "name": "rider_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_driver": {
            "name": "dim_driver",
            "kind": "dimension",
            "row_count": 500000,
            "columns": [
              {
                "name": "driver_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_zone": {
            "name": "dim_zone",
            "kind": "dimension",
            "row_count": 1000,
            "columns": [
              {
                "name": "zone_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "zone_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["zone_name"],
                "dependents": ["zone_id"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "trip",
            "column": "trip_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 50000000.0
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "rider_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 10000000
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "driver_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 500000
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "requested_driver_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 500000
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "pickup_zone_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 1000
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "dropoff_zone_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 1000
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "request_ts",
            "distribution": {
              "kind": "seasonal",
              "granularity": "hour",
              "weights": {
                "00:00-05:00": 0.5,
                "05:00-07:00": 0.7,
                "07:00-09:00": 1.5,
                "09:00-12:00": 1.0,
                "12:00-14:00": 1.2,
                "14:00-17:00": 1.0,
                "17:00-19:00": 1.5,
                "19:00-21:00": 1.2,
                "21:00-24:00": 1.0
              }
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "pickup_ts",
            "distribution": {
              "kind": "derived",
              "expression": "request_ts + minutes(uniform(2, 15))",
              "dtype": "datetime"
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "dropoff_ts",
            "distribution": {
              "kind": "derived",
              "expression": "pickup_ts + minutes(uniform(5, 60))",
              "dtype": "datetime"
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "status",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["requested", "assigned", "in_progress", "completed", "cancelled_rider", "cancelled_driver"],
                "probs": [0.05, 0.05, 0.05, 0.8, 0.03, 0.02]
              }
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "surge_multiplier",
            "distribution": {
              "kind": "mixture",
              "components": [
                {
                  "weight": 0.85,
                  "distribution": {
                    "kind": "uniform",
                    "low": 1.0,
                    "high": 1.5
                  }
                },
                {
                  "weight": 0.15,
                  "distribution": {
                    "kind": "uniform",
                    "low": 1.5,
                    "high": 3.0
                  }
                }
              ]
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "estimated_driver_arrival_minutes",
            "distribution": {
              "kind": "derived",
              "expression": "minutes(pickup_ts - request_ts)",
              "dtype": "int"
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "interval_15min_start",
            "distribution": {
              "kind": "derived",
              "expression": "date_trunc('15 minutes', request_ts)",
              "dtype": "datetime"
            },
            "provider": null
          },
          {
            "table": "driver_shift",
            "column": "driver_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 500000
            },
            "provider": null
          },
          {
            "table": "driver_shift",
            "column": "shift_start_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "driver_shift",
            "column": "shift_end_ts",
            "distribution": {
              "kind": "derived",
              "expression": "shift_start_ts + hours(uniform(4, 12))",
              "dtype": "datetime"
            },
            "provider": null
          },
          {
            "table": "driver_shift",
            "column": "home_zone_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 1000
            },
            "provider": null
          },
          {
            "table": "dim_rider",
            "column": "rider_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000000.0
            },
            "provider": null
          },
          {
            "table": "dim_driver",
            "column": "driver_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 500000.0
            },
            "provider": null
          },
          {
            "table": "dim_zone",
            "column": "zone_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000.0
            },
            "provider": null
          },
          {
            "table": "dim_zone",
            "column": "zone_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Zone"],
                "probs": null
              }
            },
            "provider": null
          }
        ],
        "events": [
          {
            "name": "late_night_surge",
            "start_time": "2024-01-15T22:00:00Z",
            "end_time": "2024-01-16T02:00:00Z",
            "effects": [
              {
                "table": "trip",
                "column": "surge_multiplier",
                "effect_type": "multiply_distribution",
                "value": 2.0
              }
            ]
          },
          {
            "name": "airport_surge",
            "start_time": "2024-01-20T06:00:00Z",
            "end_time": "2024-01-20T10:00:00Z",
            "effects": [
              {
                "table": "trip",
                "column": "surge_multiplier",
                "effect_type": "multiply_distribution",
                "value": 1.8
              }
            ]
          }
        ]
      }
    },
    {
      "number": 17,
      "tier": "extended",
      "text": "Create a subscription-billing dataset for a SaaS product with **plan upgrades/downgrades**, **free trials**, and **prorated invoices**. Each customer can have multiple subscriptions over time (e.g., separate products or environments), and each subscription can change plans mid-cycle. Model invoices, line items, discounts, credits, taxes, and payment failures. The schema should make it easy to answer: \"MRR by plan on a given date,\" \"customers who churned within 30 days of an upgrade,\" and \"outstanding unpaid balances segmented by customer segment and region.\"",
      "schema": {
        "tables": {
          "account": {
            "name": "account",
            "kind": "dimension",
            "row_count": 100000,
            "columns": [
              {
                "name": "account_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "plan": {
            "name": "plan",
            "kind": "dimension",
            "row_count": 50,
            "columns": [
              {
                "name": "plan_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "subscription": {
            "name": "subscription",
            "kind": "fact",
            "row_count": 200000,
            "columns": [
              {
                "name": "subscription_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "account_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "account.account_id"
              }
            ],
            "foreign_keys": [
              {
                "column": "account_id",
                "ref_table": "account",
                "ref_column": "account_id"
              }
            ]
          },
          "subscription_plan_history": {
            "name": "subscription_plan_history",
            "kind": "fact",
            "row_count": 400000,
            "columns": [
              {
                "name": "subscription_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "subscription.subscription_id"
              },
              {
                "name": "plan_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "plan.plan_id"
              },
              {
                "name": "effective_from",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "effective_to",
                "sql_type": "DATE",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "primary_key": [
              "subscription_id",
              "effective_from"
            ],
            "foreign_keys": [
              {
                "column": "subscription_id",
                "ref_table": "subscription",
                "ref_column": "subscription_id"
              },
              {
                "column": "plan_id",
                "ref_table": "plan",
                "ref_column": "plan_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["subscription_id", "effective_from"],
                "dependents": ["plan_id", "effective_to"]
              }
            ]
          },
          "invoice": {
            "name": "invoice",
            "kind": "fact",
            "row_count": 500000,
            "columns": [
              {
                "name": "invoice_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "account_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "account.account_id"
              },
              {
                "name": "invoice_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "account_id",
                "ref_table": "account",
                "ref_column": "account_id"
              }
            ]
          },
          "invoice_line_item": {
            "name": "invoice_line_item",
            "kind": "fact",
            "row_count": 1500000,
            "columns": [
              {
                "name": "invoice_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "invoice.invoice_id"
              },
              {
                "name": "line_number",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "subscription_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "subscription.subscription_id"
              },
              {
                "name": "amount",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "primary_key": [
              "invoice_id",
              "line_number"
            ],
            "foreign_keys": [
              {
                "column": "invoice_id",
                "ref_table": "invoice",
                "ref_column": "invoice_id"
              },
              {
                "column": "subscription_id",
                "ref_table": "subscription",
                "ref_column": "subscription_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["invoice_id", "line_number"],
                "dependents": ["subscription_id", "amount"]
              }
            ]
          },
          "payment": {
            "name": "payment",
            "kind": "fact",
            "row_count": 400000,
            "columns": [
              {
                "name": "payment_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "invoice_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "invoice.invoice_id"
              },
              {
                "name": "payment_amount",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "invoice_id",
                "ref_table": "invoice",
                "ref_column": "invoice_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["payment_id"],
                "dependents": ["invoice_id", "payment_amount"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "account",
            "column": "account_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 100000.0
            },
            "provider": null
          },
          {
            "table": "plan",
            "column": "plan_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 50.0
            },
            "provider": null
          },
          {
            "table": "subscription",
            "column": "subscription_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 200000.0
            },
            "provider": null
          },
          {
            "table": "subscription",
            "column": "account_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 100000
            },
            "provider": null
          },
          {
            "table": "subscription_plan_history",
            "column": "subscription_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 200000
            },
            "provider": null
          },
          {
            "table": "subscription_plan_history",
            "column": "plan_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 50
            },
            "provider": null
          },
          {
            "table": "subscription_plan_history",
            "column": "effective_from",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "subscription_plan_history",
            "column": "effective_to",
            "distribution": {
              "kind": "window",
              "expression": "lead(effective_from, 1)",
              "partition_by": ["subscription_id"],
              "order_by": "effective_from",
              "frame": {
                "type": "ROWS",
                "following": "1"
              },
              "dtype": "date"
            },
            "provider": null
          },
          {
            "table": "invoice",
            "column": "invoice_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 500000.0
            },
            "provider": null
          },
          {
            "table": "invoice",
            "column": "account_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 100000
            },
            "provider": null
          },
          {
            "table": "invoice",
            "column": "invoice_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "invoice_line_item",
            "column": "invoice_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 500000
            },
            "provider": null
          },
          {
            "table": "invoice_line_item",
            "column": "line_number",
            "distribution": {
              "kind": "poisson",
              "lam": 2.0
            },
            "provider": null
          },
          {
            "table": "invoice_line_item",
            "column": "subscription_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 200000
            },
            "provider": null
          },
          {
            "table": "invoice_line_item",
            "column": "amount",
            "distribution": {
              "kind": "lognormal",
              "mean": 4.0,
              "sigma": 1.0
            },
            "provider": null
          },
          {
            "table": "payment",
            "column": "payment_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 400000.0
            },
            "provider": null
          },
          {
            "table": "payment",
            "column": "invoice_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 500000
            },
            "provider": null
          },
          {
            "table": "payment",
            "column": "payment_amount",
            "distribution": {
              "kind": "lognormal",
              "mean": 4.0,
              "sigma": 1.0
            },
            "provider": null
          }
        ],
        "events": []
      }
    },
    {
      "number": 18,
      "tier": "extended",
      "text": "Design an e-commerce **returns and refunds** dataset that explicitly models the lifecycle of a return: request created, item received at warehouse, inspection result, refund issued, and restock or discard decision.\nInclude:\n* Orders, order items, customers, and products (with categories and attributes like size/color).\n* Return requests with reasons (too small, defective, changed mind, etc.).\n* Inspection outcomes (approved, partial approved, rejected) and associated notes.\n* Refunds that may be **partial** (e.g., only one item from a multi-item order) or **split across payment methods** (gift card + card).\nThe schema should support queries like \"return rate by size per product over time\" and \"fraction of returns tagged as defective by supplier.\"",
      "schema": {
        "tables": {
          "order": {
            "name": "order",
            "kind": "fact",
            "row_count": 5000000,
            "columns": [
              {
                "name": "order_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "customer_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_customer.customer_id"
              },
              {
                "name": "order_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "customer_id",
                "ref_table": "dim_customer",
                "ref_column": "customer_id"
              }
            ]
          },
          "order_item": {
            "name": "order_item",
            "kind": "fact",
            "row_count": 15000000,
            "columns": [
              {
                "name": "order_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "order.order_id"
              },
              {
                "name": "order_item_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "product_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_product.product_id"
              },
              {
                "name": "size",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "primary_key": [
              "order_id",
              "order_item_id"
            ],
            "foreign_keys": [
              {
                "column": "order_id",
                "ref_table": "order",
                "ref_column": "order_id"
              },
              {
                "column": "product_id",
                "ref_table": "dim_product",
                "ref_column": "product_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["order_id", "order_item_id"],
                "dependents": ["product_id", "size"]
              }
            ]
          },
          "return_request": {
            "name": "return_request",
            "kind": "fact",
            "row_count": 1000000,
            "columns": [
              {
                "name": "return_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "order_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "order.order_id"
              },
              {
                "name": "order_item_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "reason_code",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "order_id",
                "ref_table": "order",
                "ref_column": "order_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["order_id", "order_item_id"],
                "dependents": ["return_id", "reason_code"]
              }
            ]
          },
          "inspection": {
            "name": "inspection",
            "kind": "fact",
            "row_count": 1000000,
            "columns": [
              {
                "name": "return_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "return_request.return_id"
              },
              {
                "name": "inspection_result",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "primary_key": [
              "return_id"
            ],
            "foreign_keys": [
              {
                "column": "return_id",
                "ref_table": "return_request",
                "ref_column": "return_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["return_id"],
                "dependents": ["inspection_result"]
              }
            ]
          },
          "refund": {
            "name": "refund",
            "kind": "fact",
            "row_count": 1000000,
            "columns": [
              {
                "name": "refund_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "return_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "return_request.return_id"
              },
              {
                "name": "payment_method",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "refund_amount",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "return_id",
                "ref_table": "return_request",
                "ref_column": "return_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["return_id"],
                "dependents": ["payment_method", "refund_amount"]
              }
            ]
          },
          "dim_customer": {
            "name": "dim_customer",
            "kind": "dimension",
            "row_count": 5000000,
            "columns": [
              {
                "name": "customer_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_product": {
            "name": "dim_product",
            "kind": "dimension",
            "row_count": 200000,
            "columns": [
              {
                "name": "product_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "order",
            "column": "order_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000000.0
            },
            "provider": null
          },
          {
            "table": "order",
            "column": "customer_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 5000000
            },
            "provider": null
          },
          {
            "table": "order",
            "column": "order_date",
            "distribution": {
              "kind": "seasonal",
              "granularity": "month",
              "weights": {
                "January": 0.08,
                "February": 0.08,
                "March": 0.08,
                "April": 0.08,
                "May": 0.08,
                "June": 0.08,
                "July": 0.08,
                "August": 0.08,
                "September": 0.08,
                "October": 0.08,
                "November": 0.12,
                "December": 0.12
              }
            },
            "provider": null
          },
          {
            "table": "order_item",
            "column": "order_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 5000000
            },
            "provider": null
          },
          {
            "table": "order_item",
            "column": "order_item_id",
            "distribution": {
              "kind": "poisson",
              "lam": 3.0
            },
            "provider": null
          },
          {
            "table": "order_item",
            "column": "product_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.4,
              "n": 200000
            },
            "provider": null
          },
          {
            "table": "order_item",
            "column": "size",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["XS", "S", "M", "L", "XL", "XXL"],
                "probs": [0.05, 0.15, 0.25, 0.25, 0.2, 0.1]
              }
            },
            "provider": null
          },
          {
            "table": "return_request",
            "column": "return_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000000.0
            },
            "provider": null
          },
          {
            "table": "return_request",
            "column": "order_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 5000000
            },
            "provider": null
          },
          {
            "table": "return_request",
            "column": "order_item_id",
            "distribution": {
              "kind": "poisson",
              "lam": 1.5
            },
            "provider": null
          },
          {
            "table": "return_request",
            "column": "reason_code",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["too_small", "too_large", "defective", "changed_mind", "wrong_item", "damaged"],
                "probs": [0.2, 0.15, 0.2, 0.25, 0.1, 0.1]
              }
            },
            "provider": null
          },
          {
            "table": "inspection",
            "column": "return_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.0,
              "n": 1000000
            },
            "provider": null
          },
          {
            "table": "inspection",
            "column": "inspection_result",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["approved", "partial_approved", "rejected"],
                "probs": [0.6, 0.2, 0.2]
              }
            },
            "provider": null
          },
          {
            "table": "refund",
            "column": "refund_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000000.0
            },
            "provider": null
          },
          {
            "table": "refund",
            "column": "return_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.0,
              "n": 1000000
            },
            "provider": null
          },
          {
            "table": "refund",
            "column": "payment_method",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["credit_card", "gift_card", "store_credit", "original_payment"],
                "probs": [0.5, 0.2, 0.15, 0.15]
              }
            },
            "provider": null
          },
          {
            "table": "refund",
            "column": "refund_amount",
            "distribution": {
              "kind": "lognormal",
              "mean": 3.5,
              "sigma": 1.0
            },
            "provider": null
          },
          {
            "table": "dim_customer",
            "column": "customer_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000000.0
            },
            "provider": null
          },
          {
            "table": "dim_product",
            "column": "product_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 200000.0
            },
            "provider": null
          }
        ],
        "events": []
      }
    },
    {
      "number": 19,
      "tier": "extended",
      "text": "Create a logistics and shipment dataset for a retailer that ships from **multiple warehouses** and supports **split shipments** for a single order.\nModel:\n* Orders and order items.\n* Shipments (each shipment can contain items from multiple orders; each order can produce multiple shipments).\n* Tracking events (picked, packed, handed to carrier, in-transit, out-for-delivery, delivered, failed-delivery, returned-to-sender).\n* Carrier-specific SLAs and promised delivery dates.\nData should allow queries like \"average delivery delay by carrier and region,\" \"orders where at least one shipment is lost,\" and \"items that frequently miss SLA when shipped from a specific warehouse.\"",
      "schema": {
        "tables": {
          "order": {
            "name": "order",
            "kind": "fact",
            "row_count": 3000000,
            "columns": [
              {
                "name": "order_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "order_item": {
            "name": "order_item",
            "kind": "fact",
            "row_count": 9000000,
            "columns": [
              {
                "name": "order_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "order.order_id"
              },
              {
                "name": "order_item_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "primary_key": [
              "order_id",
              "order_item_id"
            ],
            "foreign_keys": [
              {
                "column": "order_id",
                "ref_table": "order",
                "ref_column": "order_id"
              }
            ]
          },
          "shipment": {
            "name": "shipment",
            "kind": "fact",
            "row_count": 5000000,
            "columns": [
              {
                "name": "shipment_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "carrier_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_carrier.carrier_id"
              },
              {
                "name": "warehouse_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "dim_warehouse.warehouse_id"
              },
              {
                "name": "promised_delivery_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "carrier_id",
                "ref_table": "dim_carrier",
                "ref_column": "carrier_id"
              },
              {
                "column": "warehouse_id",
                "ref_table": "dim_warehouse",
                "ref_column": "warehouse_id"
              }
            ]
          },
          "shipment_item": {
            "name": "shipment_item",
            "kind": "fact",
            "row_count": 15000000,
            "columns": [
              {
                "name": "shipment_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "shipment.shipment_id"
              },
              {
                "name": "order_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "order.order_id"
              },
              {
                "name": "order_item_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "primary_key": [
              "shipment_id",
              "order_id",
              "order_item_id"
            ],
            "foreign_keys": [
              {
                "column": "shipment_id",
                "ref_table": "shipment",
                "ref_column": "shipment_id"
              },
              {
                "column": "order_id",
                "ref_table": "order",
                "ref_column": "order_id"
              }
            ]
          },
          "tracking_event": {
            "name": "tracking_event",
            "kind": "fact",
            "row_count": 30000000,
            "columns": [
              {
                "name": "shipment_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "shipment.shipment_id"
              },
              {
                "name": "event_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "event_type",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "primary_key": [
              "shipment_id",
              "event_ts"
            ],
            "foreign_keys": [
              {
                "column": "shipment_id",
                "ref_table": "shipment",
                "ref_column": "shipment_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["shipment_id", "event_ts"],
                "dependents": ["event_type"]
              }
            ]
          },
          "dim_carrier": {
            "name": "dim_carrier",
            "kind": "dimension",
            "row_count": 50,
            "columns": [
              {
                "name": "carrier_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "dim_warehouse": {
            "name": "dim_warehouse",
            "kind": "dimension",
            "row_count": 200,
            "columns": [
              {
                "name": "warehouse_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "order",
            "column": "order_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 3000000.0
            },
            "provider": null
          },
          {
            "table": "order_item",
            "column": "order_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 3000000
            },
            "provider": null
          },
          {
            "table": "order_item",
            "column": "order_item_id",
            "distribution": {
              "kind": "poisson",
              "lam": 3.0
            },
            "provider": null
          },
          {
            "table": "shipment",
            "column": "shipment_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000000.0
            },
            "provider": null
          },
          {
            "table": "shipment",
            "column": "carrier_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 50
            },
            "provider": null
          },
          {
            "table": "shipment",
            "column": "warehouse_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 200
            },
            "provider": null
          },
          {
            "table": "shipment",
            "column": "promised_delivery_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "shipment_item",
            "column": "shipment_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 5000000
            },
            "provider": null
          },
          {
            "table": "shipment_item",
            "column": "order_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 3000000
            },
            "provider": null
          },
          {
            "table": "shipment_item",
            "column": "order_item_id",
            "distribution": {
              "kind": "poisson",
              "lam": 1.5
            },
            "provider": null
          },
          {
            "table": "tracking_event",
            "column": "shipment_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 5000000
            },
            "provider": null
          },
          {
            "table": "tracking_event",
            "column": "event_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "tracking_event",
            "column": "event_type",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["picked", "packed", "handed_to_carrier", "in_transit", "out_for_delivery", "delivered", "failed_delivery", "returned_to_sender"],
                "probs": [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.05, 0.05]
              }
            },
            "provider": null
          },
          {
            "table": "dim_carrier",
            "column": "carrier_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 50.0
            },
            "provider": null
          },
          {
            "table": "dim_warehouse",
            "column": "warehouse_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 200.0
            },
            "provider": null
          }
        ],
        "events": []
      }
    },
    {
      "number": 20,
      "tier": "core",
      "text": "Generate an HR / workforce dataset for a global company with **hierarchical org structure**, **job changes**, and **compensation history**.\nInclude:\n* Employees, departments, and a manager–subordinate hierarchy (supporting multiple reorgs over time).\n* Position history: promotions, lateral moves, and demotions with effective dates.\n* Compensation history: base salary, bonus target, stock grants, with region-specific currencies.\nThe schema should enable queries like \"org chart as of a given date,\" \"gender pay gap by level and region,\" and \"average time-to-promotion by department.\"",
      "schema": {
        "tables": {
          "employee": {
            "name": "employee",
            "kind": "dimension",
            "row_count": 100000,
            "columns": [
              {
                "name": "employee_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "department_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "department.department_id"
              },
              {
                "name": "manager_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "employee.employee_id"
              }
            ],
            "foreign_keys": [
              {
                "column": "department_id",
                "ref_table": "department",
                "ref_column": "department_id"
              },
              {
                "column": "manager_id",
                "ref_table": "employee",
                "ref_column": "employee_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["employee_id"],
                "dependents": ["department_id", "manager_id"]
              }
            ]
          },
          "department": {
            "name": "department",
            "kind": "dimension",
            "row_count": 1000,
            "columns": [
              {
                "name": "department_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "position_history": {
            "name": "position_history",
            "kind": "fact",
            "row_count": 300000,
            "columns": [
              {
                "name": "employee_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "employee.employee_id"
              },
              {
                "name": "position_title",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "effective_from",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "effective_to",
                "sql_type": "DATE",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "primary_key": [
              "employee_id",
              "effective_from"
            ],
            "foreign_keys": [
              {
                "column": "employee_id",
                "ref_table": "employee",
                "ref_column": "employee_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["employee_id", "effective_from"],
                "dependents": ["position_title", "effective_to"]
              }
            ]
          },
          "compensation_history": {
            "name": "compensation_history",
            "kind": "fact",
            "row_count": 400000,
            "columns": [
              {
                "name": "employee_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "employee.employee_id"
              },
              {
                "name": "effective_from",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "base_salary",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "bonus_target",
                "sql_type": "FLOAT",
                "nullable": true,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "primary_key": [
              "employee_id",
              "effective_from"
            ],
            "foreign_keys": [
              {
                "column": "employee_id",
                "ref_table": "employee",
                "ref_column": "employee_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["employee_id", "effective_from"],
                "dependents": ["base_salary", "bonus_target"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "employee",
            "column": "employee_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 100000.0
            },
            "provider": null
          },
          {
            "table": "employee",
            "column": "department_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 1000
            },
            "provider": null
          },
          {
            "table": "employee",
            "column": "manager_id",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["null", "1", "2", "3", "4", "5"],
                "probs": [0.1, 0.18, 0.18, 0.18, 0.18, 0.18]
              }
            },
            "provider": null
          },
          {
            "table": "department",
            "column": "department_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000.0
            },
            "provider": null
          },
          {
            "table": "position_history",
            "column": "employee_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 100000
            },
            "provider": null
          },
          {
            "table": "position_history",
            "column": "position_title",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Engineer", "Manager", "Director", "VP", "CEO"],
                "probs": [0.5, 0.25, 0.15, 0.08, 0.02]
              }
            },
            "provider": null
          },
          {
            "table": "position_history",
            "column": "effective_from",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "position_history",
            "column": "effective_to",
            "distribution": {
              "kind": "window",
              "expression": "lead(effective_from, 1)",
              "partition_by": ["employee_id"],
              "order_by": "effective_from",
              "frame": {
                "type": "ROWS",
                "following": "1"
              },
              "dtype": "date"
            },
            "provider": null
          },
          {
            "table": "compensation_history",
            "column": "employee_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 100000
            },
            "provider": null
          },
          {
            "table": "compensation_history",
            "column": "effective_from",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "compensation_history",
            "column": "base_salary",
            "distribution": {
              "kind": "lognormal",
              "mean": 4.5,
              "sigma": 0.8
            },
            "provider": null
          },
          {
            "table": "compensation_history",
            "column": "bonus_target",
            "distribution": {
              "kind": "lognormal",
              "mean": 3.5,
              "sigma": 0.8
            },
            "provider": null
          }
        ],
        "events": []
      }
    },
    {
      "number": 21,
      "tier": "extended",
      "text": "Create a digital-marketing attribution dataset where users can interact across **multiple channels and devices** before conversion.\nRequirements:\n* User identities with a device graph (cookies, mobile device IDs, login IDs) that can be merged over time.\n* Touchpoints: impressions, clicks, email opens, push notifications, and direct visits, each with campaign, channel, and timestamp.\n* Conversions (e.g., purchases or sign-ups) with revenue and product/category tags.\nThe schema should make it possible to implement different attribution models (first-touch, last-touch, position-based, data-driven) and answer questions like \"top campaigns by incremental revenue last 30 days.\"",
      "schema": {
        "tables": {
          "user_identity": {
            "name": "user_identity",
            "kind": "dimension",
            "row_count": 10000000,
            "columns": [
              {
                "name": "user_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "device": {
            "name": "device",
            "kind": "dimension",
            "row_count": 20000000,
            "columns": [
              {
                "name": "device_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "user_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "user_identity.user_id"
              }
            ],
            "foreign_keys": [
              {
                "column": "user_id",
                "ref_table": "user_identity",
                "ref_column": "user_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["device_id"],
                "dependents": ["user_id"]
              }
            ]
          },
          "campaign": {
            "name": "campaign",
            "kind": "dimension",
            "row_count": 5000,
            "columns": [
              {
                "name": "campaign_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "channel": {
            "name": "channel",
            "kind": "dimension",
            "row_count": 10,
            "columns": [
              {
                "name": "channel_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "touchpoint": {
            "name": "touchpoint",
            "kind": "fact",
            "row_count": 100000000,
            "columns": [
              {
                "name": "touchpoint_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "user_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "user_identity.user_id"
              },
              {
                "name": "device_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "device.device_id"
              },
              {
                "name": "campaign_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "campaign.campaign_id"
              },
              {
                "name": "channel_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "channel.channel_id"
              },
              {
                "name": "touch_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "user_id",
                "ref_table": "user_identity",
                "ref_column": "user_id"
              },
              {
                "column": "device_id",
                "ref_table": "device",
                "ref_column": "device_id"
              },
              {
                "column": "campaign_id",
                "ref_table": "campaign",
                "ref_column": "campaign_id"
              },
              {
                "column": "channel_id",
                "ref_table": "channel",
                "ref_column": "channel_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["touchpoint_id"],
                "dependents": ["user_id", "device_id", "campaign_id", "channel_id", "touch_ts"]
              }
            ]
          },
          "conversion": {
            "name": "conversion",
            "kind": "fact",
            "row_count": 5000000,
            "columns": [
              {
                "name": "conversion_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "user_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "user_identity.user_id"
              },
              {
                "name": "conversion_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "revenue",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "product_category",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "user_id",
                "ref_table": "user_identity",
                "ref_column": "user_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["conversion_id"],
                "dependents": ["user_id", "conversion_ts", "revenue", "product_category"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "user_identity",
            "column": "user_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000000.0
            },
            "provider": null
          },
          {
            "table": "device",
            "column": "device_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 20000000.0
            },
            "provider": null
          },
          {
            "table": "device",
            "column": "user_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 10000000
            },
            "provider": null
          },
          {
            "table": "campaign",
            "column": "campaign_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000.0
            },
            "provider": null
          },
          {
            "table": "channel",
            "column": "channel_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10.0
            },
            "provider": null
          },
          {
            "table": "touchpoint",
            "column": "touchpoint_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 100000000.0
            },
            "provider": null
          },
          {
            "table": "touchpoint",
            "column": "user_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 10000000
            },
            "provider": null
          },
          {
            "table": "touchpoint",
            "column": "device_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 20000000
            },
            "provider": null
          },
          {
            "table": "touchpoint",
            "column": "campaign_id",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["null", "1", "2", "3", "4", "5"],
                "probs": [0.6, 0.08, 0.08, 0.08, 0.08, 0.08]
              }
            },
            "provider": null
          },
          {
            "table": "touchpoint",
            "column": "channel_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 10
            },
            "provider": null
          },
          {
            "table": "touchpoint",
            "column": "touch_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "conversion",
            "column": "conversion_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000000.0
            },
            "provider": null
          },
          {
            "table": "conversion",
            "column": "user_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 10000000
            },
            "provider": null
          },
          {
            "table": "conversion",
            "column": "conversion_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "conversion",
            "column": "revenue",
            "distribution": {
              "kind": "lognormal",
              "mean": 3.5,
              "sigma": 1.2
            },
            "provider": null
          },
          {
            "table": "conversion",
            "column": "product_category",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Electronics", "Clothing", "Books", "Home", "Sports"],
                "probs": [0.25, 0.2, 0.15, 0.2, 0.2]
              }
            },
            "provider": null
          }
        ],
        "events": []
      }
    },
    {
      "number": 22,
      "tier": "extended",
      "text": "Design an **event-driven monitoring** dataset for a cloud service that tracks **incidents, alerts, and deployments**.\nModel:\n* Services, clusters, and environments (prod, staging, etc.).\n* Time-series metrics summarized into intervals (CPU, memory, error rate, latency).\n* Incidents with start/end timestamps, severity, and impacted services.\n* Alerts fired from different detection rules (threshold-based, anomaly-based) and their relationship to incidents.\n* Deployments/releases with change metadata (commit hash, feature flags, owner team).\nThe schema should support queries like \"incidents within 30 minutes of a deployment,\" \"alerts that fired but did not correspond to any incident (false positives),\" and \"MTTR by service and severity.\"",
      "schema": {
        "tables": {
          "service": {
            "name": "service",
            "kind": "dimension",
            "row_count": 500,
            "columns": [
              {
                "name": "service_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "cluster": {
            "name": "cluster",
            "kind": "dimension",
            "row_count": 200,
            "columns": [
              {
                "name": "cluster_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "environment": {
            "name": "environment",
            "kind": "dimension",
            "row_count": 3,
            "columns": [
              {
                "name": "environment_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "metric_interval": {
            "name": "metric_interval",
            "kind": "fact",
            "row_count": 100000000,
            "columns": [
              {
                "name": "interval_start",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "service_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "service.service_id"
              },
              {
                "name": "cluster_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "cluster.cluster_id"
              },
              {
                "name": "environment_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "environment.environment_id"
              },
              {
                "name": "cpu_usage",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "primary_key": [
              "interval_start",
              "service_id",
              "cluster_id",
              "environment_id"
            ],
            "foreign_keys": [
              {
                "column": "service_id",
                "ref_table": "service",
                "ref_column": "service_id"
              },
              {
                "column": "cluster_id",
                "ref_table": "cluster",
                "ref_column": "cluster_id"
              },
              {
                "column": "environment_id",
                "ref_table": "environment",
                "ref_column": "environment_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["service_id", "cluster_id", "environment_id", "interval_start"],
                "dependents": ["cpu_usage"]
              }
            ]
          },
          "incident": {
            "name": "incident",
            "kind": "fact",
            "row_count": 5000,
            "columns": [
              {
                "name": "incident_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "service_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "service.service_id"
              },
              {
                "name": "start_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "end_ts",
                "sql_type": "DATETIME",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "service_id",
                "ref_table": "service",
                "ref_column": "service_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["incident_id"],
                "dependents": ["service_id", "start_ts", "end_ts"]
              }
            ]
          },
          "deployment": {
            "name": "deployment",
            "kind": "fact",
            "row_count": 20000,
            "columns": [
              {
                "name": "deployment_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "service_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "service.service_id"
              },
              {
                "name": "deploy_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "service_id",
                "ref_table": "service",
                "ref_column": "service_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["deployment_id"],
                "dependents": ["service_id", "deploy_ts"]
              }
            ]
          },
          "alert": {
            "name": "alert",
            "kind": "fact",
            "row_count": 100000,
            "columns": [
              {
                "name": "alert_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "incident_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "incident.incident_id"
              },
              {
                "name": "alert_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "incident_id",
                "ref_table": "incident",
                "ref_column": "incident_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["alert_id"],
                "dependents": ["incident_id", "alert_ts"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "service",
            "column": "service_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 500.0
            },
            "provider": null
          },
          {
            "table": "cluster",
            "column": "cluster_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 200.0
            },
            "provider": null
          },
          {
            "table": "environment",
            "column": "environment_id",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["1", "2", "3"],
                "probs": [0.5, 0.3, 0.2]
              }
            },
            "provider": null
          },
          {
            "table": "metric_interval",
            "column": "interval_start",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "metric_interval",
            "column": "service_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 500
            },
            "provider": null
          },
          {
            "table": "metric_interval",
            "column": "cluster_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 200
            },
            "provider": null
          },
          {
            "table": "metric_interval",
            "column": "environment_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 3
            },
            "provider": null
          },
          {
            "table": "metric_interval",
            "column": "cpu_usage",
            "distribution": {
              "kind": "normal",
              "mean": 50.0,
              "std": 15.0
            },
            "provider": null
          },
          {
            "table": "incident",
            "column": "incident_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000.0
            },
            "provider": null
          },
          {
            "table": "incident",
            "column": "service_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 500
            },
            "provider": null
          },
          {
            "table": "incident",
            "column": "start_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "incident",
            "column": "end_ts",
            "distribution": {
              "kind": "derived",
              "expression": "start_ts + hours(uniform(1, 24))",
              "dtype": "datetime"
            },
            "provider": null
          },
          {
            "table": "deployment",
            "column": "deployment_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 20000.0
            },
            "provider": null
          },
          {
            "table": "deployment",
            "column": "service_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 500
            },
            "provider": null
          },
          {
            "table": "deployment",
            "column": "deploy_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "alert",
            "column": "alert_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 100000.0
            },
            "provider": null
          },
          {
            "table": "alert",
            "column": "incident_id",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["null", "1", "2", "3", "4", "5"],
                "probs": [0.3, 0.14, 0.14, 0.14, 0.14, 0.14]
              }
            },
            "provider": null
          },
          {
            "table": "alert",
            "column": "alert_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          }
        ],
        "events": []
      }
    },
    {
      "number": 23,
      "tier": "extended",
      "text": "Create a **B2B contracts and usage** dataset for an API platform where customers sign contracts with **committed usage** and **overage pricing**.\nInclude:\n* Customers and contracts (start/end, committed monthly units, price tiers, SLAs).\n* API usage aggregated by day and endpoint, tagged by customer and environment.\n* Overage calculations (units above commitment) and invoices linked to both contract and usage.\n* SLA breaches computed from uptime/latency metrics per contract.\nEnsure the schema can express: \"monthly revenue vs committed revenue,\" \"customers consistently under-utilizing their commitment,\" and \"contracts frequently breaching SLA but not yet churned.\"",
      "schema": {
        "tables": {
          "customer": {
            "name": "customer",
            "kind": "dimension",
            "row_count": 5000,
            "columns": [
              {
                "name": "customer_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "contract": {
            "name": "contract",
            "kind": "fact",
            "row_count": 8000,
            "columns": [
              {
                "name": "contract_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "customer_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "customer.customer_id"
              },
              {
                "name": "start_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "end_date",
                "sql_type": "DATE",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "committed_monthly_units",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "customer_id",
                "ref_table": "customer",
                "ref_column": "customer_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["contract_id"],
                "dependents": ["customer_id", "start_date", "end_date", "committed_monthly_units"]
              }
            ]
          },
          "usage_daily": {
            "name": "usage_daily",
            "kind": "fact",
            "row_count": 2000000,
            "columns": [
              {
                "name": "usage_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "contract_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "contract.contract_id"
              },
              {
                "name": "endpoint",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "units_used",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "primary_key": [
              "usage_date",
              "contract_id",
              "endpoint"
            ],
            "foreign_keys": [
              {
                "column": "contract_id",
                "ref_table": "contract",
                "ref_column": "contract_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["contract_id", "usage_date", "endpoint"],
                "dependents": ["units_used"]
              }
            ]
          },
          "invoice": {
            "name": "invoice",
            "kind": "fact",
            "row_count": 120000,
            "columns": [
              {
                "name": "invoice_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "contract_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "contract.contract_id"
              },
              {
                "name": "invoice_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "billed_units",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "overage_units",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "contract_id",
                "ref_table": "contract",
                "ref_column": "contract_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["invoice_id"],
                "dependents": ["contract_id", "invoice_date", "billed_units", "overage_units"]
              },
              {
                "determinants": ["contract_id", "billed_units"],
                "dependents": ["overage_units"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "customer",
            "column": "customer_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000.0
            },
            "provider": null
          },
          {
            "table": "contract",
            "column": "contract_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 8000.0
            },
            "provider": null
          },
          {
            "table": "contract",
            "column": "customer_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 5000
            },
            "provider": null
          },
          {
            "table": "contract",
            "column": "start_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "contract",
            "column": "end_date",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["null", "date"],
                "probs": [0.2, 0.8]
              }
            },
            "provider": null
          },
          {
            "table": "contract",
            "column": "committed_monthly_units",
            "distribution": {
              "kind": "lognormal",
              "mean": 5.0,
              "sigma": 1.0
            },
            "provider": null
          },
          {
            "table": "usage_daily",
            "column": "usage_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "usage_daily",
            "column": "contract_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 8000
            },
            "provider": null
          },
          {
            "table": "usage_daily",
            "column": "endpoint",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["/api/v1/users", "/api/v1/products", "/api/v1/orders", "/api/v1/payments"],
                "probs": [0.3, 0.3, 0.2, 0.2]
              }
            },
            "provider": null
          },
          {
            "table": "usage_daily",
            "column": "units_used",
            "distribution": {
              "kind": "poisson",
              "lam": 1000.0
            },
            "provider": null
          },
          {
            "table": "invoice",
            "column": "invoice_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 120000.0
            },
            "provider": null
          },
          {
            "table": "invoice",
            "column": "contract_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 8000
            },
            "provider": null
          },
          {
            "table": "invoice",
            "column": "invoice_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "invoice",
            "column": "billed_units",
            "distribution": {
              "kind": "lognormal",
              "mean": 5.5,
              "sigma": 1.0
            },
            "provider": null
          },
          {
            "table": "invoice",
            "column": "overage_units",
            "distribution": {
              "kind": "derived",
              "expression": "max(billed_units - committed_monthly_units, 0)",
              "dtype": "int"
            },
            "provider": null
          }
        ],
        "events": []
      }
    },
    {
      "number": 24,
      "tier": "extended",
      "text": "Design a **food delivery platform** dataset that captures orders with **multi-party interactions** (customer, restaurant, courier).\nThe schema should cover:\n* Restaurants with opening hours, cuisines, and dynamic availability (open/closed/paused).\n* Menus and menu items with options/add-ons (extra cheese, size variants).\n* Orders and order items, with special instructions and scheduled vs ASAP orders.\n* Courier assignments, reassignments, and pickup/delivery timestamps.\n* Cancellations and refunds with reason codes (restaurant closed, courier unavailable, customer changed mind).\nIt should be possible to answer: \"median prep time per restaurant,\" \"couriers with unusually high cancellation rates,\" and \"orders delivered cold (delivery time way above restaurant's SLA).\"",
      "schema": {
        "tables": {
          "restaurant": {
            "name": "restaurant",
            "kind": "dimension",
            "row_count": 50000,
            "columns": [
              {
                "name": "restaurant_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "menu_item": {
            "name": "menu_item",
            "kind": "dimension",
            "row_count": 200000,
            "columns": [
              {
                "name": "menu_item_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "restaurant_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "restaurant.restaurant_id"
              }
            ],
            "foreign_keys": [
              {
                "column": "restaurant_id",
                "ref_table": "restaurant",
                "ref_column": "restaurant_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["menu_item_id"],
                "dependents": ["restaurant_id"]
              }
            ]
          },
          "customer": {
            "name": "customer",
            "kind": "dimension",
            "row_count": 10000000,
            "columns": [
              {
                "name": "customer_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "courier": {
            "name": "courier",
            "kind": "dimension",
            "row_count": 200000,
            "columns": [
              {
                "name": "courier_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "order": {
            "name": "order",
            "kind": "fact",
            "row_count": 20000000,
            "columns": [
              {
                "name": "order_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "customer_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "customer.customer_id"
              },
              {
                "name": "restaurant_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "restaurant.restaurant_id"
              }
            ],
            "foreign_keys": [
              {
                "column": "customer_id",
                "ref_table": "customer",
                "ref_column": "customer_id"
              },
              {
                "column": "restaurant_id",
                "ref_table": "restaurant",
                "ref_column": "restaurant_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["order_id"],
                "dependents": ["customer_id", "restaurant_id"]
              }
            ]
          },
          "order_item": {
            "name": "order_item",
            "kind": "fact",
            "row_count": 60000000,
            "columns": [
              {
                "name": "order_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "order.order_id"
              },
              {
                "name": "order_item_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "menu_item_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "menu_item.menu_item_id"
              }
            ],
            "primary_key": [
              "order_id",
              "order_item_id"
            ],
            "foreign_keys": [
              {
                "column": "order_id",
                "ref_table": "order",
                "ref_column": "order_id"
              },
              {
                "column": "menu_item_id",
                "ref_table": "menu_item",
                "ref_column": "menu_item_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["order_id", "order_item_id"],
                "dependents": ["menu_item_id"]
              }
            ]
          },
          "courier_assignment": {
            "name": "courier_assignment",
            "kind": "fact",
            "row_count": 30000000,
            "columns": [
              {
                "name": "order_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "order.order_id"
              },
              {
                "name": "assignment_seq",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "courier_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "courier.courier_id"
              },
              {
                "name": "pickup_ts",
                "sql_type": "DATETIME",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "delivery_ts",
                "sql_type": "DATETIME",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "primary_key": [
              "order_id",
              "assignment_seq"
            ],
            "foreign_keys": [
              {
                "column": "order_id",
                "ref_table": "order",
                "ref_column": "order_id"
              },
              {
                "column": "courier_id",
                "ref_table": "courier",
                "ref_column": "courier_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["order_id", "assignment_seq"],
                "dependents": ["courier_id", "pickup_ts", "delivery_ts"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "restaurant",
            "column": "restaurant_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 50000.0
            },
            "provider": null
          },
          {
            "table": "menu_item",
            "column": "menu_item_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 200000.0
            },
            "provider": null
          },
          {
            "table": "menu_item",
            "column": "restaurant_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 50000
            },
            "provider": null
          },
          {
            "table": "customer",
            "column": "customer_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000000.0
            },
            "provider": null
          },
          {
            "table": "courier",
            "column": "courier_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 200000.0
            },
            "provider": null
          },
          {
            "table": "order",
            "column": "order_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 20000000.0
            },
            "provider": null
          },
          {
            "table": "order",
            "column": "customer_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 10000000
            },
            "provider": null
          },
          {
            "table": "order",
            "column": "restaurant_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 50000
            },
            "provider": null
          },
          {
            "table": "order_item",
            "column": "order_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 20000000
            },
            "provider": null
          },
          {
            "table": "order_item",
            "column": "order_item_id",
            "distribution": {
              "kind": "poisson",
              "lam": 3.0
            },
            "provider": null
          },
          {
            "table": "order_item",
            "column": "menu_item_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.4,
              "n": 200000
            },
            "provider": null
          },
          {
            "table": "courier_assignment",
            "column": "order_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 20000000
            },
            "provider": null
          },
          {
            "table": "courier_assignment",
            "column": "assignment_seq",
            "distribution": {
              "kind": "poisson",
              "lam": 1.2
            },
            "provider": null
          },
          {
            "table": "courier_assignment",
            "column": "courier_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 200000
            },
            "provider": null
          },
          {
            "table": "courier_assignment",
            "column": "pickup_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "courier_assignment",
            "column": "delivery_ts",
            "distribution": {
              "kind": "derived",
              "expression": "pickup_ts + minutes(uniform(15, 60))",
              "dtype": "datetime"
            },
            "provider": null
          }
        ],
        "events": []
      }
    },
    {
      "number": 25,
      "tier": "extended",
      "text": "Create a **university academic records** dataset focused on **program changes, prerequisites, and retakes** rather than just simple enrollments.\nInclude:\n* Students with admission cohort, program/major history (with effective dates), and academic status (active, leave, dismissed, graduated).\n* Courses with prerequisite chains and equivalence mappings (legacy vs new course codes).\n* Enrollments with attempt number, grade, and flags for retake, withdrawal, or incomplete.\n* Term-level aggregates (GPA, credits attempted vs completed).\nThe schema should allow queries like \"students who changed major from STEM to non-STEM and then improved GPA,\" \"bottleneck courses with high failure rate among prerequisite chains,\" and \"average number of attempts before passing key gateway courses.\"",
      "schema": {
        "tables": {
          "student": {
            "name": "student",
            "kind": "dimension",
            "row_count": 50000,
            "columns": [
              {
                "name": "student_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "program": {
            "name": "program",
            "kind": "dimension",
            "row_count": 500,
            "columns": [
              {
                "name": "program_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "student_program_history": {
            "name": "student_program_history",
            "kind": "fact",
            "row_count": 150000,
            "columns": [
              {
                "name": "student_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "student.student_id"
              },
              {
                "name": "program_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "program.program_id"
              },
              {
                "name": "effective_from",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "primary_key": [
              "student_id",
              "effective_from"
            ],
            "foreign_keys": [
              {
                "column": "student_id",
                "ref_table": "student",
                "ref_column": "student_id"
              },
              {
                "column": "program_id",
                "ref_table": "program",
                "ref_column": "program_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["student_id", "effective_from"],
                "dependents": ["program_id"]
              }
            ]
          },
          "course": {
            "name": "course",
            "kind": "dimension",
            "row_count": 5000,
            "columns": [
              {
                "name": "course_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "course_prerequisite": {
            "name": "course_prerequisite",
            "kind": "fact",
            "row_count": 10000,
            "columns": [
              {
                "name": "course_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "course.course_id"
              },
              {
                "name": "prereq_course_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "course.course_id"
              }
            ],
            "primary_key": [
              "course_id",
              "prereq_course_id"
            ],
            "foreign_keys": [
              {
                "column": "course_id",
                "ref_table": "course",
                "ref_column": "course_id"
              },
              {
                "column": "prereq_course_id",
                "ref_table": "course",
                "ref_column": "course_id"
              }
            ]
          },
          "enrollment": {
            "name": "enrollment",
            "kind": "fact",
            "row_count": 1000000,
            "columns": [
              {
                "name": "student_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "student.student_id"
              },
              {
                "name": "course_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "course.course_id"
              },
              {
                "name": "term_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "attempt_number",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "grade",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "primary_key": [
              "student_id",
              "course_id",
              "term_id",
              "attempt_number"
            ],
            "foreign_keys": [
              {
                "column": "student_id",
                "ref_table": "student",
                "ref_column": "student_id"
              },
              {
                "column": "course_id",
                "ref_table": "course",
                "ref_column": "course_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["student_id", "course_id", "term_id", "attempt_number"],
                "dependents": ["grade"]
              }
            ]
          },
          "term_aggregate": {
            "name": "term_aggregate",
            "kind": "fact",
            "row_count": 200000,
            "columns": [
              {
                "name": "student_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "student.student_id"
              },
              {
                "name": "term_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "gpa",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "primary_key": [
              "student_id",
              "term_id"
            ],
            "foreign_keys": [
              {
                "column": "student_id",
                "ref_table": "student",
                "ref_column": "student_id"
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "student",
            "column": "student_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 50000.0
            },
            "provider": null
          },
          {
            "table": "program",
            "column": "program_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 500.0
            },
            "provider": null
          },
          {
            "table": "student_program_history",
            "column": "student_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 50000
            },
            "provider": null
          },
          {
            "table": "student_program_history",
            "column": "program_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 500
            },
            "provider": null
          },
          {
            "table": "student_program_history",
            "column": "effective_from",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "course",
            "column": "course_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000.0
            },
            "provider": null
          },
          {
            "table": "course_prerequisite",
            "column": "course_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 5000
            },
            "provider": null
          },
          {
            "table": "course_prerequisite",
            "column": "prereq_course_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 5000
            },
            "provider": null
          },
          {
            "table": "enrollment",
            "column": "student_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 50000
            },
            "provider": null
          },
          {
            "table": "enrollment",
            "column": "course_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 5000
            },
            "provider": null
          },
          {
            "table": "enrollment",
            "column": "term_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 100
            },
            "provider": null
          },
          {
            "table": "enrollment",
            "column": "attempt_number",
            "distribution": {
              "kind": "poisson",
              "lam": 1.2
            },
            "provider": null
          },
          {
            "table": "enrollment",
            "column": "grade",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["A", "B", "C", "D", "F", "W", "I"],
                "probs": [0.25, 0.25, 0.2, 0.1, 0.1, 0.05, 0.05]
              }
            },
            "provider": null
          },
          {
            "table": "term_aggregate",
            "column": "student_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 50000
            },
            "provider": null
          },
          {
            "table": "term_aggregate",
            "column": "term_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 100
            },
            "provider": null
          },
          {
            "table": "term_aggregate",
            "column": "gpa",
            "distribution": {
              "kind": "normal",
              "mean": 3.0,
              "std": 0.8
            },
            "provider": null
          }
        ],
        "events": []
      }
    },
    {
      "number": 26,
      "tier": "extended",
      "text": "Ride-hailing trips with event-driven surge. Model drivers, riders, zones, and trips with a status flow (REQUESTED → ACCEPTED → PICKED_UP → DROPPED_OFF or CANCELLED). Demand and cancellations spike during concerts and games in {stadium, downtown} zones, and on pay-days (day_of_month in {1,15}). Surge_multiplier should depend on the demand/supply ratio per 15‑minute bucket, weather conditions, and event proximity. Include pooling (shared trips), ETA estimates affected by traffic, and \"impossible driver jumps\" checks using geo distance and time differences. Workload should emphasize time-bucketed KPIs by zone and surge impact analysis.",
      "schema": {
        "tables": {
          "driver": {
            "name": "driver",
            "kind": "dimension",
            "row_count": 500000,
            "columns": [
              {
                "name": "driver_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "rider": {
            "name": "rider",
            "kind": "dimension",
            "row_count": 10000000,
            "columns": [
              {
                "name": "rider_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "zone": {
            "name": "zone",
            "kind": "dimension",
            "row_count": 1000,
            "columns": [
              {
                "name": "zone_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "trip": {
            "name": "trip",
            "kind": "fact",
            "row_count": 30000000,
            "columns": [
              {
                "name": "trip_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "driver_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "driver.driver_id"
              },
              {
                "name": "rider_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "rider.rider_id"
              },
              {
                "name": "pickup_zone_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "zone.zone_id"
              },
              {
                "name": "dropoff_zone_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "zone.zone_id"
              },
              {
                "name": "status",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "surge_multiplier",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "driver_id",
                "ref_table": "driver",
                "ref_column": "driver_id"
              },
              {
                "column": "rider_id",
                "ref_table": "rider",
                "ref_column": "rider_id"
              },
              {
                "column": "pickup_zone_id",
                "ref_table": "zone",
                "ref_column": "zone_id"
              },
              {
                "column": "dropoff_zone_id",
                "ref_table": "zone",
                "ref_column": "zone_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["trip_id"],
                "dependents": ["driver_id", "rider_id", "pickup_zone_id", "dropoff_zone_id", "status", "surge_multiplier"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "driver",
            "column": "driver_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 500000.0
            },
            "provider": null
          },
          {
            "table": "rider",
            "column": "rider_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000000.0
            },
            "provider": null
          },
          {
            "table": "zone",
            "column": "zone_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000.0
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "trip_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 30000000.0
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "driver_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 500000
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "rider_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 10000000
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "pickup_zone_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 1000
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "dropoff_zone_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 1000
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "status",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["REQUESTED", "ACCEPTED", "PICKED_UP", "DROPPED_OFF", "CANCELLED"],
                "probs": [0.15, 0.15, 0.15, 0.45, 0.1]
              }
            },
            "provider": null
          },
          {
            "table": "trip",
            "column": "surge_multiplier",
            "distribution": {
              "kind": "derived",
              "expression": "base_surge * event_multiplier * weather_multiplier",
              "dtype": "FLOAT",
              "depends_on": ["pickup_zone_id", "request_ts"]
            },
            "provider": null
          }
        ],
        "events": [
          {
            "name": "stadium_event",
            "start_time": "2024-01-15T18:00:00",
            "end_time": "2024-01-15T22:00:00",
            "effects": [
              {
                "table": "trip",
                "column": "pickup_zone_id",
                "effect_type": "multiply_distribution",
                "value": 2.5
              }
            ]
          },
          {
            "name": "payday_spike",
            "start_time": "2024-01-01T00:00:00",
            "end_time": "2024-01-01T23:59:59",
            "effects": [
              {
                "table": "trip",
                "effect_type": "multiply_distribution",
                "value": 1.8
              }
            ]
          }
        ]
      }
    },
    {
      "number": 27,
      "tier": "extended",
      "text": "Card transactions and fraud signals\n* Tables for customers, cards, merchants, devices, transactions, disputes.\n* Amounts are heavy-tailed (lognormal), and merchant_id popularity is Zipfian; electronics and travel categories have heavier tails than groceries.\n* Velocity features: per-card counts and sums over last 10 minutes and 24 hours; lag to previous transaction timestamp and country.\n* Impossible travel: flag when geo_distance between consecutive transactions implies speed > 900 km/h within ts_diff.\n* Fraud rings: scenarios where many cards transact at the same merchant within a short window; device or IP reuse increases risk.\n* Constraints: card_id → customer_id; if is_fraud=1 then chargeback_within_30d=1.",
      "schema": {
        "tables": {
          "customer": {
            "name": "customer",
            "kind": "dimension",
            "row_count": 1000000,
            "columns": [
              {
                "name": "customer_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "card": {
            "name": "card",
            "kind": "dimension",
            "row_count": 2000000,
            "columns": [
              {
                "name": "card_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "customer_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "customer.customer_id"
              }
            ],
            "foreign_keys": [
              {
                "column": "customer_id",
                "ref_table": "customer",
                "ref_column": "customer_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["card_id"],
                "dependents": ["customer_id"]
              }
            ]
          },
          "merchant": {
            "name": "merchant",
            "kind": "dimension",
            "row_count": 500000,
            "columns": [
              {
                "name": "merchant_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "device": {
            "name": "device",
            "kind": "dimension",
            "row_count": 3000000,
            "columns": [
              {
                "name": "device_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "transaction": {
            "name": "transaction",
            "kind": "fact",
            "row_count": 80000000,
            "columns": [
              {
                "name": "transaction_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "card_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "card.card_id"
              },
              {
                "name": "merchant_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "merchant.merchant_id"
              },
              {
                "name": "device_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "device.device_id"
              },
              {
                "name": "amount",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "transaction_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "is_fraud",
                "sql_type": "BOOL",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "card_id",
                "ref_table": "card",
                "ref_column": "card_id"
              },
              {
                "column": "merchant_id",
                "ref_table": "merchant",
                "ref_column": "merchant_id"
              },
              {
                "column": "device_id",
                "ref_table": "device",
                "ref_column": "device_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["transaction_id"],
                "dependents": ["card_id", "merchant_id", "device_id", "amount", "transaction_ts", "is_fraud"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "customer",
            "column": "customer_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000000.0
            },
            "provider": null
          },
          {
            "table": "card",
            "column": "card_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 2000000.0
            },
            "provider": null
          },
          {
            "table": "card",
            "column": "customer_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 1000000
            },
            "provider": null
          },
          {
            "table": "merchant",
            "column": "merchant_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.5,
              "n": 500000
            },
            "provider": null
          },
          {
            "table": "device",
            "column": "device_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 3000000.0
            },
            "provider": null
          },
          {
            "table": "transaction",
            "column": "transaction_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 80000000.0
            },
            "provider": null
          },
          {
            "table": "transaction",
            "column": "card_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 2000000
            },
            "provider": null
          },
          {
            "table": "transaction",
            "column": "merchant_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.5,
              "n": 500000
            },
            "provider": null
          },
          {
            "table": "transaction",
            "column": "device_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 3000000
            },
            "provider": null
          },
          {
            "table": "transaction",
            "column": "amount",
            "distribution": {
              "kind": "lognormal",
              "mean": 3.0,
              "sigma": 1.5
            },
            "provider": null
          },
          {
            "table": "transaction",
            "column": "transaction_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "transaction",
            "column": "is_fraud",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": [true, false],
                "probs": [0.01, 0.99]
              }
            },
            "provider": null
          }
        ],
        "events": []
      }
    },
    {
      "number": 28,
      "tier": "extended",
      "text": "E‑commerce orders and returns with inventory realism. Model users, products, inventory, promotions, orders, order_lines, shipments, returns, and RMAs. Orders can mix coupons, gift cards, and tax jurisdictions; derived net_revenue must account for discounts, tax, shipping, and partial refunds after returns. Enforce state machines for both orders and shipments, and a non‑negative inventory invariant with restock on return. Shipping lead times vary by carrier and are longer on weekends/holidays; pay-day periods increase AOV. Workload should include cohort revenue by campaign and return rate by category.",
      "schema": {
        "tables": {
          "user": {
            "name": "user",
            "kind": "dimension",
            "row_count": 10000000,
            "columns": [
              {
                "name": "user_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "product": {
            "name": "product",
            "kind": "dimension",
            "row_count": 200000,
            "columns": [
              {
                "name": "product_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "inventory": {
            "name": "inventory",
            "kind": "fact",
            "row_count": 1000000,
            "columns": [
              {
                "name": "product_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "product.product_id"
              },
              {
                "name": "on_hand_qty",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "primary_key": [
              "product_id"
            ],
            "foreign_keys": [
              {
                "column": "product_id",
                "ref_table": "product",
                "ref_column": "product_id"
              }
            ]
          },
          "order": {
            "name": "order",
            "kind": "fact",
            "row_count": 20000000,
            "columns": [
              {
                "name": "order_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "user_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "user.user_id"
              }
            ],
            "foreign_keys": [
              {
                "column": "user_id",
                "ref_table": "user",
                "ref_column": "user_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["order_id"],
                "dependents": ["user_id"]
              }
            ]
          },
          "order_line": {
            "name": "order_line",
            "kind": "fact",
            "row_count": 60000000,
            "columns": [
              {
                "name": "order_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "order.order_id"
              },
              {
                "name": "line_number",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "product_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "product.product_id"
              },
              {
                "name": "net_revenue",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "primary_key": [
              "order_id",
              "line_number"
            ],
            "foreign_keys": [
              {
                "column": "order_id",
                "ref_table": "order",
                "ref_column": "order_id"
              },
              {
                "column": "product_id",
                "ref_table": "product",
                "ref_column": "product_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["order_id", "line_number"],
                "dependents": ["product_id", "net_revenue"]
              }
            ]
          },
          "return": {
            "name": "return",
            "kind": "fact",
            "row_count": 4000000,
            "columns": [
              {
                "name": "return_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "order_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "order.order_id"
              },
              {
                "name": "line_number",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "order_id",
                "ref_table": "order",
                "ref_column": "order_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["return_id"],
                "dependents": ["order_id", "line_number"]
              },
              {
                "determinants": ["order_id", "line_number"],
                "dependents": ["return_id"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "user",
            "column": "user_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000000.0
            },
            "provider": null
          },
          {
            "table": "product",
            "column": "product_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 200000.0
            },
            "provider": null
          },
          {
            "table": "inventory",
            "column": "product_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 200000
            },
            "provider": null
          },
          {
            "table": "inventory",
            "column": "on_hand_qty",
            "distribution": {
              "kind": "poisson",
              "lam": 50.0
            },
            "provider": null
          },
          {
            "table": "order",
            "column": "order_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 20000000.0
            },
            "provider": null
          },
          {
            "table": "order",
            "column": "user_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 10000000
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "order_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 20000000
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "line_number",
            "distribution": {
              "kind": "poisson",
              "lam": 2.5
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "product_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.4,
              "n": 200000
            },
            "provider": null
          },
          {
            "table": "order_line",
            "column": "net_revenue",
            "distribution": {
              "kind": "derived",
              "expression": "line_subtotal - discount_amount + tax_amount + shipping_cost - partial_refund",
              "dtype": "FLOAT",
              "depends_on": ["order_id", "line_number"]
            },
            "provider": null
          },
          {
            "table": "return",
            "column": "return_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 4000000.0
            },
            "provider": null
          },
          {
            "table": "return",
            "column": "order_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 20000000
            },
            "provider": null
          },
          {
            "table": "return",
            "column": "line_number",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10.0
            },
            "provider": null
          }
        ],
        "events": [
          {
            "name": "payday_aov_boost",
            "start_time": "2024-01-01T00:00:00",
            "end_time": "2024-01-01T23:59:59",
            "effects": [
              {
                "table": "order_line",
                "column": "net_revenue",
                "effect_type": "multiply_distribution",
                "value": 1.3
              }
            ]
          }
        ]
      }
    },
    {
      "number": 29,
      "tier": "extended",
      "text": "Industrial IoT in a manufacturing plant\n* Sensors emit readings every minute with sensor_id → (plant_id, line_id, sensor_type) as an FD.\n* Calibration drift is gradual; maintenance events reset drift.\n* Power outage incidents create missing data, spiky restarts, and correlated anomalies across sensors in the same line.\n* Rolling features: 15‑minute rolling_mean and rolling_std per sensor; anomaly flags depend on deviations from rolling baselines and recent maintenance.\n* Data gaps should be explicit (missing intervals) and influence derived flags; include a small set of bad sensors that intermittently freeze.",
      "schema": {
        "tables": {
          "sensor": {
            "name": "sensor",
            "kind": "dimension",
            "row_count": 10000,
            "columns": [
              {
                "name": "sensor_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "plant_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "plant.plant_id"
              },
              {
                "name": "line_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "line.line_id"
              },
              {
                "name": "sensor_type",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "plant_id",
                "ref_table": "plant",
                "ref_column": "plant_id"
              },
              {
                "column": "line_id",
                "ref_table": "line",
                "ref_column": "line_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["sensor_id"],
                "dependents": ["plant_id", "line_id", "sensor_type"]
              }
            ]
          },
          "reading": {
            "name": "reading",
            "kind": "fact",
            "row_count": 500000000,
            "columns": [
              {
                "name": "sensor_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "sensor.sensor_id"
              },
              {
                "name": "ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "value",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "primary_key": [
              "sensor_id",
              "ts"
            ],
            "foreign_keys": [
              {
                "column": "sensor_id",
                "ref_table": "sensor",
                "ref_column": "sensor_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["sensor_id", "ts"],
                "dependents": ["value"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "sensor",
            "column": "sensor_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000.0
            },
            "provider": null
          },
          {
            "table": "sensor",
            "column": "plant_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 10
            },
            "provider": null
          },
          {
            "table": "sensor",
            "column": "line_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 100
            },
            "provider": null
          },
          {
            "table": "sensor",
            "column": "sensor_type",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["temperature", "pressure", "vibration", "current", "flow"],
                "probs": [0.25, 0.25, 0.2, 0.15, 0.15]
              }
            },
            "provider": null
          },
          {
            "table": "reading",
            "column": "sensor_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.1,
              "n": 10000
            },
            "provider": null
          },
          {
            "table": "reading",
            "column": "ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "reading",
            "column": "value",
            "distribution": {
              "kind": "normal",
              "mean": 50.0,
              "std": 10.0
            },
            "provider": null
          }
        ],
        "events": [
          {
            "name": "power_outage",
            "start_time": "2024-01-15T10:00:00",
            "end_time": "2024-01-15T10:30:00",
            "effects": [
              {
                "table": "reading",
                "effect_type": "set_value",
                "value": null
              }
            ]
          },
          {
            "name": "maintenance_reset",
            "start_time": "2024-01-20T08:00:00",
            "end_time": "2024-01-20T08:30:00",
            "effects": [
              {
                "table": "reading",
                "column": "value",
                "effect_type": "add_offset",
                "value": -5.0
              }
            ]
          }
        ]
      }
    },
    {
      "number": 30,
      "tier": "extended",
      "text": "Multi-tenant SaaS product metrics with SLOs. Model tenants, users, releases, incidents, and a metrics_timeseries (e.g., requests, error_rate, latency_p95) at 1‑minute or 5‑minute grain. Tenants follow a Zipf distribution for traffic. Incidents scoped to regions/services raise error_rate and latency; releases may regress or improve metrics. A \"chronic_slo_violator\" flag is true if latency_p95 breach rate exceeds 5% over the last 7 days per tenant. Workload focuses on time-series dashboards, incident postmortems, and tenant health leaderboards.",
      "schema": {
        "tables": {
          "tenant": {
            "name": "tenant",
            "kind": "dimension",
            "row_count": 10000,
            "columns": [
              {
                "name": "tenant_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "metrics_timeseries": {
            "name": "metrics_timeseries",
            "kind": "fact",
            "row_count": 200000000,
            "columns": [
              {
                "name": "ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "tenant_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "tenant.tenant_id"
              },
              {
                "name": "metric_name",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "value",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "primary_key": [
              "ts",
              "tenant_id",
              "metric_name"
            ],
            "foreign_keys": [
              {
                "column": "tenant_id",
                "ref_table": "tenant",
                "ref_column": "tenant_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["tenant_id", "metric_name", "ts"],
                "dependents": ["value"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "tenant",
            "column": "tenant_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000.0
            },
            "provider": null
          },
          {
            "table": "metrics_timeseries",
            "column": "ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "metrics_timeseries",
            "column": "tenant_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.5,
              "n": 10000
            },
            "provider": null
          },
          {
            "table": "metrics_timeseries",
            "column": "metric_name",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["requests", "error_rate", "latency_p95"],
                "probs": [0.4, 0.3, 0.3]
              }
            },
            "provider": null
          },
          {
            "table": "metrics_timeseries",
            "column": "value",
            "distribution": {
              "kind": "derived",
              "expression": "CASE WHEN metric_name='requests' THEN poisson(1000) WHEN metric_name='error_rate' THEN normal(0.01, 0.005) WHEN metric_name='latency_p95' THEN lognormal(3.0, 0.5) END",
              "dtype": "FLOAT",
              "depends_on": ["metric_name", "tenant_id", "ts"]
            },
            "provider": null
          }
        ],
        "events": [
          {
            "name": "incident_spike",
            "start_time": "2024-01-15T14:00:00",
            "end_time": "2024-01-15T15:00:00",
            "effects": [
              {
                "table": "metrics_timeseries",
                "column": "value",
                "effect_type": "multiply_distribution",
                "value": 2.0
              }
            ]
          }
        ]
      }
    },
    {
      "number": 31,
      "tier": "extended",
      "text": "Subscription billing with proration and add-ons\n* Entities: accounts, subscriptions, plans, plan_history (effective_from/to), invoices, invoice_line_items, payments, refunds, credits.\n* Mid-cycle upgrades/downgrades produce prorated charges; add-ons can be metered or flat.\n* Free trials, grace periods, and dunning retries affect status transitions (ACTIVE, PAST_DUE, CANCELED).\n* Currency ∈ {USD, EUR} with exchange rates by day; taxes differ by region.\n* Derived flags: churn_within_30d_of_upgrade; MRR/ARR calculations; recognition schedules for prepaid annual plans.\n* Constraints: if status='CANCELED' then end_date not null; (invoice_id, line_number) is a composite PK.",
      "schema": {
        "tables": {
          "account": {
            "name": "account",
            "kind": "dimension",
            "row_count": 50000,
            "columns": [
              {
                "name": "account_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "plan": {
            "name": "plan",
            "kind": "dimension",
            "row_count": 50,
            "columns": [
              {
                "name": "plan_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "subscription": {
            "name": "subscription",
            "kind": "fact",
            "row_count": 100000,
            "columns": [
              {
                "name": "subscription_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "account_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "account.account_id"
              },
              {
                "name": "plan_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "plan.plan_id"
              },
              {
                "name": "status",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "account_id",
                "ref_table": "account",
                "ref_column": "account_id"
              },
              {
                "column": "plan_id",
                "ref_table": "plan",
                "ref_column": "plan_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["subscription_id"],
                "dependents": ["account_id", "plan_id", "status"]
              }
            ]
          },
          "plan_history": {
            "name": "plan_history",
            "kind": "fact",
            "row_count": 200000,
            "columns": [
              {
                "name": "subscription_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "subscription.subscription_id"
              },
              {
                "name": "effective_from",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "plan_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "plan.plan_id"
              },
              {
                "name": "effective_to",
                "sql_type": "DATE",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "primary_key": [
              "subscription_id",
              "effective_from"
            ],
            "foreign_keys": [
              {
                "column": "subscription_id",
                "ref_table": "subscription",
                "ref_column": "subscription_id"
              },
              {
                "column": "plan_id",
                "ref_table": "plan",
                "ref_column": "plan_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["subscription_id", "effective_from"],
                "dependents": ["plan_id", "effective_to"]
              }
            ]
          },
          "invoice": {
            "name": "invoice",
            "kind": "fact",
            "row_count": 300000,
            "columns": [
              {
                "name": "invoice_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "account_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "account.account_id"
              },
              {
                "name": "invoice_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "due_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "total_amount",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "account_id",
                "ref_table": "account",
                "ref_column": "account_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["invoice_id"],
                "dependents": ["account_id", "invoice_date", "due_date", "total_amount"]
              }
            ]
          },
          "invoice_line_item": {
            "name": "invoice_line_item",
            "kind": "fact",
            "row_count": 900000,
            "columns": [
              {
                "name": "invoice_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "invoice.invoice_id"
              },
              {
                "name": "line_number",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "subscription_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "subscription.subscription_id"
              },
              {
                "name": "plan_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "plan.plan_id"
              },
              {
                "name": "add_on_code",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "quantity",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "amount",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "primary_key": [
              "invoice_id",
              "line_number"
            ],
            "foreign_keys": [
              {
                "column": "invoice_id",
                "ref_table": "invoice",
                "ref_column": "invoice_id"
              },
              {
                "column": "subscription_id",
                "ref_table": "subscription",
                "ref_column": "subscription_id"
              },
              {
                "column": "plan_id",
                "ref_table": "plan",
                "ref_column": "plan_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["invoice_id", "line_number"],
                "dependents": ["subscription_id", "plan_id", "add_on_code", "quantity", "amount"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "account",
            "column": "account_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 50000.0
            },
            "provider": null
          },
          {
            "table": "plan",
            "column": "plan_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 50.0
            },
            "provider": null
          },
          {
            "table": "subscription",
            "column": "subscription_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 100000.0
            },
            "provider": null
          },
          {
            "table": "subscription",
            "column": "account_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 50000
            },
            "provider": null
          },
          {
            "table": "subscription",
            "column": "plan_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 50
            },
            "provider": null
          },
          {
            "table": "subscription",
            "column": "status",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["ACTIVE", "PAST_DUE", "CANCELED"],
                "probs": [0.85, 0.1, 0.05]
              }
            },
            "provider": null
          },
          {
            "table": "plan_history",
            "column": "subscription_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 100000
            },
            "provider": null
          },
          {
            "table": "plan_history",
            "column": "effective_from",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "plan_history",
            "column": "plan_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 50
            },
            "provider": null
          },
          {
            "table": "plan_history",
            "column": "effective_to",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "invoice",
            "column": "invoice_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 300000.0
            },
            "provider": null
          },
          {
            "table": "invoice",
            "column": "account_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 50000
            },
            "provider": null
          },
          {
            "table": "invoice",
            "column": "invoice_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "invoice",
            "column": "due_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "invoice",
            "column": "total_amount",
            "distribution": {
              "kind": "lognormal",
              "mean": 4.0,
              "sigma": 1.0
            },
            "provider": null
          },
          {
            "table": "invoice_line_item",
            "column": "invoice_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 300000
            },
            "provider": null
          },
          {
            "table": "invoice_line_item",
            "column": "line_number",
            "distribution": {
              "kind": "poisson",
              "lam": 2.0
            },
            "provider": null
          },
          {
            "table": "invoice_line_item",
            "column": "subscription_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 100000
            },
            "provider": null
          },
          {
            "table": "invoice_line_item",
            "column": "plan_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 50
            },
            "provider": null
          },
          {
            "table": "invoice_line_item",
            "column": "add_on_code",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["storage_100gb", "api_calls_10k", "support_priority", null],
                "probs": [0.3, 0.3, 0.2, 0.2]
              }
            },
            "provider": null
          },
          {
            "table": "invoice_line_item",
            "column": "quantity",
            "distribution": {
              "kind": "poisson",
              "lam": 5.0
            },
            "provider": null
          },
          {
            "table": "invoice_line_item",
            "column": "amount",
            "distribution": {
              "kind": "lognormal",
              "mean": 3.5,
              "sigma": 1.2
            },
            "provider": null
          }
        ],
        "events": []
      }
    },
    {
      "number": 32,
      "tier": "extended",
      "text": "Marketing journeys and attribution across channels. Represent users, identities (cookies, device_ids), touchpoints (channel ∈ {email, paid_search, social, organic, direct, retail}), sessions, and conversions. Identity stitching merges multiple cookies into a user graph with occasional resets; bots exist with high pageviews and near‑zero dwell time. Attribution supports last‑touch, first‑touch, and time-decay over 7 days; deduplicate same-channel touches in a 30‑minute window. Campaign calendars and promotions shift channel mix (e.g., during a sale weekend). Workload emphasizes multi-touch attribution tables and path analysis.",
      "schema": {
        "tables": {
          "user": {
            "name": "user",
            "kind": "dimension",
            "row_count": 10000000,
            "columns": [
              {
                "name": "user_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "identity": {
            "name": "identity",
            "kind": "dimension",
            "row_count": 50000000,
            "columns": [
              {
                "name": "identity_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "user_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "user.user_id"
              }
            ],
            "foreign_keys": [
              {
                "column": "user_id",
                "ref_table": "user",
                "ref_column": "user_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["identity_id"],
                "dependents": ["user_id"]
              }
            ]
          },
          "touchpoint": {
            "name": "touchpoint",
            "kind": "fact",
            "row_count": 200000000,
            "columns": [
              {
                "name": "touchpoint_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "identity_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "identity.identity_id"
              },
              {
                "name": "channel",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "touch_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "identity_id",
                "ref_table": "identity",
                "ref_column": "identity_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["touchpoint_id"],
                "dependents": ["identity_id", "channel", "touch_ts"]
              }
            ]
          },
          "conversion": {
            "name": "conversion",
            "kind": "fact",
            "row_count": 5000000,
            "columns": [
              {
                "name": "conversion_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "user_id",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "foreign_key",
                "references": "user.user_id"
              },
              {
                "name": "conversion_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "conversion_value",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "user_id",
                "ref_table": "user",
                "ref_column": "user_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["conversion_id"],
                "dependents": ["user_id", "conversion_ts", "conversion_value"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "user",
            "column": "user_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000000.0
            },
            "provider": null
          },
          {
            "table": "identity",
            "column": "identity_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 50000000.0
            },
            "provider": null
          },
          {
            "table": "identity",
            "column": "user_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 10000000
            },
            "provider": null
          },
          {
            "table": "touchpoint",
            "column": "touchpoint_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 200000000.0
            },
            "provider": null
          },
          {
            "table": "touchpoint",
            "column": "identity_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 50000000
            },
            "provider": null
          },
          {
            "table": "touchpoint",
            "column": "channel",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["email", "paid_search", "social", "organic", "direct", "retail"],
                "probs": [0.2, 0.25, 0.2, 0.15, 0.1, 0.1]
              }
            },
            "provider": null
          },
          {
            "table": "touchpoint",
            "column": "touch_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "conversion",
            "column": "conversion_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000000.0
            },
            "provider": null
          },
          {
            "table": "conversion",
            "column": "user_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.2,
              "n": 10000000
            },
            "provider": null
          },
          {
            "table": "conversion",
            "column": "conversion_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "conversion",
            "column": "conversion_value",
            "distribution": {
              "kind": "lognormal",
              "mean": 4.0,
              "sigma": 1.5
            },
            "provider": null
          }
        ],
        "events": [
          {
            "name": "sale_weekend",
            "start_time": "2024-01-20T00:00:00",
            "end_time": "2024-01-21T23:59:59",
            "effects": [
              {
                "table": "touchpoint",
                "column": "channel",
                "effect_type": "change_distribution",
                "value": {
                  "kind": "categorical",
                  "domain": {
                    "values": ["email", "paid_search", "social", "organic", "direct", "retail"],
                    "probs": [0.15, 0.35, 0.25, 0.1, 0.05, 0.1]
                  }
                }
              }
            ]
          }
        ]
      }
    },
    {
      "number": 33,
      "tier": "extended",
      "text": "Global supply chain shipments with disruptions\n* Entities: ports, facilities, routes, carriers, containers, shipments, legs, customs_events, weather_incidents.\n* Lead_time_days depends on route, season (month in {11,12,1} is slower), and container_type; customs holds add random delays.\n* Weather_incidents applied to region/time windows increase delays, cancellation probability, and damage risk; effects should cascade to multiple legs simultaneously.\n* Shipment status must follow a state machine (CREATED → DEPARTED → ARRIVED_PORT → CUSTOMS → IN_TRANSIT → DELIVERED, with optional CANCELLED/RETURNED).\n* Workload: \"delayed shipments last 14 days by port and carrier\", and \"ETA error distribution by route\".",
      "schema": {
        "tables": {
          "port": {
            "name": "port",
            "kind": "dimension",
            "row_count": 200,
            "columns": [
              {
                "name": "port_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "shipment": {
            "name": "shipment",
            "kind": "fact",
            "row_count": 5000000,
            "columns": [
              {
                "name": "shipment_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "origin_port_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "port.port_id"
              },
              {
                "name": "dest_port_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "port.port_id"
              }
            ],
            "foreign_keys": [
              {
                "column": "origin_port_id",
                "ref_table": "port",
                "ref_column": "port_id"
              },
              {
                "column": "dest_port_id",
                "ref_table": "port",
                "ref_column": "port_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["shipment_id"],
                "dependents": ["origin_port_id", "dest_port_id"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "port",
            "column": "port_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 200.0
            },
            "provider": null
          },
          {
            "table": "shipment",
            "column": "shipment_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 5000000.0
            },
            "provider": null
          },
          {
            "table": "shipment",
            "column": "origin_port_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 200
            },
            "provider": null
          },
          {
            "table": "shipment",
            "column": "dest_port_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 200
            },
            "provider": null
          }
        ],
        "events": [
          {
            "name": "weather_incident",
            "start_time": "2024-01-15T00:00:00",
            "end_time": "2024-01-20T23:59:59",
            "effects": [
              {
                "table": "shipment",
                "effect_type": "multiply_distribution",
                "value": 1.5
              }
            ]
          },
          {
            "name": "seasonal_slowdown",
            "start_time": "2024-11-01T00:00:00",
            "end_time": "2025-01-31T23:59:59",
            "effects": [
              {
                "table": "shipment",
                "effect_type": "multiply_distribution",
                "value": 1.3
              }
            ]
          }
        ]
      }
    },
    {
      "number": 34,
      "tier": "extended",
      "text": "Longitudinal healthcare encounters with readmissions. Model patients, encounters (inpatient/outpatient/ER), diagnoses, procedures, medications, labs, and providers. Enforce clinically plausible sequences such as diagnosis preceding related procedure; medication contraindications (e.g., pregnancy implies exclusion of certain drugs); patient_id → gender, DOB as FDs. Readmission_30d flag depends on encounter windows; labs correlate with diagnoses (e.g., elevated A1C with diabetes). Workload includes readmission rates by DRG and medication adherence over rolling 90‑day windows.",
      "schema": {
        "tables": {
          "patient": {
            "name": "patient",
            "kind": "dimension",
            "row_count": 500000,
            "columns": [
              {
                "name": "patient_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "gender",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "date_of_birth",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["patient_id"],
                "dependents": ["gender", "date_of_birth"]
              }
            ]
          },
          "encounter": {
            "name": "encounter",
            "kind": "fact",
            "row_count": 10000000,
            "columns": [
              {
                "name": "encounter_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "patient_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "patient.patient_id"
              },
              {
                "name": "encounter_start_ts",
                "sql_type": "DATETIME",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "encounter_end_ts",
                "sql_type": "DATETIME",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "encounter_type",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "discharge_disposition",
                "sql_type": "TEXT",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "length_of_stay_days",
                "sql_type": "INT",
                "nullable": true,
                "unique": false,
                "role": "measure",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "patient_id",
                "ref_table": "patient",
                "ref_column": "patient_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["encounter_id"],
                "dependents": ["patient_id", "encounter_start_ts", "encounter_end_ts", "encounter_type", "discharge_disposition"]
              },
              {
                "determinants": ["encounter_start_ts", "encounter_end_ts"],
                "dependents": ["length_of_stay_days"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "patient",
            "column": "patient_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 500000.0
            },
            "provider": null
          },
          {
            "table": "patient",
            "column": "gender",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["M", "F", "Other"],
                "probs": [0.49, 0.49, 0.02]
              }
            },
            "provider": null
          },
          {
            "table": "patient",
            "column": "date_of_birth",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "encounter",
            "column": "encounter_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 10000000.0
            },
            "provider": null
          },
          {
            "table": "encounter",
            "column": "patient_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 500000
            },
            "provider": null
          },
          {
            "table": "encounter",
            "column": "encounter_start_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "encounter",
            "column": "encounter_end_ts",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "encounter",
            "column": "encounter_type",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["inpatient", "outpatient", "ER"],
                "probs": [0.3, 0.5, 0.2]
              }
            },
            "provider": null
          },
          {
            "table": "encounter",
            "column": "discharge_disposition",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["HOME", "TRANSFER", "AMA", "DEATH", null],
                "probs": [0.7, 0.15, 0.05, 0.05, 0.05]
              }
            },
            "provider": null
          },
          {
            "table": "encounter",
            "column": "length_of_stay_days",
            "distribution": {
              "kind": "derived",
              "expression": "DATEDIFF(encounter_end_ts, encounter_start_ts)",
              "dtype": "INT",
              "depends_on": ["encounter_start_ts", "encounter_end_ts"]
            },
            "provider": null
          }
        ],
        "events": []
      }
    },
    {
      "number": 35,
      "tier": "extended",
      "text": "Public library circulation (simple but thorough). Entities: members (tiers: child, adult, senior), items (isbn → title, author, subject), copies, loans, holds, fines, and events (holiday closures, reading campaigns). Loan status moves through REQUESTED → ON_HOLD → CHECKED_OUT → RETURNED or LOST; due dates adjust around closures. Overdue fines accrue daily; amnesty during campaigns. Workload includes rolling 30‑day checkouts by subject and hold-to-loan conversion rates; seasonality increases children's books circulation in summer months.",
      "schema": {
        "tables": {
          "member": {
            "name": "member",
            "kind": "dimension",
            "row_count": 50000,
            "columns": [
              {
                "name": "member_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              }
            ],
            "foreign_keys": []
          },
          "item": {
            "name": "item",
            "kind": "dimension",
            "row_count": 200000,
            "columns": [
              {
                "name": "item_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "isbn",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": true,
                "role": "attribute",
                "references": null
              },
              {
                "name": "title",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "author",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "subject",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [],
            "functional_dependencies": [
              {
                "determinants": ["isbn"],
                "dependents": ["item_id", "title", "author", "subject"]
              }
            ]
          },
          "copy": {
            "name": "copy",
            "kind": "dimension",
            "row_count": 400000,
            "columns": [
              {
                "name": "copy_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "item_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "item.item_id"
              },
              {
                "name": "acquisition_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "condition",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "item_id",
                "ref_table": "item",
                "ref_column": "item_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["copy_id"],
                "dependents": ["item_id", "acquisition_date", "condition"]
              }
            ]
          },
          "loan": {
            "name": "loan",
            "kind": "fact",
            "row_count": 1000000,
            "columns": [
              {
                "name": "loan_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": true,
                "role": "primary_key",
                "references": null
              },
              {
                "name": "member_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "member.member_id"
              },
              {
                "name": "copy_id",
                "sql_type": "INT",
                "nullable": false,
                "unique": false,
                "role": "foreign_key",
                "references": "copy.copy_id"
              },
              {
                "name": "loan_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "due_date",
                "sql_type": "DATE",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "return_date",
                "sql_type": "DATE",
                "nullable": true,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "status",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              },
              {
                "name": "fine_amount",
                "sql_type": "FLOAT",
                "nullable": false,
                "unique": false,
                "role": "measure",
                "references": null
              },
              {
                "name": "loan_policy",
                "sql_type": "TEXT",
                "nullable": false,
                "unique": false,
                "role": "attribute",
                "references": null
              }
            ],
            "foreign_keys": [
              {
                "column": "member_id",
                "ref_table": "member",
                "ref_column": "member_id"
              },
              {
                "column": "copy_id",
                "ref_table": "copy",
                "ref_column": "copy_id"
              }
            ],
            "functional_dependencies": [
              {
                "determinants": ["loan_id"],
                "dependents": ["member_id", "copy_id", "loan_date", "due_date", "return_date", "status", "fine_amount"]
              },
              {
                "determinants": ["loan_date", "loan_policy"],
                "dependents": ["due_date"]
              }
            ]
          }
        }
      },
      "generation_ir": {
        "columns": [
          {
            "table": "member",
            "column": "member_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 50000.0
            },
            "provider": null
          },
          {
            "table": "item",
            "column": "item_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 200000.0
            },
            "provider": null
          },
          {
            "table": "item",
            "column": "isbn",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["978-0-123456-78-9", "978-0-234567-89-0", "978-0-345678-90-1"],
                "probs": [0.33, 0.33, 0.34]
              }
            },
            "provider": null
          },
          {
            "table": "item",
            "column": "title",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Book Title 1", "Book Title 2", "Book Title 3"],
                "probs": [0.33, 0.33, 0.34]
              }
            },
            "provider": null
          },
          {
            "table": "item",
            "column": "author",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Author A", "Author B", "Author C"],
                "probs": [0.33, 0.33, 0.34]
              }
            },
            "provider": null
          },
          {
            "table": "item",
            "column": "subject",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["Fiction", "Non-Fiction", "Children", "Science", "History"],
                "probs": [0.3, 0.25, 0.2, 0.15, 0.1]
              }
            },
            "provider": null
          },
          {
            "table": "copy",
            "column": "copy_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 400000.0
            },
            "provider": null
          },
          {
            "table": "copy",
            "column": "item_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.4,
              "n": 200000
            },
            "provider": null
          },
          {
            "table": "copy",
            "column": "acquisition_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "copy",
            "column": "condition",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["New", "Good", "Fair", "Poor"],
                "probs": [0.2, 0.5, 0.25, 0.05]
              }
            },
            "provider": null
          },
          {
            "table": "loan",
            "column": "loan_id",
            "distribution": {
              "kind": "uniform",
              "low": 1.0,
              "high": 1000000.0
            },
            "provider": null
          },
          {
            "table": "loan",
            "column": "member_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 50000
            },
            "provider": null
          },
          {
            "table": "loan",
            "column": "copy_id",
            "distribution": {
              "kind": "zipf",
              "s": 1.3,
              "n": 400000
            },
            "provider": null
          },
          {
            "table": "loan",
            "column": "loan_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "loan",
            "column": "due_date",
            "distribution": {
              "kind": "derived",
              "expression": "loan_date + loan_policy_days",
              "dtype": "DATE",
              "depends_on": ["loan_date", "loan_policy"]
            },
            "provider": null
          },
          {
            "table": "loan",
            "column": "return_date",
            "distribution": {
              "kind": "uniform",
              "low": 0.0,
              "high": 1.0
            },
            "provider": null
          },
          {
            "table": "loan",
            "column": "status",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["REQUESTED", "ON_HOLD", "CHECKED_OUT", "RETURNED", "LOST"],
                "probs": [0.1, 0.1, 0.3, 0.45, 0.05]
              }
            },
            "provider": null
          },
          {
            "table": "loan",
            "column": "fine_amount",
            "distribution": {
              "kind": "derived",
              "expression": "MAX(0, DATEDIFF(return_date, due_date)) * daily_fine_rate",
              "dtype": "FLOAT",
              "depends_on": ["return_date", "due_date"]
            },
            "provider": null
          },
          {
            "table": "loan",
            "column": "loan_policy",
            "distribution": {
              "kind": "categorical",
              "domain": {
                "values": ["14_days", "21_days", "28_days"],
                "probs": [0.3, 0.4, 0.3]
              }
            },
            "provider": null
          }
        ],
        "events": [
          {
            "name": "summer_reading_campaign",
            "start_time": "2024-06-01T00:00:00",
            "end_time": "2024-08-31T23:59:59",
            "effects": [
              {
                "table": "loan",
                "effect_type": "multiply_distribution",
                "value": 1.5
              }
            ]
          },
          {
            "name": "fine_amnesty",
            "start_time": "2024-12-01T00:00:00",
            "end_time": "2024-12-31T23:59:59",
            "effects": [
              {
                "table": "loan",
                "column": "fine_amount",
                "effect_type": "set_value",
                "value": 0.0
              }
            ]
          }
        ]
      }
    }
  ]
}